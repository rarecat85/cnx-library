const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./H8Z8LE6b.js","./entry.yfGVSS21.css"])))=>i.map(i=>d[i]);
import{F as Kt,N as Zt,a as es,r as f,k as z,o as it,e as ts,_ as ie,Y as ut,O as P,L as i,g as N,H as c,K as n,P as s,I as o,J as g,Q as S,G as y,M as u,U as $,R as Ce,S as De,T as Te,W as ue,Z as ss}from"./H8Z8LE6b.js";import{g as ls,C as os,_ as as}from"./BbFETXTL.js";import{u as ns,_ as rs}from"./B_JeLZBQ.js";import{u as is,h as Pe,_ as us}from"./DZyQwHeg.js";import{u as ds,C as cs,c as Oe,f as Be,p as vs}from"./yWPze8eg.js";import{u as ms}from"./9l_XyyT8.js";import{u as ps}from"./B54HU3Ip.js";import"./teippYbc.js";import"./C-xtXPWq.js";const fs={class:"books-admin-page"},gs={class:"center-header mb-6"},ys={class:"center-header-inner"},_s={class:"page-title mb-0"},bs={class:"registered-books-section"},ks={class:"registered-books-header mb-0"},hs={class:"d-flex align-center justify-space-between flex-wrap gap-4 mb-4"},ws={class:"text-body-1"},Cs={class:"text-body-2 text-medium-emphasis"},Ds={class:"d-flex align-center registered-search-group"},Bs={class:"d-flex align-center justify-space-between flex-wrap gap-4 mt-4"},xs={class:"d-flex action-buttons"},Vs={key:0,class:"text-center py-8"},Ns={key:1,class:"registered-books-section"},Rs={class:"registered-books-grid"},$s=["onClick"],Ls=["src","alt"],Es={key:1,class:"book-thumbnail-placeholder"},qs={class:"book-meta"},Is={class:"book-title"},Ss={key:0,class:"book-author"},As={key:1,class:"book-publisher"},Us={class:"book-count"},zs={class:"book-copies-list"},Ts=["onClick"],Ps={class:"copy-content"},Os={class:"copy-row-top"},Fs={class:"copy-status"},Ms={key:4,class:"copy-user-info"},Gs=["onClick"],Ws={class:"copy-info-row"},Qs={class:"copy-label-number"},Hs={class:"copy-location"},js={class:"location-text"},Xs={class:"copy-actions"},Ys={key:0,class:"pagination-section"},Js={key:2,class:"text-center py-8 text-medium-emphasis empty-state"},Ks={key:0},Zs={key:1},el={key:0,class:"sticky-action-bar"},tl={class:"sticky-action-info"},sl={class:"selected-count"},ll={class:"sticky-action-buttons"},ol={class:"drawer-content"},al={class:"rent-dialog-content"},nl={class:"mb-4 text-body-2 text-medium-emphasis"},rl={class:"rent-dialog-actions"},il={class:"multi-rent-book-list"},ul={class:"rent-book-card-inner"},dl=["src","alt"],cl={key:1,class:"rent-book-thumbnail-placeholder"},vl={class:"rent-book-meta"},ml={class:"rent-book-title"},pl={key:0,class:"rent-book-author"},fl={key:1,class:"rent-book-publisher"},gl={class:"rent-book-details"},yl={class:"detail-item"},_l={class:"detail-item location-item"},bl={class:"location-text"},kl={key:2,class:"rent-book-renter"},hl={key:0,class:"book-info-preview mb-4"},wl={class:"book-info-preview-inner"},Cl=["src","alt"],Dl={key:1,class:"book-thumbnail-placeholder"},Bl={class:"book-meta"},xl={class:"book-title"},Vl={class:"book-current-label"},Nl={class:"book-current-location"},Rl={class:"location-text"},$l={class:"label-number-inputs mb-3"},Ll={class:"rent-confirm-info mb-4"},El={class:"multi-rent-book-list"},ql={class:"rent-book-card-inner"},Il=["src","alt"],Sl={key:1,class:"rent-book-thumbnail-placeholder"},Al={class:"rent-book-meta"},Ul={class:"rent-book-title"},zl={key:0,class:"rent-book-author"},Tl={key:1,class:"rent-book-publisher"},Pl={class:"rent-book-details"},Ol={class:"detail-item"},Fl={class:"detail-item"},Ml={class:"location-text"},Fe=10,xe=5,Gl={__name:"index",setup(Wl){const{user:Me}=ms(),{getBooksByCenter:dt,rentBook:Ge,deleteBook:ct,updateBookInfo:vt,checkLabelNumberExists:mt,getCategories:pt,calculateBookStatus:T}=is(),{loadCenterLocations:ft}=ds(),{confirm:We,alert:q}=Zt(),{$firebaseFirestore:gt}=es(),A=gt,{drawer:de,drawerWidth:Qe}=ns(),Ve=[...os],D=f(""),yt=f(""),pe=f(!1),He=f(""),Ne=t=>{He.value=t,pe.value=!0},H=f([]),Re=f(!1),G=f(""),U=f("label"),se=f(""),ce=f("asc"),_t=[{title:"오름차순",value:"asc"},{title:"내림차순",value:"desc"}],bt=[{title:"라벨번호순",value:"label"},{title:"대여중도서",value:"rented"},{title:"연체중도서",value:"overdue"},{title:"대여신청도서",value:"requested"},{title:"위치별로 보기",value:"location"}],fe=t=>{if(!t)return 9999;const e=t.split("_");if(e.length<2)return 9999;const a=e[1];return parseInt(a.slice(-4))||9999},_=f([]),ge=f(!1),F=f(!1),ve=f(1),ye=f({}),_e=f({}),le=f(!1),$e=f([]),oe=f(!1),j=f([]),Le=f(!1),W=f(""),O=f(""),M=f(""),ae=f(!1),X=f([]),Ee=f(!1),me=f(!1),L=f(null),qe=f(!1),Ie=f([]),Se=f(!1),K=f(""),k=f({category:"",fourDigits:"",location:""}),ne=f([]),kt=z(()=>[{title:"전체",value:""},...ne.value]),je=async()=>{try{const t=await ft(D.value);ne.value=t.map(e=>({title:e.name,value:e.name}))}catch(t){console.error("위치 옵션 로드 오류:",t),ne.value=[]}},ht=()=>ne.value.length>0?ne.value[0].value:"",wt=z(()=>cs[D.value]||"1");z(()=>!k.value.category||!k.value.fourDigits?"":Oe(k.value.category,D.value,k.value.fourDigits));const Xe=z(()=>k.value.category&&k.value.fourDigits&&k.value.fourDigits.length===4&&/^\d{4}$/.test(k.value.fourDigits)&&k.value.location&&!K.value);it(()=>{const t=()=>{Qe.value=window.innerWidth>=769?360:280};t(),window.addEventListener("resize",t),ts(()=>{window.removeEventListener("resize",t)})});const Ct=async()=>{if(!Me.value||!A)return"";try{const{doc:t,getDoc:e}=await ie(async()=>{const{doc:d,getDoc:v}=await import("./H8Z8LE6b.js").then(m=>m.b2);return{doc:d,getDoc:v}},__vite__mapDeps([0,1]),import.meta.url),a=t(A,"users",Me.value.uid),r=await e(a);if(r.exists())return r.data().workplace||""}catch(t){console.error("사용자 근무지 정보 가져오기 오류:",t)}return""};it(async()=>{const t=await Ct();yt.value=t,D.value=t?ls(t):Ve[0],await Promise.all([Z(),je()]),Dt()});const Dt=async()=>{const t=H.value.filter(e=>T(e)==="requested");t.length>0&&($e.value=t,le.value=!0)},Bt=()=>{le.value=!1,U.value="requested"},xt=async()=>{_.value=[],await Promise.all([Z(),je()])},Z=async()=>{try{Re.value=!0;const t=await dt(D.value);H.value=t,await Vt(t)}catch(t){console.error("등록된 도서 로드 오류:",t),H.value=[]}finally{Re.value=!1}},Vt=async t=>{if(!A)return;const{doc:e,getDoc:a}=await ie(async()=>{const{doc:m,getDoc:B}=await import("./H8Z8LE6b.js").then(b=>b.b2);return{doc:m,getDoc:B}},__vite__mapDeps([0,1]),import.meta.url),r=[...new Set(t.filter(m=>m.rentedBy).map(m=>m.rentedBy))],d=[...new Set(t.filter(m=>m.requestedBy).map(m=>m.requestedBy))],v=[...new Set([...r,...d])];for(const m of v)if(!(ye.value[m]&&_e.value[m]))try{const B=e(A,"users",m),b=await a(B);if(b.exists()){const x=b.data(),C=(x.email||"").split("@")[0]||"",I=x.name||"",w=`${x.workplace||""} ${I}(${C})`;ye.value[m]=w,_e.value[m]=w}else{const x=e(A,"pendingUsers",m),p=await a(x);if(p.exists()){const C=p.data(),R=(C.email||"").split("@")[0]||"",w=C.name||"",E=`${C.workplace||""} ${w}(${R}) [미가입]`;ye.value[m]=E,_e.value[m]=E}}}catch(B){console.error("대여자/신청자 정보 로드 오류:",B)}},be=t=>t.rentedBy&&ye.value[t.rentedBy]||"",Ae=t=>t.requestedBy&&_e.value[t.requestedBy]||"",Ye=t=>t.expectedReturnDate?t.expectedReturnDate?.toDate?.()||new Date(t.expectedReturnDate):null,Nt=t=>{if(!t)return"";const e=t?.toDate?.()||new Date(t),a=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),d=String(e.getDate()).padStart(2,"0");return`${a}.${r}.${d}`},Rt=t=>{const e=Ye(t);return e?e<new Date:!1},$t=()=>{},Je=z(()=>{const t=new Map;for(const e of H.value){const a=e.isbn13||e.isbn||e.id;t.has(a)||t.set(a,{isbn:a,title:e.title,author:e.author,publisher:e.publisher,image:e.image,copies:[],totalCount:0,availableCount:0,rentedCount:0,requestedCount:0,locations:[]});const r=t.get(a);r.copies.push(e),r.totalCount++;const d=T(e);d?d==="rented"||d==="overdue"?r.rentedCount++:d==="requested"&&r.requestedCount++:r.availableCount++,e.location&&!r.locations.includes(e.location)&&r.locations.push(e.location)}for(const e of t.values())e.copies.sort((a,r)=>{const d=a.labelNumber||"",v=r.labelNumber||"";return d.localeCompare(v,"ko")});return Array.from(t.values())}),re=z(()=>{let t=[...Je.value];if(G.value.trim()){const e=G.value.toLowerCase();t=t.filter(a=>{const r=(a.title||"").toLowerCase(),d=(a.author||"").toLowerCase(),v=(a.publisher||"").toLowerCase();return r.includes(e)||d.includes(e)||v.includes(e)?!0:a.copies.some(m=>(m.labelNumber||"").toLowerCase().includes(e))})}return U.value==="label"?t.sort((e,a)=>{const r=fe(e.copies[0]?.labelNumber),d=fe(a.copies[0]?.labelNumber);return ce.value==="asc"?r-d:d-r}):U.value==="rented"?t=t.filter(e=>e.rentedCount>0):U.value==="overdue"?t=t.filter(e=>e.copies.some(a=>T(a)==="overdue")):U.value==="requested"?t=t.filter(e=>e.requestedCount>0):U.value==="location"&&(se.value&&(t=t.filter(e=>e.copies.some(a=>a.location===se.value))),t.sort((e,a)=>{const r=fe(e.copies[0]?.labelNumber),d=fe(a.copies[0]?.labelNumber);return ce.value==="asc"?r-d:d-r})),t}),Lt=z(()=>{const t=(ve.value-1)*Fe,e=t+Fe;return re.value.slice(t,e)}),Ke=z(()=>Math.ceil(re.value.length/Fe));ut([()=>G.value,()=>U.value,()=>se.value],()=>{ve.value=1});const Et=z(()=>H.value.length),qt=z(()=>Je.value.length),It=z(()=>H.value.filter(t=>T(t)==="rented").length),St=z(()=>H.value.filter(t=>T(t)==="overdue").length),At=z(()=>H.value.filter(t=>T(t)==="requested").length),Y=t=>T(t),ee=t=>_.value.some(e=>e.id===t.id),Ze=t=>t.copies.every(e=>ee(e)),Ut=t=>{const e=t.copies.filter(a=>ee(a)).length;return e>0&&e<t.copies.length},zt=(t,e)=>{e?ee(t)||_.value.push(t):_.value=_.value.filter(a=>a.id!==t.id),Ue()},Tt=(t,e)=>{if(e)for(const a of t.copies)ee(a)||_.value.push(a);else{const a=t.copies.map(r=>r.id);_.value=_.value.filter(r=>!a.includes(r.id))}Ue()},Pt=t=>{const e=Ze(t);Tt(t,!e)},Ot=t=>{zt(t,!ee(t))},Ft=t=>{t?_.value=re.value.flatMap(e=>e.copies):_.value=[]},Ue=()=>{const t=re.value.flatMap(e=>e.copies);ge.value=t.length>0&&t.every(e=>ee(e))};ut(()=>re.value,()=>{Ue()});const Mt=async()=>{try{Se.value=!0;const t=await pt(D.value);Ie.value=t}catch(t){console.error("카테고리 로드 오류:",t),Ie.value=[]}finally{Se.value=!1}},Gt=t=>{const e=t.target.value.replace(/\D/g,"").slice(0,4);k.value.fourDigits=e,K.value=""},Wt=async()=>{if(!k.value.category||!k.value.fourDigits||k.value.fourDigits.length!==4)return;const t=Oe(k.value.category,D.value,k.value.fourDigits);if(L.value&&t===L.value.labelNumber){K.value="";return}try{await mt(t,D.value)?K.value="이미 사용중인 라벨번호입니다.":K.value=""}catch(e){console.error("라벨번호 중복 체크 오류:",e)}},Qt=async t=>{L.value=t;const e=vs(t.labelNumber),a=ht();k.value={category:t.category||e?.category||"",fourDigits:e?.fourDigits||"",location:t.location||a},K.value="",await Mt(),me.value=!0},et=()=>{me.value=!1,L.value=null},Ht=async()=>{if(!(!L.value||!Xe.value))try{qe.value=!0;const t=Oe(k.value.category,D.value,k.value.fourDigits);await vt(L.value.labelNumber||L.value.id.split("_")[0],D.value,{category:k.value.category,labelNumber:t,location:k.value.location}),et(),await Z(),await q("도서 정보가 수정되었습니다.",{type:"success"})}catch(t){console.error("도서 정보 수정 오류:",t),await q(t.message||"도서 정보 수정에 실패했습니다.",{type:"error"})}finally{qe.value=!1}},tt=async()=>{if(_.value.length===0)return;const t=[],e=[];for(const r of _.value){const d=T(r);d==="rented"||d==="overdue"?e.push({book:r,reason:"대여중"}):d==="requested"?e.push({book:r,reason:"대여신청중"}):t.push(r)}if(t.length===0){const r=e.map(d=>`• ${d.book.title} (${d.reason})`).join(`
`);await q(`선택한 도서를 삭제할 수 없습니다.

${r}

대여중/대여신청중인 도서는 반납 또는 신청 취소 후 삭제해주세요.`,{type:"warning"});return}let a=`선택한 ${_.value.length}권 중 ${t.length}권의 도서를 삭제하시겠습니까?`;if(e.length>0){const r=e.map(d=>`• ${d.book.title} (${d.reason})`).join(`
`);a+=`

⚠️ 다음 도서는 삭제할 수 없습니다:
${r}`}if(await We(a))try{F.value=!0;const r=t.map(d=>{const v=d.labelNumber||d.id.split("_")[0];return ct(v,D.value)});await Promise.all(r),_.value=[],await Z(),e.length>0?await q(`${t.length}권의 도서가 삭제되었습니다.
(${e.length}권은 대여중/대여신청중으로 삭제되지 않았습니다.)`,{type:"success"}):await q(`${t.length}권의 도서가 삭제되었습니다.`,{type:"success"})}catch(r){console.error("도서 삭제 오류:",r),await q("도서 삭제에 실패했습니다.",{type:"error"})}finally{F.value=!1}},st=async()=>{if(_.value.length===0)return;const t=_.value.filter(e=>{const a=T(e);return a!=="rented"&&a!=="overdue"});if(t.length===0){await q("선택한 도서가 모두 대여중입니다.",{type:"warning"});return}j.value=t,W.value=D.value,O.value="",M.value="",oe.value=!0},lt=async(t,e="user")=>{if(!A||!t)return 0;try{const{collection:a,query:r,where:d,getDocs:v}=await ie(async()=>{const{collection:p,query:C,where:I,getDocs:R}=await import("./H8Z8LE6b.js").then(w=>w.b2);return{collection:p,query:C,where:I,getDocs:R}},__vite__mapDeps([0,1]),import.meta.url),m=a(A,"books");let B;e==="pending"?B=r(m,d("rentedBy","==",t),d("rentedByType","==","pending")):B=r(m,d("rentedBy","==",t));const b=await v(B);let x=0;return b.forEach(p=>{const C=p.data();(C.status==="rented"||C.status==="overdue")&&(e==="user"?(!C.rentedByType||C.rentedByType==="user")&&x++:x++)}),x}catch(a){return console.error("대여 권수 조회 오류:",a),0}},jt=async t=>{if(T(t)==="requested"&&t.requestedBy){if(await lt(t.requestedBy)>=xe){await q(`신청자가 이미 ${xe}권을 대여중입니다.
반납 후 대여 처리해주세요.`,{type:"warning"});return}if(!await We(`신청자 정보로 대여 처리하시겠습니까?

도서: ${t.title}
라벨번호: ${t.labelNumber||"-"}
신청자: ${Ae(t)}`))return;try{F.value=!0;const{doc:r,getDoc:d}=await ie(async()=>{const{doc:x,getDoc:p}=await import("./H8Z8LE6b.js").then(C=>C.b2);return{doc:x,getDoc:p}},__vite__mapDeps([0,1]),import.meta.url),v=r(A,"users",t.requestedBy),m=await d(v),B=m.exists()&&m.data().email||"",b=t.labelNumber||t.id.split("_")[0];await Ge(b,D.value,t.requestedBy,t.isbn,"user",B),await Z(),await q("대여 처리가 완료되었습니다.",{type:"success"})}catch(r){console.error("대여 처리 오류:",r),await q(r.message||"대여 처리에 실패했습니다.",{type:"error"})}finally{F.value=!1}return}j.value=[t],W.value=D.value,O.value="",M.value="",oe.value=!0},ot=()=>{oe.value=!1,j.value=[],W.value="",O.value="",M.value=""},Xt=async()=>{if(!(!W.value||!O.value))try{Le.value=!0,M.value="";const{collection:t,query:e,where:a,getDocs:r}=await ie(async()=>{const{collection:w,query:V,where:E,getDocs:J}=await import("./H8Z8LE6b.js").then(Q=>Q.b2);return{collection:w,query:V,where:E,getDocs:J}},__vite__mapDeps([0,1]),import.meta.url);let d=null,v=null,m="user";const B=t(A,"users"),b=e(B,a("email","==",O.value)),x=await r(b);if(!x.empty)d=x.docs[0].id,v=x.docs[0].data(),m="user";else{const w=t(A,"pendingUsers"),V=e(w,a("email","==",O.value)),E=await r(V);if(!E.empty)d=E.docs[0].id,v=E.docs[0].data(),m="pending";else{M.value=`해당 이메일의 사용자를 찾을 수 없습니다.
미가입자 관리에서 먼저 등록해주세요.`;return}}if(v.center!==W.value){M.value=`해당 사용자는 ${v.center} 소속입니다.`;return}const p=await lt(d,m),C=j.value.length,I=xe-p;if(I<=0){M.value=`해당 사용자가 이미 ${xe}권을 대여중입니다.`;return}if(C>I){M.value=`해당 사용자는 ${I}권까지만 추가 대여 가능합니다. (현재 ${p}권 대여중)`;return}for(const w of j.value){const V=w.labelNumber||w.id.split("_")[0];await Ge(V,D.value,d,w.isbn,m,O.value)}const R=j.value.length;await Z(),_.value=_.value.filter(w=>!j.value.some(V=>V.id===w.id)),ot(),await q(`${R}권의 도서가 대여 처리되었습니다.`,{type:"success"})}catch(t){console.error("도서 대여 오류:",t),M.value=t.message||"대여 처리에 실패했습니다."}finally{Le.value=!1}},at=async()=>{if(_.value.length===0)return;const t=_.value.filter(e=>{const a=T(e);return a==="rented"||a==="overdue"});if(t.length===0){await q("선택한 도서 중 대여중인 도서가 없습니다.",{type:"warning"});return}X.value=t,ae.value=!0},nt=()=>{ae.value=!1,X.value=[]},Yt=async()=>{if(X.value.length!==0)try{Ee.value=!0;const{doc:t,updateDoc:e,collection:a,addDoc:r,query:d,where:v,getDocs:m,serverTimestamp:B,deleteField:b}=await ie(async()=>{const{doc:p,updateDoc:C,collection:I,addDoc:R,query:w,where:V,getDocs:E,serverTimestamp:J,deleteField:Q}=await import("./H8Z8LE6b.js").then(te=>te.b2);return{doc:p,updateDoc:C,collection:I,addDoc:R,query:w,where:V,getDocs:E,serverTimestamp:J,deleteField:Q}},__vite__mapDeps([0,1]),import.meta.url);for(const p of X.value){const C=p.labelNumber||p.id.split("_")[0],I=p.id,R=p.rentedBy,w=p.rentedByType||"user",V=p.rentedAt,E=t(A,"books",I);if(await e(E,{status:"available",rentedBy:b(),rentedByType:b(),rentedAt:b(),expectedReturnDate:b()}),R){const J=a(A,"rentalHistory"),Q=p.isbn13||p.isbn||"",te=d(J,v("userId","==",R),v("isbn13","==",Q)),ke=await m(te);if(ke.empty)await r(J,{bookId:I,labelNumber:C,isbn13:p.isbn13||"",isbn:p.isbn||"",title:p.title||"",author:p.author||"",publisher:p.publisher||"",cover:p.cover||p.image||"",center:p.center||"",userId:R,userType:w,userEmail:p.rentedByEmail||"",rentedAt:V,returnedAt:B(),rentCount:1});else{const he=ke.docs[0],ze=he.data();await e(t(A,"rentalHistory",he.id),{rentedAt:V,returnedAt:B(),rentCount:(ze.rentCount||1)+1})}}}const x=X.value.length;_.value=_.value.filter(p=>!X.value.some(C=>C.id===p.id)),nt(),await Z(),await q(`${x}권의 도서가 반납 처리되었습니다.`,{type:"success"})}catch(t){console.error("도서 반납 오류:",t),await q("도서 반납에 실패했습니다.",{type:"error"})}finally{Ee.value=!1}},Jt=async t=>{const e=T(t);if(e!=="rented"&&e!=="overdue"){await q("대여중인 도서가 아닙니다.",{type:"warning"});return}X.value=[t],ae.value=!0};return ps({title:"도서 관리 - CNX Library",meta:[{name:"description",content:"도서 검색 및 등록 관리"}]}),(t,e)=>{const a=N("v-select"),r=N("v-text-field"),d=N("v-checkbox"),v=N("v-btn"),m=N("v-progress-circular"),B=N("v-chip"),b=N("v-icon"),x=N("v-pagination"),p=as,C=rs,I=N("v-navigation-drawer"),R=N("v-spacer"),w=N("v-card"),V=N("v-dialog"),E=N("v-card-title"),J=N("v-alert"),Q=N("v-card-text"),te=N("v-card-actions"),ke=N("v-autocomplete"),he=us,ze=N("v-app");return c(),P(ze,null,{default:i(()=>[n(p,{"header-type":"back-home","show-header-actions":!0,onToggleDrawer:e[7]||(e[7]=l=>de.value=!s(de))},{default:i(()=>[o("div",fs,[o("div",gs,[o("div",ys,[o("h1",_s,g(s(D))+" 도서 관리 ",1),n(a,{modelValue:s(D),"onUpdate:modelValue":[e[0]||(e[0]=l=>S(D)?D.value=l:null),xt],items:Ve,variant:"outlined",density:"comfortable","hide-details":"",class:"center-select"},null,8,["modelValue"])])]),o("div",bs,[o("div",ks,[o("div",hs,[o("div",ws,[e[21]||(e[21]=u(" 총 ",-1)),o("strong",null,g(s(Et)),1),u("권 ("+g(s(qt))+"종) ",1)]),o("div",Cs,[e[22]||(e[22]=u(" 대여중 ",-1)),o("strong",null,g(s(It)),1),e[23]||(e[23]=u("권, 연체중 ",-1)),o("strong",null,g(s(St)),1),e[24]||(e[24]=u("권, 대여신청 ",-1)),o("strong",null,g(s(At)),1),e[25]||(e[25]=u("권 ",-1))])]),o("div",Ds,[n(r,{modelValue:s(G),"onUpdate:modelValue":[e[1]||(e[1]=l=>S(G)?G.value=l:null),$t],label:"도서/라벨번호 검색","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"comfortable","hide-details":"",clearable:"",class:"registered-search-input"},null,8,["modelValue"]),n(a,{modelValue:s(U),"onUpdate:modelValue":e[2]||(e[2]=l=>S(U)?U.value=l:null),items:bt,label:"정렬",variant:"outlined",density:"comfortable","hide-details":"",class:"sort-select"},null,8,["modelValue"])]),o("div",Bs,[n(d,{modelValue:s(ge),"onUpdate:modelValue":[e[3]||(e[3]=l=>S(ge)?ge.value=l:null),Ft],label:"전체선택","hide-details":"",class:"select-all-checkbox"},null,8,["modelValue"]),o("div",xs,[s(U)==="label"||s(U)==="location"?(c(),P(a,{key:0,modelValue:s(ce),"onUpdate:modelValue":e[4]||(e[4]=l=>S(ce)?ce.value=l:null),items:_t,label:"정렬",variant:"outlined",density:"compact","hide-details":"",class:"sort-order-select"},null,8,["modelValue"])):$("",!0),s(U)==="location"?(c(),P(a,{key:1,modelValue:s(se),"onUpdate:modelValue":e[5]||(e[5]=l=>S(se)?se.value=l:null),items:s(kt),label:"위치",variant:"outlined",density:"compact","hide-details":"",class:"location-filter-select"},null,8,["modelValue","items"])):$("",!0),n(v,{class:"action-btn",variant:"flat",size:"small",disabled:s(_).length===0,loading:s(F),onClick:tt},{default:i(()=>[...e[26]||(e[26]=[u(" 도서 삭제 ",-1)])]),_:1},8,["disabled","loading"]),n(v,{class:"action-btn",variant:"flat",size:"small",disabled:s(_).length===0,loading:s(F),onClick:st},{default:i(()=>[...e[27]||(e[27]=[u(" 대여 처리 ",-1)])]),_:1},8,["disabled","loading"]),n(v,{class:"action-btn",variant:"flat",size:"small",disabled:s(_).length===0,loading:s(F),onClick:at},{default:i(()=>[...e[28]||(e[28]=[u(" 반납 처리 ",-1)])]),_:1},8,["disabled","loading"])])])]),s(Re)?(c(),y("div",Vs,[n(m,{indeterminate:"",color:"primary"})])):s(re).length>0?(c(),y("div",Ns,[o("div",Rs,[(c(!0),y(Ce,null,De(s(Lt),(l,rt)=>(c(),y("div",{key:`group-${rt}`,class:Te(["book-card",{"book-card-selected":Ze(l)||Ut(l)}])},[o("div",{class:"book-card-header",onClick:h=>Pt(l)},[l.image?(c(),y("img",{key:0,src:l.image,alt:l.title,class:"book-thumbnail"},null,8,Ls)):(c(),y("div",Es,[...e[29]||(e[29]=[o("span",null,"NO IMAGE",-1)])])),o("div",qs,[o("div",Is,g(l.title),1),l.author?(c(),y("div",Ss,[e[30]||(e[30]=o("strong",null,"저자:",-1)),u(" "+g(l.author),1)])):$("",!0),l.publisher?(c(),y("div",As,[e[31]||(e[31]=o("strong",null,"출판사:",-1)),u(" "+g(l.publisher),1)])):$("",!0),o("div",Us," 등록 "+g(l.totalCount)+"권 ",1)])],8,$s),o("div",zs,[(c(!0),y(Ce,null,De(l.copies,h=>(c(),y("div",{key:h.id,class:Te(["book-copy-item",{selected:ee(h)}]),onClick:we=>Ot(h)},[o("div",Ps,[o("div",Os,[o("div",Fs,[Y(h)==="rented"?(c(),P(B,{key:0,size:"x-small",color:"primary",variant:"flat"},{default:i(()=>[...e[32]||(e[32]=[u(" 대여중 ",-1)])]),_:1})):Y(h)==="overdue"?(c(),P(B,{key:1,size:"x-small",color:"error",variant:"flat"},{default:i(()=>[...e[33]||(e[33]=[u(" 연체중 ",-1)])]),_:1})):Y(h)==="requested"?(c(),P(B,{key:2,size:"x-small",color:"warning",variant:"flat"},{default:i(()=>[...e[34]||(e[34]=[u(" 대여신청 ",-1)])]),_:1})):(c(),P(B,{key:3,size:"x-small",color:"success",variant:"outlined"},{default:i(()=>[...e[35]||(e[35]=[u(" 대여가능 ",-1)])]),_:1})),be(h)||Ae(h)?(c(),y("span",Ms,g(be(h)||Ae(h)),1)):$("",!0)]),o("a",{href:"#",class:"copy-edit-link",onClick:ue(we=>Qt(h),["prevent","stop"])}," 정보수정 ",8,Gs)]),o("div",Ws,[o("span",Qs,g(h.labelNumber||"라벨없음"),1),e[38]||(e[38]=o("span",{class:"copy-divider"},"|",-1)),o("span",Hs,[n(b,{size:"small",class:"mr-1"},{default:i(()=>[...e[36]||(e[36]=[u(" mdi-map-marker ",-1)])]),_:1}),o("span",js,g(s(Be)(h.location)||"위치없음"),1),s(Pe)(s(D),h.location)?(c(),P(b,{key:0,size:"small",class:"ml-1 location-info-icon",onClick:ue(we=>Ne(h.location),["stop"])},{default:i(()=>[...e[37]||(e[37]=[u(" mdi-information-outline ",-1)])]),_:1},8,["onClick"])):$("",!0)])]),o("div",Xs,[Y(h)==="rented"||Y(h)==="overdue"?(c(),P(v,{key:0,color:"primary",size:"small",variant:"flat",onClick:ue(we=>Jt(h),["stop"])},{default:i(()=>[...e[39]||(e[39]=[u(" 반납처리 ",-1)])]),_:1},8,["onClick"])):(c(),P(v,{key:1,color:"primary",size:"small",variant:"flat",onClick:ue(we=>jt(h),["stop"])},{default:i(()=>[u(g(Y(h)==="requested"?"대여승인":"대여처리"),1)]),_:2},1032,["onClick"]))]),(Y(h)==="rented"||Y(h)==="overdue")&&Ye(h)?(c(),y("div",{key:0,class:Te(["return-date-text",{"return-date-overdue":Rt(h)}])},[n(b,{size:"small",class:"mr-1"},{default:i(()=>[...e[40]||(e[40]=[u(" mdi-calendar-clock ",-1)])]),_:1}),u(" 반납예정일: "+g(Nt(h.expectedReturnDate)),1)],2)):$("",!0)])],10,Ts))),128))])],2))),128))]),s(Ke)>1?(c(),y("div",Ys,[n(x,{modelValue:s(ve),"onUpdate:modelValue":e[6]||(e[6]=l=>S(ve)?ve.value=l:null),length:s(Ke),"total-visible":5,density:"compact",size:"small",class:"pagination"},null,8,["modelValue","length"])])):$("",!0)])):(c(),y("div",Js,[n(b,{size:"48",color:"grey-lighten-1",class:"mb-4"},{default:i(()=>[u(g(s(G)?"mdi-book-search-outline":"mdi-book-off-outline"),1)]),_:1}),s(G)?(c(),y("p",Ks,[e[41]||(e[41]=u(" '",-1)),o("strong",null,g(s(G)),1),e[42]||(e[42]=u("'에 대한 검색 결과가 없습니다. ",-1))])):(c(),y("p",Zs," 등록된 도서가 없습니다. "))]))])]),n(ss,{name:"slide-up"},{default:i(()=>[s(_).length>0?(c(),y("div",el,[o("div",tl,[o("span",sl,g(s(_).length)+"권 선택",1)]),o("div",ll,[n(v,{class:"sticky-action-btn delete",variant:"flat",size:"small",loading:s(F),onClick:tt},{default:i(()=>[...e[43]||(e[43]=[u(" 삭제 ",-1)])]),_:1},8,["loading"]),n(v,{class:"sticky-action-btn rent",variant:"flat",size:"small",loading:s(F),onClick:st},{default:i(()=>[...e[44]||(e[44]=[u(" 대여 ",-1)])]),_:1},8,["loading"]),n(v,{class:"sticky-action-btn return",variant:"flat",size:"small",loading:s(F),onClick:at},{default:i(()=>[...e[45]||(e[45]=[u(" 반납 ",-1)])]),_:1},8,["loading"])])])):$("",!0)]),_:1})]),_:1}),n(I,{modelValue:s(de),"onUpdate:modelValue":e[8]||(e[8]=l=>S(de)?de.value=l:null),location:"right",temporary:"",width:s(Qe),class:"side-navigation"},{default:i(()=>[o("div",ol,[n(C)])]),_:1},8,["modelValue","width"]),n(V,{modelValue:s(oe),"onUpdate:modelValue":e[11]||(e[11]=l=>S(oe)?oe.value=l:null),"max-width":"400"},{default:i(()=>[n(w,{class:"rent-dialog-card"},{default:i(()=>[e[48]||(e[48]=o("div",{class:"rent-dialog-title text-h6"}," 대여자 정보 입력 ",-1)),o("div",al,[o("div",nl," 대여 처리할 도서: "+g(s(j).length)+"권 ",1),n(a,{modelValue:s(W),"onUpdate:modelValue":e[9]||(e[9]=l=>S(W)?W.value=l:null),items:Ve,label:"센터",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),n(r,{modelValue:s(O),"onUpdate:modelValue":e[10]||(e[10]=l=>S(O)?O.value=l:null),label:"이메일",variant:"outlined",density:"comfortable",placeholder:"example@email.com","error-messages":s(M)},null,8,["modelValue","error-messages"])]),o("div",rl,[n(R),n(v,{variant:"text",onClick:ot},{default:i(()=>[...e[46]||(e[46]=[u(" 취소 ",-1)])]),_:1}),n(v,{color:"primary",variant:"flat",loading:s(Le),disabled:!s(W)||!s(O),onClick:Xt},{default:i(()=>[...e[47]||(e[47]=[u(" 대여 처리 ",-1)])]),_:1},8,["loading","disabled"])])]),_:1})]),_:1},8,["modelValue"]),n(V,{modelValue:s(ae),"onUpdate:modelValue":e[12]||(e[12]=l=>S(ae)?ae.value=l:null),"max-width":"500"},{default:i(()=>[n(w,{class:"rent-confirm-card"},{default:i(()=>[n(E,{class:"rent-confirm-title"},{default:i(()=>[...e[49]||(e[49]=[u(" 반납 확인 ",-1)])]),_:1}),n(Q,{class:"rent-confirm-content"},{default:i(()=>[e[57]||(e[57]=o("div",{class:"rent-confirm-info mb-4"},[o("p",null,"아래 도서들을 반납 처리하시겠습니까?")],-1)),o("div",il,[(c(!0),y(Ce,null,De(s(X),l=>(c(),y("div",{key:l.id,class:"rent-book-card"},[o("div",ul,[l.image?(c(),y("img",{key:0,src:l.image,alt:l.title,class:"rent-book-thumbnail"},null,8,dl)):(c(),y("div",cl,[...e[50]||(e[50]=[o("span",null,"NO IMAGE",-1)])])),o("div",vl,[o("div",ml,g(l.title),1),l.author?(c(),y("div",pl,[e[51]||(e[51]=o("strong",null,"저자:",-1)),u(" "+g(l.author),1)])):$("",!0),l.publisher?(c(),y("div",fl,[e[52]||(e[52]=o("strong",null,"출판사:",-1)),u(" "+g(l.publisher),1)])):$("",!0),o("div",gl,[o("span",yl,[n(b,{size:"x-small",class:"mr-1"},{default:i(()=>[...e[53]||(e[53]=[u("mdi-label",-1)])]),_:1}),u(" "+g(l.labelNumber||"라벨없음"),1)]),o("span",_l,[n(b,{size:"x-small",class:"mr-1"},{default:i(()=>[...e[54]||(e[54]=[u("mdi-map-marker",-1)])]),_:1}),o("span",bl,g(s(Be)(l.location)||"위치없음"),1),s(Pe)(s(D),l.location)?(c(),P(b,{key:0,size:"x-small",class:"ml-1 location-info-icon",onClick:ue(rt=>Ne(l.location),["stop"])},{default:i(()=>[...e[55]||(e[55]=[u(" mdi-information-outline ",-1)])]),_:1},8,["onClick"])):$("",!0)])]),be(l)?(c(),y("div",kl," 대여자: "+g(be(l)),1)):$("",!0)])])]))),128))]),n(J,{type:"warning",variant:"tonal",density:"compact",class:"mt-4"},{default:i(()=>[...e[56]||(e[56]=[u(" 대여자 정보와 라벨번호를 확인 후, 실제 반납이 완료된 도서만 반납 처리해주세요. ",-1)])]),_:1})]),_:1}),n(te,{class:"rent-confirm-actions"},{default:i(()=>[n(R),n(v,{variant:"text",onClick:nt},{default:i(()=>[...e[58]||(e[58]=[u(" 취소 ",-1)])]),_:1}),n(v,{color:"primary",variant:"flat",loading:s(Ee),onClick:Yt},{default:i(()=>[...e[59]||(e[59]=[u(" 반납 처리 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(V,{modelValue:s(me),"onUpdate:modelValue":e[17]||(e[17]=l=>S(me)?me.value=l:null),"max-width":"500"},{default:i(()=>[n(w,{class:"edit-dialog-card"},{default:i(()=>[n(E,{class:"edit-dialog-title"},{default:i(()=>[...e[60]||(e[60]=[u(" 도서 정보 수정 ",-1)])]),_:1}),n(Q,{class:"edit-dialog-content"},{default:i(()=>[s(L)?(c(),y("div",hl,[o("div",wl,[s(L).image?(c(),y("img",{key:0,src:s(L).image,alt:s(L).title,class:"book-thumbnail"},null,8,Cl)):(c(),y("div",Dl,[...e[61]||(e[61]=[o("span",null,"No Image",-1)])])),o("div",Bl,[o("div",xl,g(s(L).title),1),o("div",Vl,g(s(L).labelNumber||"라벨없음"),1),o("div",Nl,[n(b,{size:"small",class:"mr-1"},{default:i(()=>[...e[62]||(e[62]=[u(" mdi-map-marker ",-1)])]),_:1}),o("span",Rl,g(s(Be)(s(L).location)||"위치없음"),1),s(Pe)(s(D),s(L).location)?(c(),P(b,{key:0,size:"small",class:"ml-1 location-info-icon",onClick:e[13]||(e[13]=ue(l=>Ne(s(L).location),["stop"]))},{default:i(()=>[...e[63]||(e[63]=[u(" mdi-information-outline ",-1)])]),_:1})):$("",!0)])])])])):$("",!0),n(ke,{modelValue:s(k).category,"onUpdate:modelValue":e[14]||(e[14]=l=>s(k).category=l),items:s(Ie),label:"카테고리 *",variant:"outlined",density:"comfortable",loading:s(Se),class:"mb-3"},null,8,["modelValue","items","loading"]),o("div",$l,[n(r,{"model-value":s(wt),label:"센터코드",variant:"outlined",density:"comfortable",readonly:"",disabled:"",class:"center-code-input"},null,8,["model-value"]),n(r,{modelValue:s(k).fourDigits,"onUpdate:modelValue":e[15]||(e[15]=l=>s(k).fourDigits=l),label:"4자리 번호 *",variant:"outlined",density:"comfortable",maxlength:"4","error-messages":s(K),hint:"0001~9999","persistent-hint":"",class:"four-digits-input",onInput:Gt,onBlur:Wt},null,8,["modelValue","error-messages"])]),n(a,{modelValue:s(k).location,"onUpdate:modelValue":e[16]||(e[16]=l=>s(k).location=l),items:s(ne),label:"위치 *",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])]),_:1}),n(te,{class:"edit-dialog-actions"},{default:i(()=>[n(R),n(v,{variant:"text",onClick:et},{default:i(()=>[...e[64]||(e[64]=[u(" 취소 ",-1)])]),_:1}),n(v,{color:"primary",variant:"flat",loading:s(qe),disabled:!s(Xe),onClick:Ht},{default:i(()=>[...e[65]||(e[65]=[u(" 저장 ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(V,{modelValue:s(le),"onUpdate:modelValue":e[19]||(e[19]=l=>S(le)?le.value=l:null),"max-width":"500"},{default:i(()=>[n(w,{class:"rent-confirm-card"},{default:i(()=>[n(E,{class:"rent-confirm-title"},{default:i(()=>[...e[66]||(e[66]=[u(" 대여 신청 도서 확인 ",-1)])]),_:1}),n(Q,{class:"rent-confirm-content"},{default:i(()=>[o("div",Ll,[o("p",null,"대여 신청된 도서가 "+g(s($e).length)+"권 있습니다.",1)]),o("div",El,[(c(!0),y(Ce,null,De(s($e),l=>(c(),y("div",{key:l.id,class:"rent-book-card"},[o("div",ql,[l.image?(c(),y("img",{key:0,src:l.image,alt:l.title,class:"rent-book-thumbnail"},null,8,Il)):(c(),y("div",Sl,[...e[67]||(e[67]=[o("span",null,"NO IMAGE",-1)])])),o("div",Al,[o("div",Ul,g(l.title),1),l.author?(c(),y("div",zl,[e[68]||(e[68]=o("strong",null,"저자:",-1)),u(" "+g(l.author),1)])):$("",!0),l.publisher?(c(),y("div",Tl,[e[69]||(e[69]=o("strong",null,"출판사:",-1)),u(" "+g(l.publisher),1)])):$("",!0),o("div",Pl,[o("span",Ol,[n(b,{size:"x-small",class:"mr-1"},{default:i(()=>[...e[70]||(e[70]=[u("mdi-label",-1)])]),_:1}),u(" "+g(l.labelNumber||"라벨없음"),1)]),o("span",Fl,[n(b,{size:"x-small",class:"mr-1"},{default:i(()=>[...e[71]||(e[71]=[u("mdi-map-marker",-1)])]),_:1}),o("span",Ml,g(s(Be)(l.location)||"위치없음"),1)])])])])]))),128))])]),_:1}),n(te,{class:"rent-confirm-actions"},{default:i(()=>[n(R),n(v,{variant:"text",onClick:e[18]||(e[18]=l=>le.value=!1)},{default:i(()=>[...e[72]||(e[72]=[u(" 나중에 처리하기 ",-1)])]),_:1}),n(v,{color:"primary",variant:"flat",onClick:Bt},{default:i(()=>[...e[73]||(e[73]=[u(" 지금 처리하기 ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(he,{modelValue:s(pe),"onUpdate:modelValue":e[20]||(e[20]=l=>S(pe)?pe.value=l:null),center:s(D),location:s(He),mode:"info"},null,8,["modelValue","center","location"])]),_:1})}}},to=Kt(Gl,[["__scopeId","data-v-f69f0608"]]);export{to as default};
