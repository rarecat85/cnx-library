const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BjECr21Y.js","./entry.DNw42TVG.css"])))=>i.map(i=>d[i]);
import{F as Ct,N as Dt,a as Bt,D as xt,r as g,k as O,o as Ie,e as Vt,_ as le,Y as Nt,O as Y,L as v,g as N,H as m,K as i,P as a,I as n,J as b,Q,G as k,M as c,W as Se,X as Ue,T as I,S as ve,U as Te}from"./BjECr21Y.js";import{g as Et,C as $t,_ as Rt}from"./DMzxK-Uv.js";import{_ as Lt}from"./DO-461KD.js";import{u as qt,g as At,C as It,c as Be,f as ue,p as St}from"./COoe0iU0.js";import{u as Ut}from"./BMHneYiE.js";import{u as Tt}from"./N-qwUYds.js";import"./Xv3F9dhf.js";const zt={class:"books-admin-page"},Ft={class:"center-header mb-6"},Ot={class:"center-header-inner"},Pt={class:"page-title mb-0"},Mt={class:"registered-books-section"},Gt={class:"registered-books-header mb-0"},Wt={class:"d-flex align-center justify-space-between flex-wrap gap-4 mb-4"},Ht={class:"text-body-1"},Qt={class:"text-body-2 text-medium-emphasis"},jt={class:"d-flex align-center registered-search-group"},Xt={class:"d-flex align-center justify-space-between flex-wrap gap-4 mt-4"},Jt={class:"d-flex action-buttons"},Kt={key:0,class:"text-center py-8"},Yt={key:1,class:"registered-books-grid"},Zt=["onClick"],es={class:"book-group-info"},ts=["src","alt"],ss={class:"group-meta"},as={class:"group-title"},os={key:0,class:"group-author"},ls={key:1,class:"group-publisher"},ns={class:"group-stats"},rs={class:"stat-total"},is={key:0,class:"stat-available"},us={key:1,class:"stat-rented"},ds={key:2,class:"stat-requested"},cs={key:2,class:"group-locations"},vs={key:0,class:"book-copies-list"},ms={class:"copy-content"},ps={class:"copy-row-top"},fs={class:"copy-status"},gs={key:4,class:"copy-user-info"},ys=["onClick"],_s={class:"copy-info-row"},bs={class:"copy-label-number"},hs={class:"copy-location"},ws={class:"copy-actions"},ks={key:2,class:"text-center py-8 text-medium-emphasis empty-state"},Cs={key:0},Ds={key:1},Bs={class:"drawer-content"},xs={class:"rent-dialog-content"},Vs={class:"mb-4 text-body-2 text-medium-emphasis"},Ns={class:"rent-dialog-actions"},Es={key:0,class:"book-info-preview mb-4"},$s={class:"book-info-preview-inner"},Rs=["src","alt"],Ls={class:"book-meta"},qs={class:"book-title"},As={class:"book-current-label"},Is={class:"book-current-location"},Ss={class:"label-number-inputs mb-3"},me=5,Us={__name:"index",setup(Ts){const{user:xe}=Ut(),{getBooksByCenter:ze,rentBook:Ve,deleteBook:Fe,updateBookInfo:Oe,checkLabelNumberExists:Pe,getCategories:Me,calculateBookStatus:S}=qt(),{confirm:de,alert:V}=Dt(),{$firebaseFirestore:Ge}=Bt(),q=Ge,ne=xt("navigationDrawer",()=>!1),Ne=g(280),pe=[...$t],D=g(""),We=g(""),Z=g([]),fe=g(!1),j=g(""),M=g("date"),He=[{title:"등록일순",value:"date"},{title:"제목순",value:"title"},{title:"대여중도서",value:"rented"},{title:"연체중도서",value:"overdue"},{title:"대여신청도서",value:"requested"},{title:"신규등록도서",value:"new"}],y=g([]),ce=g(!1),U=g(!1),X=g(new Set),ge=g({}),ye=g({}),se=g(!1),J=g([]),_e=g(!1),G=g(""),W=g(""),P=g(""),re=g(!1),$=g(null),be=g(!1),he=g([]),we=g(!1),ee=g(""),f=g({category:"",fourDigits:"",location:""}),Qe=O(()=>At()),je=O(()=>It[D.value]||"1");O(()=>!f.value.category||!f.value.fourDigits?"":Be(f.value.category,D.value,f.value.fourDigits));const Ee=O(()=>f.value.category&&f.value.fourDigits&&f.value.fourDigits.length===4&&/^\d{4}$/.test(f.value.fourDigits)&&f.value.location&&!ee.value);Ie(()=>{const t=()=>{Ne.value=window.innerWidth>=769?360:280};t(),window.addEventListener("resize",t),Vt(()=>{window.removeEventListener("resize",t)})});const Xe=async()=>{if(!xe.value||!q)return"";try{const{doc:t,getDoc:e}=await le(async()=>{const{doc:r,getDoc:p}=await import("./BjECr21Y.js").then(u=>u.aE);return{doc:r,getDoc:p}},__vite__mapDeps([0,1]),import.meta.url),s=t(q,"users",xe.value.uid),o=await e(s);if(o.exists())return o.data().workplace||""}catch(t){console.error("사용자 근무지 정보 가져오기 오류:",t)}return""};Ie(async()=>{const t=await Xe();We.value=t,D.value=t?Et(t):pe[0],await K()});const Je=async()=>{X.value.clear(),y.value=[],await K()},K=async()=>{try{fe.value=!0;const t=await ze(D.value);Z.value=t,await Ke(t)}catch(t){console.error("등록된 도서 로드 오류:",t),Z.value=[]}finally{fe.value=!1}},Ke=async t=>{if(!q)return;const{doc:e,getDoc:s}=await le(async()=>{const{doc:u,getDoc:h}=await import("./BjECr21Y.js").then(B=>B.aE);return{doc:u,getDoc:h}},__vite__mapDeps([0,1]),import.meta.url),o=[...new Set(t.filter(u=>u.rentedBy).map(u=>u.rentedBy))],r=[...new Set(t.filter(u=>u.requestedBy).map(u=>u.requestedBy))],p=[...new Set([...o,...r])];for(const u of p)if(!(ge.value[u]&&ye.value[u]))try{const h=e(q,"users",u),B=await s(h);if(B.exists()){const C=B.data(),R=(C.email||"").split("@")[0]||"",x=C.name||"",w=`${C.workplace||""} ${x}(${R})`;ge.value[u]=w,ye.value[u]=w}}catch(h){console.error("대여자/신청자 정보 로드 오류:",h)}},$e=t=>t.rentedBy&&ge.value[t.rentedBy]||"",ke=t=>t.requestedBy&&ye.value[t.requestedBy]||"",Ye=()=>{},Re=O(()=>{const t=new Map;for(const e of Z.value){const s=e.isbn13||e.isbn||e.id;t.has(s)||t.set(s,{isbn:s,title:e.title,author:e.author,publisher:e.publisher,image:e.image,copies:[],totalCount:0,availableCount:0,rentedCount:0,requestedCount:0,locations:[]});const o=t.get(s);o.copies.push(e),o.totalCount++;const r=S(e);r?r==="rented"||r==="overdue"?o.rentedCount++:r==="requested"&&o.requestedCount++:o.availableCount++,e.location&&!o.locations.includes(e.location)&&o.locations.push(e.location)}for(const e of t.values())e.copies.sort((s,o)=>{const r=s.labelNumber||"",p=o.labelNumber||"";return r.localeCompare(p,"ko")});return Array.from(t.values())}),ie=O(()=>{let t=[...Re.value];if(j.value.trim()){const e=j.value.toLowerCase();t=t.filter(s=>{const o=(s.title||"").toLowerCase(),r=(s.author||"").toLowerCase(),p=(s.publisher||"").toLowerCase();return o.includes(e)||r.includes(e)||p.includes(e)?!0:s.copies.some(u=>(u.labelNumber||"").toLowerCase().includes(e))})}return M.value==="title"?t.sort((e,s)=>{const o=(e.title||"").toLowerCase(),r=(s.title||"").toLowerCase();return o.localeCompare(r,"ko")}):M.value==="date"?t.sort((e,s)=>{const o=e.copies[0]?.registeredAt?.toDate?.()||new Date(0);return(s.copies[0]?.registeredAt?.toDate?.()||new Date(0))-o}):M.value==="rented"?t=t.filter(e=>e.rentedCount>0):M.value==="overdue"?t=t.filter(e=>e.copies.some(s=>S(s)==="overdue")):M.value==="requested"?t=t.filter(e=>e.requestedCount>0):M.value==="new"&&(t=t.filter(e=>e.copies.some(s=>s.location==="구매칸"))),t}),Ze=O(()=>Z.value.length),et=O(()=>Re.value.length),tt=O(()=>Z.value.filter(t=>S(t)==="rented").length),st=O(()=>Z.value.filter(t=>S(t)==="overdue").length),at=O(()=>Z.value.filter(t=>S(t)==="requested").length),ae=t=>S(t),ot=t=>{X.value.has(t)?X.value.delete(t):X.value.add(t),X.value=new Set(X.value)},lt=t=>t.length===0?"":t.length===1?ue(t[0]):t.length===2?t.map(e=>ue(e)).join(", "):`${ue(t[0])} 외 ${t.length-1}곳`,te=t=>y.value.some(e=>e.id===t.id),nt=t=>t.copies.every(e=>te(e)),rt=t=>{const e=t.copies.filter(s=>te(s)).length;return e>0&&e<t.copies.length},it=(t,e)=>{e?te(t)||y.value.push(t):y.value=y.value.filter(s=>s.id!==t.id),Ce()},ut=(t,e)=>{if(e)for(const s of t.copies)te(s)||y.value.push(s);else{const s=t.copies.map(o=>o.id);y.value=y.value.filter(o=>!s.includes(o.id))}Ce()},dt=t=>{t?y.value=ie.value.flatMap(e=>e.copies):y.value=[]},Ce=()=>{const t=ie.value.flatMap(e=>e.copies);ce.value=t.length>0&&t.every(e=>te(e))};Nt(()=>ie.value,()=>{Ce()});const ct=async()=>{try{we.value=!0;const t=await Me(D.value);he.value=t}catch(t){console.error("카테고리 로드 오류:",t),he.value=[]}finally{we.value=!1}},vt=t=>{const e=t.target.value.replace(/\D/g,"").slice(0,4);f.value.fourDigits=e,ee.value=""},mt=async()=>{if(!f.value.category||!f.value.fourDigits||f.value.fourDigits.length!==4)return;const t=Be(f.value.category,D.value,f.value.fourDigits);if($.value&&t===$.value.labelNumber){ee.value="";return}try{await Pe(t,D.value)?ee.value="이미 사용중인 라벨번호입니다.":ee.value=""}catch(e){console.error("라벨번호 중복 체크 오류:",e)}},pt=async t=>{$.value=t;const e=St(t.labelNumber);f.value={category:t.category||e?.category||"",fourDigits:e?.fourDigits||"",location:t.location||"구매칸"},ee.value="",await ct(),re.value=!0},Le=()=>{re.value=!1,$.value=null},ft=async()=>{if(!(!$.value||!Ee.value))try{be.value=!0;const t=Be(f.value.category,D.value,f.value.fourDigits);await Oe($.value.labelNumber||$.value.id.split("_")[0],D.value,{category:f.value.category,labelNumber:t,location:f.value.location}),Le(),await K(),await V("도서 정보가 수정되었습니다.",{type:"success"})}catch(t){console.error("도서 정보 수정 오류:",t),await V(t.message||"도서 정보 수정에 실패했습니다.",{type:"error"})}finally{be.value=!1}},gt=async()=>{if(y.value.length===0)return;const t=[],e=[];for(const o of y.value){const r=S(o);r==="rented"||r==="overdue"?e.push({book:o,reason:"대여중"}):r==="requested"?e.push({book:o,reason:"대여신청중"}):t.push(o)}if(t.length===0){const o=e.map(r=>`• ${r.book.title} (${r.reason})`).join(`
`);await V(`선택한 도서를 삭제할 수 없습니다.

${o}

대여중/대여신청중인 도서는 반납 또는 신청 취소 후 삭제해주세요.`,{type:"warning"});return}let s=`선택한 ${y.value.length}권 중 ${t.length}권의 도서를 삭제하시겠습니까?`;if(e.length>0){const o=e.map(r=>`• ${r.book.title} (${r.reason})`).join(`
`);s+=`

⚠️ 다음 도서는 삭제할 수 없습니다:
${o}`}if(await de(s))try{U.value=!0;const o=t.map(r=>{const p=r.labelNumber||r.id.split("_")[0];return Fe(p,D.value)});await Promise.all(o),y.value=[],await K(),e.length>0?await V(`${t.length}권의 도서가 삭제되었습니다.
(${e.length}권은 대여중/대여신청중으로 삭제되지 않았습니다.)`,{type:"success"}):await V(`${t.length}권의 도서가 삭제되었습니다.`,{type:"success"})}catch(o){console.error("도서 삭제 오류:",o),await V("도서 삭제에 실패했습니다.",{type:"error"})}finally{U.value=!1}},yt=async()=>{if(y.value.length===0)return;const t=y.value.filter(e=>{const s=S(e);return s!=="rented"&&s!=="overdue"});if(t.length===0){await V("선택한 도서가 모두 대여중입니다.",{type:"warning"});return}J.value=t,G.value=D.value,W.value="",P.value="",se.value=!0},qe=async t=>{if(!q||!t)return 0;try{const{collection:e,query:s,where:o,getDocs:r}=await le(async()=>{const{collection:C,query:d,where:R,getDocs:x}=await import("./BjECr21Y.js").then(E=>E.aE);return{collection:C,query:d,where:R,getDocs:x}},__vite__mapDeps([0,1]),import.meta.url),p=e(q,"books"),u=s(p,o("rentedBy","==",t)),h=await r(u);let B=0;return h.forEach(C=>{const d=C.data();(d.status==="rented"||d.status==="overdue")&&B++}),B}catch(e){return console.error("대여 권수 조회 오류:",e),0}},_t=async t=>{if(S(t)==="requested"&&t.requestedBy){if(await qe(t.requestedBy)>=me){await V(`신청자가 이미 ${me}권을 대여중입니다.
반납 후 대여 처리해주세요.`,{type:"warning"});return}if(!await de(`신청자 정보로 대여 처리하시겠습니까?

도서: ${t.title}
라벨번호: ${t.labelNumber||"-"}
신청자: ${ke(t)}`))return;try{U.value=!0;const o=t.labelNumber||t.id.split("_")[0];await Ve(o,D.value,t.requestedBy,t.isbn),await K(),await V("대여 처리가 완료되었습니다.",{type:"success"})}catch(o){console.error("대여 처리 오류:",o),await V(o.message||"대여 처리에 실패했습니다.",{type:"error"})}finally{U.value=!1}return}J.value=[t],G.value=D.value,W.value="",P.value="",se.value=!0},Ae=()=>{se.value=!1,J.value=[],G.value="",W.value="",P.value=""},bt=async()=>{if(!(!G.value||!W.value))try{_e.value=!0,P.value="";const{collection:t,query:e,where:s,getDocs:o}=await le(async()=>{const{collection:w,query:L,where:A,getDocs:T}=await import("./BjECr21Y.js").then(z=>z.aE);return{collection:w,query:L,where:A,getDocs:T}},__vite__mapDeps([0,1]),import.meta.url),r=t(q,"users"),p=e(r,s("email","==",W.value)),u=await o(p);if(u.empty){P.value="해당 이메일의 사용자를 찾을 수 없습니다.";return}const h=u.docs[0].data();if(h.center!==G.value){P.value=`해당 사용자는 ${h.center} 소속입니다.`;return}const C=u.docs[0].id,d=await qe(C),R=J.value.length,x=me-d;if(x<=0){P.value=`해당 사용자가 이미 ${me}권을 대여중입니다.`;return}if(R>x){P.value=`해당 사용자는 ${x}권까지만 추가 대여 가능합니다. (현재 ${d}권 대여중)`;return}for(const w of J.value){const L=w.labelNumber||w.id.split("_")[0];await Ve(L,D.value,C,w.isbn)}const E=J.value.length;await K(),y.value=y.value.filter(w=>!J.value.some(L=>L.id===w.id)),Ae(),await V(`${E}권의 도서가 대여 처리되었습니다.`,{type:"success"})}catch(t){console.error("도서 대여 오류:",t),P.value=t.message||"대여 처리에 실패했습니다."}finally{_e.value=!1}},ht=async()=>{if(y.value.length===0)return;const t=y.value.filter(e=>{const s=S(e);return s==="rented"||s==="overdue"});if(t.length===0){await V("선택한 도서 중 대여중인 도서가 없습니다.",{type:"warning"});return}if(await de(`선택한 ${t.length}권의 도서를 반납 처리하시겠습니까?`))try{U.value=!0;const{doc:e,updateDoc:s,collection:o,addDoc:r,query:p,where:u,getDocs:h,serverTimestamp:B,deleteField:C}=await le(async()=>{const{doc:d,updateDoc:R,collection:x,addDoc:E,query:w,where:L,getDocs:A,serverTimestamp:T,deleteField:z}=await import("./BjECr21Y.js").then(F=>F.aE);return{doc:d,updateDoc:R,collection:x,addDoc:E,query:w,where:L,getDocs:A,serverTimestamp:T,deleteField:z}},__vite__mapDeps([0,1]),import.meta.url);for(const d of t){const R=d.labelNumber||d.id.split("_")[0],x=d.id,E=d.rentedBy,w=d.rentedAt,L=e(q,"books",x);if(await s(L,{status:"available",rentedBy:C(),rentedAt:C(),expectedReturnDate:C()}),E){const A=o(q,"rentalHistory"),T=d.isbn13||d.isbn||"",z=p(A,u("userId","==",E),u("isbn13","==",T)),F=await h(z);if(F.empty)await r(A,{bookId:x,labelNumber:R,isbn13:d.isbn13||"",isbn:d.isbn||"",title:d.title||"",author:d.author||"",publisher:d.publisher||"",cover:d.cover||d.image||"",center:d.center||"",userId:E,rentedAt:w,returnedAt:B(),rentCount:1});else{const H=F.docs[0],l=H.data();await s(e(q,"rentalHistory",H.id),{rentedAt:w,returnedAt:B(),rentCount:(l.rentCount||1)+1})}}}y.value=[],await K(),await V(`${t.length}권의 도서가 반납 처리되었습니다.`,{type:"success"})}catch(e){console.error("도서 반납 오류:",e),await V("도서 반납에 실패했습니다.",{type:"error"})}finally{U.value=!1}},wt=async t=>{const e=S(t);if(e!=="rented"&&e!=="overdue"){await V("대여중인 도서가 아닙니다.",{type:"warning"});return}if(await de(`"${t.title}" 도서를 반납 처리하시겠습니까?
라벨번호: ${t.labelNumber||"-"}`))try{U.value=!0;const{doc:s,updateDoc:o,collection:r,addDoc:p,query:u,where:h,getDocs:B,serverTimestamp:C,deleteField:d}=await le(async()=>{const{doc:A,updateDoc:T,collection:z,addDoc:F,query:H,where:l,getDocs:De,serverTimestamp:_,deleteField:oe}=await import("./BjECr21Y.js").then(kt=>kt.aE);return{doc:A,updateDoc:T,collection:z,addDoc:F,query:H,where:l,getDocs:De,serverTimestamp:_,deleteField:oe}},__vite__mapDeps([0,1]),import.meta.url),R=t.id,x=t.rentedBy,E=t.rentedAt,w=t.labelNumber||t.id.split("_")[0],L=s(q,"books",R);if(await o(L,{status:"available",rentedBy:d(),rentedAt:d(),expectedReturnDate:d()}),x){const A=r(q,"rentalHistory"),T=t.isbn13||t.isbn||"",z=u(A,h("userId","==",x),h("isbn13","==",T)),F=await B(z);if(F.empty)await p(A,{bookId:R,labelNumber:w,isbn13:t.isbn13||"",isbn:t.isbn||"",title:t.title||"",author:t.author||"",publisher:t.publisher||"",cover:t.cover||t.image||"",center:t.center||"",userId:x,rentedAt:E,returnedAt:C(),rentCount:1});else{const H=F.docs[0],l=H.data();await o(s(q,"rentalHistory",H.id),{rentedAt:E,returnedAt:C(),rentCount:(l.rentCount||1)+1})}}await K(),await V("도서가 반납 처리되었습니다.",{type:"success"})}catch(s){console.error("도서 반납 오류:",s),await V("도서 반납에 실패했습니다.",{type:"error"})}finally{U.value=!1}};return Tt({title:"도서 관리 - CNX Library",meta:[{name:"description",content:"도서 검색 및 등록 관리"}]}),(t,e)=>{const s=N("v-select"),o=N("v-text-field"),r=N("v-checkbox"),p=N("v-btn"),u=N("v-progress-circular"),h=N("v-icon"),B=N("v-chip"),C=N("v-expand-transition"),d=Rt,R=Lt,x=N("v-navigation-drawer"),E=N("v-spacer"),w=N("v-card"),L=N("v-dialog"),A=N("v-card-title"),T=N("v-autocomplete"),z=N("v-card-text"),F=N("v-card-actions"),H=N("v-app");return m(),Y(H,null,{default:v(()=>[i(d,{"header-type":"back-home","show-header-actions":!0,onToggleDrawer:e[5]||(e[5]=l=>ne.value=!a(ne))},{default:v(()=>[n("div",zt,[n("div",Ft,[n("div",Ot,[n("h1",Pt,b(a(D))+" 도서 관리 ",1),i(s,{modelValue:a(D),"onUpdate:modelValue":[e[0]||(e[0]=l=>Q(D)?D.value=l:null),Je],items:pe,variant:"outlined",density:"comfortable","hide-details":"",class:"center-select"},null,8,["modelValue"])])]),n("div",Mt,[n("div",Gt,[n("div",Wt,[n("div",Ht,[e[14]||(e[14]=c(" 총 ",-1)),n("strong",null,b(a(Ze)),1),c("권 ("+b(a(et))+"종) ",1)]),n("div",Qt,[e[15]||(e[15]=c(" 대여중 ",-1)),n("strong",null,b(a(tt)),1),e[16]||(e[16]=c("권, 연체중 ",-1)),n("strong",null,b(a(st)),1),e[17]||(e[17]=c("권, 대여신청 ",-1)),n("strong",null,b(a(at)),1),e[18]||(e[18]=c("권 ",-1))])]),n("div",jt,[i(o,{modelValue:a(j),"onUpdate:modelValue":[e[1]||(e[1]=l=>Q(j)?j.value=l:null),Ye],label:"도서/라벨번호 검색","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"comfortable","hide-details":"",clearable:"",class:"registered-search-input"},null,8,["modelValue"]),i(s,{modelValue:a(M),"onUpdate:modelValue":e[2]||(e[2]=l=>Q(M)?M.value=l:null),items:He,label:"정렬",variant:"outlined",density:"comfortable","hide-details":"",class:"sort-select"},null,8,["modelValue"])]),n("div",Xt,[i(r,{modelValue:a(ce),"onUpdate:modelValue":[e[3]||(e[3]=l=>Q(ce)?ce.value=l:null),dt],label:"전체선택","hide-details":"",class:"select-all-checkbox"},null,8,["modelValue"]),n("div",Jt,[i(p,{class:"action-btn",variant:"flat",size:"small",disabled:a(y).length===0,loading:a(U),onClick:gt},{default:v(()=>[...e[19]||(e[19]=[c(" 도서 삭제 ",-1)])]),_:1},8,["disabled","loading"]),i(p,{class:"action-btn",variant:"flat",size:"small",disabled:a(y).length===0,loading:a(U),onClick:yt},{default:v(()=>[...e[20]||(e[20]=[c(" 대여 처리 ",-1)])]),_:1},8,["disabled","loading"]),i(p,{class:"action-btn",variant:"flat",size:"small",disabled:a(y).length===0,loading:a(U),onClick:ht},{default:v(()=>[...e[21]||(e[21]=[c(" 반납 처리 ",-1)])]),_:1},8,["disabled","loading"])])])]),a(fe)?(m(),k("div",Kt,[i(u,{indeterminate:"",color:"primary"})])):a(ie).length>0?(m(),k("div",Yt,[(m(!0),k(Se,null,Ue(a(ie),(l,De)=>(m(),k("div",{key:`group-${De}`,class:"book-group"},[n("div",{class:"book-group-header",onClick:_=>ot(l.isbn)},[n("div",es,[l.copies.length>1?(m(),Y(r,{key:0,"model-value":nt(l),indeterminate:rt(l),"hide-details":"",class:"group-checkbox",onClick:e[4]||(e[4]=ve(()=>{},["stop"])),"onUpdate:modelValue":_=>ut(l,_)},null,8,["model-value","indeterminate","onUpdate:modelValue"])):I("",!0),l.image?(m(),k("img",{key:1,src:l.image,alt:l.title,class:"group-thumbnail"},null,8,ts)):I("",!0),n("div",ss,[n("div",as,b(l.title),1),l.author?(m(),k("div",os,[e[22]||(e[22]=n("strong",null,"저자:",-1)),c(" "+b(l.author),1)])):I("",!0),l.publisher?(m(),k("div",ls,[e[23]||(e[23]=n("strong",null,"출판사:",-1)),c(" "+b(l.publisher),1)])):I("",!0),n("div",ns,[n("span",rs,b(l.totalCount)+"권",1),l.availableCount>0?(m(),k("span",is,"대여가능 "+b(l.availableCount)+"권",1)):I("",!0),l.rentedCount>0?(m(),k("span",us,"대여중 "+b(l.rentedCount)+"권",1)):I("",!0),l.requestedCount>0?(m(),k("span",ds,"신청 "+b(l.requestedCount)+"권",1)):I("",!0)]),l.locations.length>0?(m(),k("div",cs,[i(h,{size:"small",class:"mr-1"},{default:v(()=>[...e[24]||(e[24]=[c(" mdi-map-marker ",-1)])]),_:1}),c(" "+b(lt(l.locations)),1)])):I("",!0)])]),i(h,{class:Te(["expand-icon",{expanded:a(X).has(l.isbn)}])},{default:v(()=>[...e[25]||(e[25]=[c(" mdi-chevron-down ",-1)])]),_:1},8,["class"])],8,Zt),i(C,null,{default:v(()=>[a(X).has(l.isbn)?(m(),k("div",vs,[(m(!0),k(Se,null,Ue(l.copies,_=>(m(),k("div",{key:_.id,class:Te(["book-copy-item",{selected:te(_)}])},[i(r,{"model-value":te(_),"hide-details":"",class:"copy-checkbox","onUpdate:modelValue":oe=>it(_,oe)},null,8,["model-value","onUpdate:modelValue"]),n("div",ms,[n("div",ps,[n("div",fs,[ae(_)==="rented"?(m(),Y(B,{key:0,size:"x-small",color:"primary",variant:"flat"},{default:v(()=>[...e[26]||(e[26]=[c(" 대여중 ",-1)])]),_:1})):ae(_)==="overdue"?(m(),Y(B,{key:1,size:"x-small",color:"error",variant:"flat"},{default:v(()=>[...e[27]||(e[27]=[c(" 연체중 ",-1)])]),_:1})):ae(_)==="requested"?(m(),Y(B,{key:2,size:"x-small",color:"warning",variant:"flat"},{default:v(()=>[...e[28]||(e[28]=[c(" 대여신청 ",-1)])]),_:1})):(m(),Y(B,{key:3,size:"x-small",color:"success",variant:"outlined"},{default:v(()=>[...e[29]||(e[29]=[c(" 대여가능 ",-1)])]),_:1})),$e(_)||ke(_)?(m(),k("span",gs,b($e(_)||ke(_)),1)):I("",!0)]),n("a",{href:"#",class:"copy-edit-link",onClick:ve(oe=>pt(_),["prevent"])}," 정보수정 ",8,ys)]),n("div",_s,[n("span",bs,b(_.labelNumber||"라벨없음"),1),e[31]||(e[31]=n("span",{class:"copy-divider"},"|",-1)),n("span",hs,[i(h,{size:"small",class:"mr-1"},{default:v(()=>[...e[30]||(e[30]=[c(" mdi-map-marker ",-1)])]),_:1}),c(" "+b(a(ue)(_.location)||"위치없음"),1)])]),n("div",ws,[ae(_)==="rented"||ae(_)==="overdue"?(m(),Y(p,{key:0,color:"primary",size:"small",variant:"flat",onClick:ve(oe=>wt(_),["stop"])},{default:v(()=>[...e[32]||(e[32]=[c(" 반납처리 ",-1)])]),_:1},8,["onClick"])):(m(),Y(p,{key:1,color:"primary",size:"small",variant:"flat",onClick:ve(oe=>_t(_),["stop"])},{default:v(()=>[c(b(ae(_)==="requested"?"대여승인":"대여처리"),1)]),_:2},1032,["onClick"]))])])],2))),128))])):I("",!0)]),_:2},1024)]))),128))])):(m(),k("div",ks,[i(h,{size:"48",color:"grey-lighten-1",class:"mb-4"},{default:v(()=>[c(b(a(j)?"mdi-book-search-outline":"mdi-book-off-outline"),1)]),_:1}),a(j)?(m(),k("p",Cs,[e[33]||(e[33]=c(" '",-1)),n("strong",null,b(a(j)),1),e[34]||(e[34]=c("'에 대한 검색 결과가 없습니다. ",-1))])):(m(),k("p",Ds," 등록된 도서가 없습니다. "))]))])])]),_:1}),i(x,{modelValue:a(ne),"onUpdate:modelValue":e[6]||(e[6]=l=>Q(ne)?ne.value=l:null),location:"right",temporary:"",width:a(Ne),class:"side-navigation"},{default:v(()=>[n("div",Bs,[i(R)])]),_:1},8,["modelValue","width"]),i(L,{modelValue:a(se),"onUpdate:modelValue":e[9]||(e[9]=l=>Q(se)?se.value=l:null),"max-width":"400",persistent:""},{default:v(()=>[i(w,{class:"rent-dialog-card"},{default:v(()=>[e[37]||(e[37]=n("div",{class:"rent-dialog-title text-h6"}," 대여자 정보 입력 ",-1)),n("div",xs,[n("div",Vs," 대여 처리할 도서: "+b(a(J).length)+"권 ",1),i(s,{modelValue:a(G),"onUpdate:modelValue":e[7]||(e[7]=l=>Q(G)?G.value=l:null),items:pe,label:"센터",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),i(o,{modelValue:a(W),"onUpdate:modelValue":e[8]||(e[8]=l=>Q(W)?W.value=l:null),label:"이메일",variant:"outlined",density:"comfortable",placeholder:"example@email.com","error-messages":a(P)},null,8,["modelValue","error-messages"])]),n("div",Ns,[i(E),i(p,{variant:"text",onClick:Ae},{default:v(()=>[...e[35]||(e[35]=[c(" 취소 ",-1)])]),_:1}),i(p,{color:"primary",variant:"flat",loading:a(_e),disabled:!a(G)||!a(W),onClick:bt},{default:v(()=>[...e[36]||(e[36]=[c(" 대여 처리 ",-1)])]),_:1},8,["loading","disabled"])])]),_:1})]),_:1},8,["modelValue"]),i(L,{modelValue:a(re),"onUpdate:modelValue":e[13]||(e[13]=l=>Q(re)?re.value=l:null),"max-width":"500",persistent:""},{default:v(()=>[i(w,{class:"edit-dialog-card"},{default:v(()=>[i(A,{class:"edit-dialog-title"},{default:v(()=>[...e[38]||(e[38]=[c(" 도서 정보 수정 ",-1)])]),_:1}),i(z,{class:"edit-dialog-content"},{default:v(()=>[a($)?(m(),k("div",Es,[n("div",$s,[a($).image?(m(),k("img",{key:0,src:a($).image,alt:a($).title,class:"book-thumbnail"},null,8,Rs)):I("",!0),n("div",Ls,[n("div",qs,b(a($).title),1),n("div",As,b(a($).labelNumber||"라벨없음"),1),n("div",Is,[i(h,{size:"small",class:"mr-1"},{default:v(()=>[...e[39]||(e[39]=[c(" mdi-map-marker ",-1)])]),_:1}),c(" "+b(a(ue)(a($).location)||"위치없음"),1)])])])])):I("",!0),i(T,{modelValue:a(f).category,"onUpdate:modelValue":e[10]||(e[10]=l=>a(f).category=l),items:a(he),label:"카테고리 *",variant:"outlined",density:"comfortable",loading:a(we),class:"mb-3"},null,8,["modelValue","items","loading"]),n("div",Ss,[i(o,{"model-value":a(je),label:"센터코드",variant:"outlined",density:"comfortable",readonly:"",disabled:"",class:"center-code-input"},null,8,["model-value"]),i(o,{modelValue:a(f).fourDigits,"onUpdate:modelValue":e[11]||(e[11]=l=>a(f).fourDigits=l),label:"4자리 번호 *",variant:"outlined",density:"comfortable",maxlength:"4","error-messages":a(ee),hint:"0001~9999","persistent-hint":"",class:"four-digits-input",onInput:vt,onBlur:mt},null,8,["modelValue","error-messages"])]),i(s,{modelValue:a(f).location,"onUpdate:modelValue":e[12]||(e[12]=l=>a(f).location=l),items:a(Qe),label:"위치 *",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])]),_:1}),i(F,{class:"edit-dialog-actions"},{default:v(()=>[i(E),i(p,{variant:"text",onClick:Le},{default:v(()=>[...e[40]||(e[40]=[c(" 취소 ",-1)])]),_:1}),i(p,{color:"primary",variant:"flat",loading:a(be),disabled:!a(Ee),onClick:ft},{default:v(()=>[...e[41]||(e[41]=[c(" 저장 ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},Hs=Ct(Us,[["__scopeId","data-v-4e322fee"]]);export{Hs as default};
