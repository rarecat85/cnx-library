const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CvDJqPe-.js","./entry.DNw42TVG.css"])))=>i.map(i=>d[i]);
import{F as qt,N as St,a as Ut,D as Ot,r as m,k as R,o as Ue,e as Tt,_ as le,Y as Oe,O as Q,L as p,g as E,H as f,K as i,P as o,I as n,J as h,Q as P,G as B,M as d,T as te,W as Te,X as Fe,U as ze,S as Be}from"./CvDJqPe-.js";import{g as Ft,C as zt,_ as Pt}from"./D8qTLWOZ.js";import{_ as Mt}from"./WwNgRz5i.js";import{u as Gt,g as Pe,C as Ht,c as xe,f as Me,p as Wt}from"./BFdgS7Lg.js";import{u as Qt}from"./BcFuV-z-.js";import{u as jt}from"./Dbt3lYbw.js";import"./BnKtqovu.js";const Xt={class:"books-admin-page"},Jt={class:"center-header mb-6"},Kt={class:"center-header-inner"},Yt={class:"page-title mb-0"},Zt={class:"registered-books-section"},eo={class:"registered-books-header mb-0"},to={class:"d-flex align-center justify-space-between flex-wrap gap-4 mb-4"},oo={class:"text-body-1"},so={class:"text-body-2 text-medium-emphasis"},ao={class:"d-flex align-center registered-search-group"},lo={class:"d-flex align-center justify-space-between flex-wrap gap-4 mt-4"},no={class:"d-flex action-buttons"},ro={key:0,class:"text-center py-8"},io={key:1,class:"registered-books-section"},uo={class:"registered-books-grid"},co=["onClick"],vo=["src","alt"],mo={key:1,class:"book-thumbnail-placeholder"},po={class:"book-meta"},fo={class:"book-title"},go={key:0,class:"book-author"},yo={key:1,class:"book-publisher"},bo={class:"book-count"},_o={class:"book-copies-list"},ho=["onClick"],wo={class:"copy-content"},ko={class:"copy-row-top"},Co={class:"copy-status"},Do={key:4,class:"copy-user-info"},Bo=["onClick"],xo={class:"copy-info-row"},Vo={class:"copy-label-number"},No={class:"copy-location"},Eo={class:"copy-actions"},Ro={key:0,class:"load-more-section"},$o={key:2,class:"text-center py-8 text-medium-emphasis empty-state"},Io={key:0},Lo={key:1},Ao={class:"drawer-content"},qo={class:"rent-dialog-content"},So={class:"mb-4 text-body-2 text-medium-emphasis"},Uo={class:"rent-dialog-actions"},Oo={key:0,class:"book-info-preview mb-4"},To={class:"book-info-preview-inner"},Fo=["src","alt"],zo={key:1,class:"book-thumbnail-placeholder"},Po={class:"book-meta"},Mo={class:"book-title"},Go={class:"book-current-label"},Ho={class:"book-current-location"},Wo={class:"label-number-inputs mb-3"},Ge=10,pe=5,Qo={__name:"index",setup(jo){const{user:Ve}=Qt(),{getBooksByCenter:He,rentBook:Ne,deleteBook:We,updateBookInfo:Qe,checkLabelNumberExists:je,getCategories:Xe,calculateBookStatus:U}=Gt(),{confirm:de,alert:x}=St(),{$firebaseFirestore:Je}=Ut(),L=Je,ne=Ot("navigationDrawer",()=>!1),Ee=m(280),fe=[...zt],D=m(""),Ke=m(""),J=m([]),ge=m(!1),G=m(""),S=m("label"),oe=m(""),re=m("asc"),Ye=[{title:"오름차순",value:"asc"},{title:"내림차순",value:"desc"}],Ze=[{title:"라벨번호순",value:"label"},{title:"대여중도서",value:"rented"},{title:"연체중도서",value:"overdue"},{title:"대여신청도서",value:"requested"},{title:"위치별로 보기",value:"location"}],ve=t=>{if(!t)return 9999;const e=t.split("_");if(e.length<2)return 9999;const s=e[1];return parseInt(s.slice(-4))||9999},y=m([]),me=m(!1),O=m(!1),ie=m(10),ye=m({}),be=m({}),se=m(!1),j=m([]),_e=m(!1),H=m(""),W=m(""),M=m(""),ue=m(!1),$=m(null),he=m(!1),we=m([]),ke=m(!1),K=m(""),g=m({category:"",fourDigits:"",location:""}),et=R(()=>Pe()),tt=R(()=>[{title:"전체",value:""},...Pe()]),ot=R(()=>Ht[D.value]||"1");R(()=>!g.value.category||!g.value.fourDigits?"":xe(g.value.category,D.value,g.value.fourDigits));const Re=R(()=>g.value.category&&g.value.fourDigits&&g.value.fourDigits.length===4&&/^\d{4}$/.test(g.value.fourDigits)&&g.value.location&&!K.value);Ue(()=>{const t=()=>{Ee.value=window.innerWidth>=769?360:280};t(),window.addEventListener("resize",t),Tt(()=>{window.removeEventListener("resize",t)})});const st=async()=>{if(!Ve.value||!L)return"";try{const{doc:t,getDoc:e}=await le(async()=>{const{doc:r,getDoc:v}=await import("./CvDJqPe-.js").then(u=>u.aE);return{doc:r,getDoc:v}},__vite__mapDeps([0,1]),import.meta.url),s=t(L,"users",Ve.value.uid),a=await e(s);if(a.exists())return a.data().workplace||""}catch(t){console.error("사용자 근무지 정보 가져오기 오류:",t)}return""};Ue(async()=>{const t=await st();Ke.value=t,D.value=t?Ft(t):fe[0],await X()});const at=async()=>{y.value=[],await X()},X=async()=>{try{ge.value=!0;const t=await He(D.value);J.value=t,await lt(t)}catch(t){console.error("등록된 도서 로드 오류:",t),J.value=[]}finally{ge.value=!1}},lt=async t=>{if(!L)return;const{doc:e,getDoc:s}=await le(async()=>{const{doc:u,getDoc:b}=await import("./CvDJqPe-.js").then(V=>V.aE);return{doc:u,getDoc:b}},__vite__mapDeps([0,1]),import.meta.url),a=[...new Set(t.filter(u=>u.rentedBy).map(u=>u.rentedBy))],r=[...new Set(t.filter(u=>u.requestedBy).map(u=>u.requestedBy))],v=[...new Set([...a,...r])];for(const u of v)if(!(ye.value[u]&&be.value[u]))try{const b=e(L,"users",u),V=await s(b);if(V.exists()){const k=V.data(),I=(k.email||"").split("@")[0]||"",C=k.name||"",w=`${k.workplace||""} ${C}(${I})`;ye.value[u]=w,be.value[u]=w}}catch(b){console.error("대여자/신청자 정보 로드 오류:",b)}},$e=t=>t.rentedBy&&ye.value[t.rentedBy]||"",Ce=t=>t.requestedBy&&be.value[t.requestedBy]||"",nt=()=>{},Ie=R(()=>{const t=new Map;for(const e of J.value){const s=e.isbn13||e.isbn||e.id;t.has(s)||t.set(s,{isbn:s,title:e.title,author:e.author,publisher:e.publisher,image:e.image,copies:[],totalCount:0,availableCount:0,rentedCount:0,requestedCount:0,locations:[]});const a=t.get(s);a.copies.push(e),a.totalCount++;const r=U(e);r?r==="rented"||r==="overdue"?a.rentedCount++:r==="requested"&&a.requestedCount++:a.availableCount++,e.location&&!a.locations.includes(e.location)&&a.locations.push(e.location)}for(const e of t.values())e.copies.sort((s,a)=>{const r=s.labelNumber||"",v=a.labelNumber||"";return r.localeCompare(v,"ko")});return Array.from(t.values())}),Y=R(()=>{let t=[...Ie.value];if(G.value.trim()){const e=G.value.toLowerCase();t=t.filter(s=>{const a=(s.title||"").toLowerCase(),r=(s.author||"").toLowerCase(),v=(s.publisher||"").toLowerCase();return a.includes(e)||r.includes(e)||v.includes(e)?!0:s.copies.some(u=>(u.labelNumber||"").toLowerCase().includes(e))})}return S.value==="label"?t.sort((e,s)=>{const a=ve(e.copies[0]?.labelNumber),r=ve(s.copies[0]?.labelNumber);return re.value==="asc"?a-r:r-a}):S.value==="rented"?t=t.filter(e=>e.rentedCount>0):S.value==="overdue"?t=t.filter(e=>e.copies.some(s=>U(s)==="overdue")):S.value==="requested"?t=t.filter(e=>e.requestedCount>0):S.value==="location"&&(oe.value&&(t=t.filter(e=>e.copies.some(s=>s.location===oe.value))),t.sort((e,s)=>{const a=ve(e.copies[0]?.labelNumber),r=ve(s.copies[0]?.labelNumber);return re.value==="asc"?a-r:r-a})),t}),rt=R(()=>Y.value.slice(0,ie.value)),it=R(()=>ie.value<Y.value.length),ut=R(()=>Y.value.length-ie.value),ct=()=>{ie.value+=Ge};Oe([()=>G.value,()=>S.value,()=>oe.value],()=>{ie.value=Ge});const dt=R(()=>J.value.length),vt=R(()=>Ie.value.length),mt=R(()=>J.value.filter(t=>U(t)==="rented").length),pt=R(()=>J.value.filter(t=>U(t)==="overdue").length),ft=R(()=>J.value.filter(t=>U(t)==="requested").length),ae=t=>U(t),Z=t=>y.value.some(e=>e.id===t.id),Le=t=>t.copies.every(e=>Z(e)),gt=t=>{const e=t.copies.filter(s=>Z(s)).length;return e>0&&e<t.copies.length},yt=(t,e)=>{e?Z(t)||y.value.push(t):y.value=y.value.filter(s=>s.id!==t.id),De()},bt=(t,e)=>{if(e)for(const s of t.copies)Z(s)||y.value.push(s);else{const s=t.copies.map(a=>a.id);y.value=y.value.filter(a=>!s.includes(a.id))}De()},_t=t=>{const e=Le(t);bt(t,!e)},ht=t=>{yt(t,!Z(t))},wt=t=>{t?y.value=Y.value.flatMap(e=>e.copies):y.value=[]},De=()=>{const t=Y.value.flatMap(e=>e.copies);me.value=t.length>0&&t.every(e=>Z(e))};Oe(()=>Y.value,()=>{De()});const kt=async()=>{try{ke.value=!0;const t=await Xe(D.value);we.value=t}catch(t){console.error("카테고리 로드 오류:",t),we.value=[]}finally{ke.value=!1}},Ct=t=>{const e=t.target.value.replace(/\D/g,"").slice(0,4);g.value.fourDigits=e,K.value=""},Dt=async()=>{if(!g.value.category||!g.value.fourDigits||g.value.fourDigits.length!==4)return;const t=xe(g.value.category,D.value,g.value.fourDigits);if($.value&&t===$.value.labelNumber){K.value="";return}try{await je(t,D.value)?K.value="이미 사용중인 라벨번호입니다.":K.value=""}catch(e){console.error("라벨번호 중복 체크 오류:",e)}},Bt=async t=>{$.value=t;const e=Wt(t.labelNumber);g.value={category:t.category||e?.category||"",fourDigits:e?.fourDigits||"",location:t.location||"구매칸"},K.value="",await kt(),ue.value=!0},Ae=()=>{ue.value=!1,$.value=null},xt=async()=>{if(!(!$.value||!Re.value))try{he.value=!0;const t=xe(g.value.category,D.value,g.value.fourDigits);await Qe($.value.labelNumber||$.value.id.split("_")[0],D.value,{category:g.value.category,labelNumber:t,location:g.value.location}),Ae(),await X(),await x("도서 정보가 수정되었습니다.",{type:"success"})}catch(t){console.error("도서 정보 수정 오류:",t),await x(t.message||"도서 정보 수정에 실패했습니다.",{type:"error"})}finally{he.value=!1}},Vt=async()=>{if(y.value.length===0)return;const t=[],e=[];for(const a of y.value){const r=U(a);r==="rented"||r==="overdue"?e.push({book:a,reason:"대여중"}):r==="requested"?e.push({book:a,reason:"대여신청중"}):t.push(a)}if(t.length===0){const a=e.map(r=>`• ${r.book.title} (${r.reason})`).join(`
`);await x(`선택한 도서를 삭제할 수 없습니다.

${a}

대여중/대여신청중인 도서는 반납 또는 신청 취소 후 삭제해주세요.`,{type:"warning"});return}let s=`선택한 ${y.value.length}권 중 ${t.length}권의 도서를 삭제하시겠습니까?`;if(e.length>0){const a=e.map(r=>`• ${r.book.title} (${r.reason})`).join(`
`);s+=`

⚠️ 다음 도서는 삭제할 수 없습니다:
${a}`}if(await de(s))try{O.value=!0;const a=t.map(r=>{const v=r.labelNumber||r.id.split("_")[0];return We(v,D.value)});await Promise.all(a),y.value=[],await X(),e.length>0?await x(`${t.length}권의 도서가 삭제되었습니다.
(${e.length}권은 대여중/대여신청중으로 삭제되지 않았습니다.)`,{type:"success"}):await x(`${t.length}권의 도서가 삭제되었습니다.`,{type:"success"})}catch(a){console.error("도서 삭제 오류:",a),await x("도서 삭제에 실패했습니다.",{type:"error"})}finally{O.value=!1}},Nt=async()=>{if(y.value.length===0)return;const t=y.value.filter(e=>{const s=U(e);return s!=="rented"&&s!=="overdue"});if(t.length===0){await x("선택한 도서가 모두 대여중입니다.",{type:"warning"});return}j.value=t,H.value=D.value,W.value="",M.value="",se.value=!0},qe=async t=>{if(!L||!t)return 0;try{const{collection:e,query:s,where:a,getDocs:r}=await le(async()=>{const{collection:k,query:c,where:I,getDocs:C}=await import("./CvDJqPe-.js").then(N=>N.aE);return{collection:k,query:c,where:I,getDocs:C}},__vite__mapDeps([0,1]),import.meta.url),v=e(L,"books"),u=s(v,a("rentedBy","==",t)),b=await r(u);let V=0;return b.forEach(k=>{const c=k.data();(c.status==="rented"||c.status==="overdue")&&V++}),V}catch(e){return console.error("대여 권수 조회 오류:",e),0}},Et=async t=>{if(U(t)==="requested"&&t.requestedBy){if(await qe(t.requestedBy)>=pe){await x(`신청자가 이미 ${pe}권을 대여중입니다.
반납 후 대여 처리해주세요.`,{type:"warning"});return}if(!await de(`신청자 정보로 대여 처리하시겠습니까?

도서: ${t.title}
라벨번호: ${t.labelNumber||"-"}
신청자: ${Ce(t)}`))return;try{O.value=!0;const a=t.labelNumber||t.id.split("_")[0];await Ne(a,D.value,t.requestedBy,t.isbn),await X(),await x("대여 처리가 완료되었습니다.",{type:"success"})}catch(a){console.error("대여 처리 오류:",a),await x(a.message||"대여 처리에 실패했습니다.",{type:"error"})}finally{O.value=!1}return}j.value=[t],H.value=D.value,W.value="",M.value="",se.value=!0},Se=()=>{se.value=!1,j.value=[],H.value="",W.value="",M.value=""},Rt=async()=>{if(!(!H.value||!W.value))try{_e.value=!0,M.value="";const{collection:t,query:e,where:s,getDocs:a}=await le(async()=>{const{collection:w,query:A,where:q,getDocs:T}=await import("./CvDJqPe-.js").then(F=>F.aE);return{collection:w,query:A,where:q,getDocs:T}},__vite__mapDeps([0,1]),import.meta.url),r=t(L,"users"),v=e(r,s("email","==",W.value)),u=await a(v);if(u.empty){M.value="해당 이메일의 사용자를 찾을 수 없습니다.";return}const b=u.docs[0].data();if(b.center!==H.value){M.value=`해당 사용자는 ${b.center} 소속입니다.`;return}const k=u.docs[0].id,c=await qe(k),I=j.value.length,C=pe-c;if(C<=0){M.value=`해당 사용자가 이미 ${pe}권을 대여중입니다.`;return}if(I>C){M.value=`해당 사용자는 ${C}권까지만 추가 대여 가능합니다. (현재 ${c}권 대여중)`;return}for(const w of j.value){const A=w.labelNumber||w.id.split("_")[0];await Ne(A,D.value,k,w.isbn)}const N=j.value.length;await X(),y.value=y.value.filter(w=>!j.value.some(A=>A.id===w.id)),Se(),await x(`${N}권의 도서가 대여 처리되었습니다.`,{type:"success"})}catch(t){console.error("도서 대여 오류:",t),M.value=t.message||"대여 처리에 실패했습니다."}finally{_e.value=!1}},$t=async()=>{if(y.value.length===0)return;const t=y.value.filter(e=>{const s=U(e);return s==="rented"||s==="overdue"});if(t.length===0){await x("선택한 도서 중 대여중인 도서가 없습니다.",{type:"warning"});return}if(await de(`선택한 ${t.length}권의 도서를 반납 처리하시겠습니까?`))try{O.value=!0;const{doc:e,updateDoc:s,collection:a,addDoc:r,query:v,where:u,getDocs:b,serverTimestamp:V,deleteField:k}=await le(async()=>{const{doc:c,updateDoc:I,collection:C,addDoc:N,query:w,where:A,getDocs:q,serverTimestamp:T,deleteField:F}=await import("./CvDJqPe-.js").then(z=>z.aE);return{doc:c,updateDoc:I,collection:C,addDoc:N,query:w,where:A,getDocs:q,serverTimestamp:T,deleteField:F}},__vite__mapDeps([0,1]),import.meta.url);for(const c of t){const I=c.labelNumber||c.id.split("_")[0],C=c.id,N=c.rentedBy,w=c.rentedAt,A=e(L,"books",C);if(await s(A,{status:"available",rentedBy:k(),rentedAt:k(),expectedReturnDate:k()}),N){const q=a(L,"rentalHistory"),T=c.isbn13||c.isbn||"",F=v(q,u("userId","==",N),u("isbn13","==",T)),z=await b(F);if(z.empty)await r(q,{bookId:C,labelNumber:I,isbn13:c.isbn13||"",isbn:c.isbn||"",title:c.title||"",author:c.author||"",publisher:c.publisher||"",cover:c.cover||c.image||"",center:c.center||"",userId:N,rentedAt:w,returnedAt:V(),rentCount:1});else{const l=z.docs[0],ee=l.data();await s(e(L,"rentalHistory",l.id),{rentedAt:w,returnedAt:V(),rentCount:(ee.rentCount||1)+1})}}}y.value=[],await X(),await x(`${t.length}권의 도서가 반납 처리되었습니다.`,{type:"success"})}catch(e){console.error("도서 반납 오류:",e),await x("도서 반납에 실패했습니다.",{type:"error"})}finally{O.value=!1}},It=async t=>{const e=U(t);if(e!=="rented"&&e!=="overdue"){await x("대여중인 도서가 아닙니다.",{type:"warning"});return}if(await de(`"${t.title}" 도서를 반납 처리하시겠습니까?
라벨번호: ${t.labelNumber||"-"}`))try{O.value=!0;const{doc:s,updateDoc:a,collection:r,addDoc:v,query:u,where:b,getDocs:V,serverTimestamp:k,deleteField:c}=await le(async()=>{const{doc:q,updateDoc:T,collection:F,addDoc:z,query:l,where:ee,getDocs:_,serverTimestamp:ce,deleteField:Lt}=await import("./CvDJqPe-.js").then(At=>At.aE);return{doc:q,updateDoc:T,collection:F,addDoc:z,query:l,where:ee,getDocs:_,serverTimestamp:ce,deleteField:Lt}},__vite__mapDeps([0,1]),import.meta.url),I=t.id,C=t.rentedBy,N=t.rentedAt,w=t.labelNumber||t.id.split("_")[0],A=s(L,"books",I);if(await a(A,{status:"available",rentedBy:c(),rentedAt:c(),expectedReturnDate:c()}),C){const q=r(L,"rentalHistory"),T=t.isbn13||t.isbn||"",F=u(q,b("userId","==",C),b("isbn13","==",T)),z=await V(F);if(z.empty)await v(q,{bookId:I,labelNumber:w,isbn13:t.isbn13||"",isbn:t.isbn||"",title:t.title||"",author:t.author||"",publisher:t.publisher||"",cover:t.cover||t.image||"",center:t.center||"",userId:C,rentedAt:N,returnedAt:k(),rentCount:1});else{const l=z.docs[0],ee=l.data();await a(s(L,"rentalHistory",l.id),{rentedAt:N,returnedAt:k(),rentCount:(ee.rentCount||1)+1})}}await X(),await x("도서가 반납 처리되었습니다.",{type:"success"})}catch(s){console.error("도서 반납 오류:",s),await x("도서 반납에 실패했습니다.",{type:"error"})}finally{O.value=!1}};return jt({title:"도서 관리 - CNX Library",meta:[{name:"description",content:"도서 검색 및 등록 관리"}]}),(t,e)=>{const s=E("v-select"),a=E("v-text-field"),r=E("v-checkbox"),v=E("v-btn"),u=E("v-progress-circular"),b=E("v-chip"),V=E("v-icon"),k=Pt,c=Mt,I=E("v-navigation-drawer"),C=E("v-spacer"),N=E("v-card"),w=E("v-dialog"),A=E("v-card-title"),q=E("v-autocomplete"),T=E("v-card-text"),F=E("v-card-actions"),z=E("v-app");return f(),Q(z,null,{default:p(()=>[i(k,{"header-type":"back-home","show-header-actions":!0,onToggleDrawer:e[6]||(e[6]=l=>ne.value=!o(ne))},{default:p(()=>[n("div",Xt,[n("div",Jt,[n("div",Kt,[n("h1",Yt,h(o(D))+" 도서 관리 ",1),i(s,{modelValue:o(D),"onUpdate:modelValue":[e[0]||(e[0]=l=>P(D)?D.value=l:null),at],items:fe,variant:"outlined",density:"comfortable","hide-details":"",class:"center-select"},null,8,["modelValue"])])]),n("div",Zt,[n("div",eo,[n("div",to,[n("div",oo,[e[15]||(e[15]=d(" 총 ",-1)),n("strong",null,h(o(dt)),1),d("권 ("+h(o(vt))+"종) ",1)]),n("div",so,[e[16]||(e[16]=d(" 대여중 ",-1)),n("strong",null,h(o(mt)),1),e[17]||(e[17]=d("권, 연체중 ",-1)),n("strong",null,h(o(pt)),1),e[18]||(e[18]=d("권, 대여신청 ",-1)),n("strong",null,h(o(ft)),1),e[19]||(e[19]=d("권 ",-1))])]),n("div",ao,[i(a,{modelValue:o(G),"onUpdate:modelValue":[e[1]||(e[1]=l=>P(G)?G.value=l:null),nt],label:"도서/라벨번호 검색","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"comfortable","hide-details":"",clearable:"",class:"registered-search-input"},null,8,["modelValue"]),i(s,{modelValue:o(S),"onUpdate:modelValue":e[2]||(e[2]=l=>P(S)?S.value=l:null),items:Ze,label:"정렬",variant:"outlined",density:"comfortable","hide-details":"",class:"sort-select"},null,8,["modelValue"])]),n("div",lo,[i(r,{modelValue:o(me),"onUpdate:modelValue":[e[3]||(e[3]=l=>P(me)?me.value=l:null),wt],label:"전체선택","hide-details":"",class:"select-all-checkbox"},null,8,["modelValue"]),n("div",no,[o(S)==="label"||o(S)==="location"?(f(),Q(s,{key:0,modelValue:o(re),"onUpdate:modelValue":e[4]||(e[4]=l=>P(re)?re.value=l:null),items:Ye,label:"정렬",variant:"outlined",density:"compact","hide-details":"",class:"sort-order-select"},null,8,["modelValue"])):te("",!0),o(S)==="location"?(f(),Q(s,{key:1,modelValue:o(oe),"onUpdate:modelValue":e[5]||(e[5]=l=>P(oe)?oe.value=l:null),items:o(tt),label:"위치",variant:"outlined",density:"compact","hide-details":"",class:"location-filter-select"},null,8,["modelValue","items"])):te("",!0),i(v,{class:"action-btn",variant:"flat",size:"small",disabled:o(y).length===0,loading:o(O),onClick:Vt},{default:p(()=>[...e[20]||(e[20]=[d(" 도서 삭제 ",-1)])]),_:1},8,["disabled","loading"]),i(v,{class:"action-btn",variant:"flat",size:"small",disabled:o(y).length===0,loading:o(O),onClick:Nt},{default:p(()=>[...e[21]||(e[21]=[d(" 대여 처리 ",-1)])]),_:1},8,["disabled","loading"]),i(v,{class:"action-btn",variant:"flat",size:"small",disabled:o(y).length===0,loading:o(O),onClick:$t},{default:p(()=>[...e[22]||(e[22]=[d(" 반납 처리 ",-1)])]),_:1},8,["disabled","loading"])])])]),o(ge)?(f(),B("div",ro,[i(u,{indeterminate:"",color:"primary"})])):o(Y).length>0?(f(),B("div",io,[n("div",uo,[(f(!0),B(Te,null,Fe(o(rt),(l,ee)=>(f(),B("div",{key:`group-${ee}`,class:ze(["book-card",{"book-card-selected":Le(l)||gt(l)}])},[n("div",{class:"book-card-header",onClick:_=>_t(l)},[l.image?(f(),B("img",{key:0,src:l.image,alt:l.title,class:"book-thumbnail"},null,8,vo)):(f(),B("div",mo,[...e[23]||(e[23]=[n("span",null,"NO IMAGE",-1)])])),n("div",po,[n("div",fo,h(l.title),1),l.author?(f(),B("div",go,[e[24]||(e[24]=n("strong",null,"저자:",-1)),d(" "+h(l.author),1)])):te("",!0),l.publisher?(f(),B("div",yo,[e[25]||(e[25]=n("strong",null,"출판사:",-1)),d(" "+h(l.publisher),1)])):te("",!0),n("div",bo," 등록 "+h(l.totalCount)+"권 ",1)])],8,co),n("div",_o,[(f(!0),B(Te,null,Fe(l.copies,_=>(f(),B("div",{key:_.id,class:ze(["book-copy-item",{selected:Z(_)}]),onClick:ce=>ht(_)},[n("div",wo,[n("div",ko,[n("div",Co,[ae(_)==="rented"?(f(),Q(b,{key:0,size:"x-small",color:"primary",variant:"flat"},{default:p(()=>[...e[26]||(e[26]=[d(" 대여중 ",-1)])]),_:1})):ae(_)==="overdue"?(f(),Q(b,{key:1,size:"x-small",color:"error",variant:"flat"},{default:p(()=>[...e[27]||(e[27]=[d(" 연체중 ",-1)])]),_:1})):ae(_)==="requested"?(f(),Q(b,{key:2,size:"x-small",color:"warning",variant:"flat"},{default:p(()=>[...e[28]||(e[28]=[d(" 대여신청 ",-1)])]),_:1})):(f(),Q(b,{key:3,size:"x-small",color:"success",variant:"outlined"},{default:p(()=>[...e[29]||(e[29]=[d(" 대여가능 ",-1)])]),_:1})),$e(_)||Ce(_)?(f(),B("span",Do,h($e(_)||Ce(_)),1)):te("",!0)]),n("a",{href:"#",class:"copy-edit-link",onClick:Be(ce=>Bt(_),["prevent","stop"])}," 정보수정 ",8,Bo)]),n("div",xo,[n("span",Vo,h(_.labelNumber||"라벨없음"),1),e[31]||(e[31]=n("span",{class:"copy-divider"},"|",-1)),n("span",No,[i(V,{size:"small",class:"mr-1"},{default:p(()=>[...e[30]||(e[30]=[d(" mdi-map-marker ",-1)])]),_:1}),d(" "+h(o(Me)(_.location)||"위치없음"),1)])]),n("div",Eo,[ae(_)==="rented"||ae(_)==="overdue"?(f(),Q(v,{key:0,color:"primary",size:"small",variant:"flat",onClick:Be(ce=>It(_),["stop"])},{default:p(()=>[...e[32]||(e[32]=[d(" 반납처리 ",-1)])]),_:1},8,["onClick"])):(f(),Q(v,{key:1,color:"primary",size:"small",variant:"flat",onClick:Be(ce=>Et(_),["stop"])},{default:p(()=>[d(h(ae(_)==="requested"?"대여승인":"대여처리"),1)]),_:2},1032,["onClick"]))])])],10,ho))),128))])],2))),128))]),o(it)?(f(),B("div",Ro,[i(v,{variant:"outlined",color:"primary",class:"load-more-btn",onClick:ct},{default:p(()=>[d(" 더보기 ("+h(o(ut))+"개 더) ",1)]),_:1})])):te("",!0)])):(f(),B("div",$o,[i(V,{size:"48",color:"grey-lighten-1",class:"mb-4"},{default:p(()=>[d(h(o(G)?"mdi-book-search-outline":"mdi-book-off-outline"),1)]),_:1}),o(G)?(f(),B("p",Io,[e[33]||(e[33]=d(" '",-1)),n("strong",null,h(o(G)),1),e[34]||(e[34]=d("'에 대한 검색 결과가 없습니다. ",-1))])):(f(),B("p",Lo," 등록된 도서가 없습니다. "))]))])])]),_:1}),i(I,{modelValue:o(ne),"onUpdate:modelValue":e[7]||(e[7]=l=>P(ne)?ne.value=l:null),location:"right",temporary:"",width:o(Ee),class:"side-navigation"},{default:p(()=>[n("div",Ao,[i(c)])]),_:1},8,["modelValue","width"]),i(w,{modelValue:o(se),"onUpdate:modelValue":e[10]||(e[10]=l=>P(se)?se.value=l:null),"max-width":"400",persistent:""},{default:p(()=>[i(N,{class:"rent-dialog-card"},{default:p(()=>[e[37]||(e[37]=n("div",{class:"rent-dialog-title text-h6"}," 대여자 정보 입력 ",-1)),n("div",qo,[n("div",So," 대여 처리할 도서: "+h(o(j).length)+"권 ",1),i(s,{modelValue:o(H),"onUpdate:modelValue":e[8]||(e[8]=l=>P(H)?H.value=l:null),items:fe,label:"센터",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),i(a,{modelValue:o(W),"onUpdate:modelValue":e[9]||(e[9]=l=>P(W)?W.value=l:null),label:"이메일",variant:"outlined",density:"comfortable",placeholder:"example@email.com","error-messages":o(M)},null,8,["modelValue","error-messages"])]),n("div",Uo,[i(C),i(v,{variant:"text",onClick:Se},{default:p(()=>[...e[35]||(e[35]=[d(" 취소 ",-1)])]),_:1}),i(v,{color:"primary",variant:"flat",loading:o(_e),disabled:!o(H)||!o(W),onClick:Rt},{default:p(()=>[...e[36]||(e[36]=[d(" 대여 처리 ",-1)])]),_:1},8,["loading","disabled"])])]),_:1})]),_:1},8,["modelValue"]),i(w,{modelValue:o(ue),"onUpdate:modelValue":e[14]||(e[14]=l=>P(ue)?ue.value=l:null),"max-width":"500",persistent:""},{default:p(()=>[i(N,{class:"edit-dialog-card"},{default:p(()=>[i(A,{class:"edit-dialog-title"},{default:p(()=>[...e[38]||(e[38]=[d(" 도서 정보 수정 ",-1)])]),_:1}),i(T,{class:"edit-dialog-content"},{default:p(()=>[o($)?(f(),B("div",Oo,[n("div",To,[o($).image?(f(),B("img",{key:0,src:o($).image,alt:o($).title,class:"book-thumbnail"},null,8,Fo)):(f(),B("div",zo,[...e[39]||(e[39]=[n("span",null,"No Image",-1)])])),n("div",Po,[n("div",Mo,h(o($).title),1),n("div",Go,h(o($).labelNumber||"라벨없음"),1),n("div",Ho,[i(V,{size:"small",class:"mr-1"},{default:p(()=>[...e[40]||(e[40]=[d(" mdi-map-marker ",-1)])]),_:1}),d(" "+h(o(Me)(o($).location)||"위치없음"),1)])])])])):te("",!0),i(q,{modelValue:o(g).category,"onUpdate:modelValue":e[11]||(e[11]=l=>o(g).category=l),items:o(we),label:"카테고리 *",variant:"outlined",density:"comfortable",loading:o(ke),class:"mb-3"},null,8,["modelValue","items","loading"]),n("div",Wo,[i(a,{"model-value":o(ot),label:"센터코드",variant:"outlined",density:"comfortable",readonly:"",disabled:"",class:"center-code-input"},null,8,["model-value"]),i(a,{modelValue:o(g).fourDigits,"onUpdate:modelValue":e[12]||(e[12]=l=>o(g).fourDigits=l),label:"4자리 번호 *",variant:"outlined",density:"comfortable",maxlength:"4","error-messages":o(K),hint:"0001~9999","persistent-hint":"",class:"four-digits-input",onInput:Ct,onBlur:Dt},null,8,["modelValue","error-messages"])]),i(s,{modelValue:o(g).location,"onUpdate:modelValue":e[13]||(e[13]=l=>o(g).location=l),items:o(et),label:"위치 *",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])]),_:1}),i(F,{class:"edit-dialog-actions"},{default:p(()=>[i(C),i(v,{variant:"text",onClick:Ae},{default:p(()=>[...e[41]||(e[41]=[d(" 취소 ",-1)])]),_:1}),i(v,{color:"primary",variant:"flat",loading:o(he),disabled:!o(Re),onClick:xt},{default:p(()=>[...e[42]||(e[42]=[d(" 저장 ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},os=qt(Qo,[["__scopeId","data-v-cb3adc0f"]]);export{os as default};
