import{f as G,a as le}from"./COoe0iU0.js";import{F as K,k as f,r as P,o as ie,e as re,g as w,O as C,H as a,L as l,K as d,I as u,M as s,G as i,T as b,P as n,W as p,J as c,Q as X,S as B,U as D}from"./BjECr21Y.js";const Y={1:{x:1.5,y:1,width:14,height:13},2:{x:16,y:1,width:14,height:13},3:{x:51,y:1,width:18,height:13},4:{x:69,y:1,width:15,height:27},5:{x:1.5,y:77,width:13,height:12},6:{x:15,y:77,width:14,height:12},7:{x:29,y:77,width:12,height:12},8:{x:41,y:77,width:14,height:12},9:{x:69,y:77,width:15,height:12},구매칸:{x:1.5,y:28,width:13,height:24},기부칸:{x:69,y:54,width:15,height:10}},J={10:{x:1,y:1,width:18,height:12},11:{x:19,y:1,width:18,height:12},12:{x:37,y:1,width:18,height:12},13:{x:55,y:1,width:18,height:12},14:{x:7,y:17,width:14,height:18},15:{x:7,y:38,width:14,height:16},16:{x:7,y:57,width:14,height:16}},T={},H={},de=(e,y)=>{if(!e||!y)return null;if(e==="용산센터"){if(Y[y])return{imagePath:"/images/shelves/yongsan-shelf-1.png",area:Y[y]};if(J[y])return{imagePath:"/images/shelves/yongsan-shelf-2.png",area:J[y]}}if(e==="강남센터"){if(T[y])return{imagePath:"/images/shelves/gangnam-shelf-1.png",area:T[y]};if(H[y])return{imagePath:"/images/shelves/gangnam-shelf-2.png",area:H[y]}}return null},Z=e=>e==="용산센터"?!0:e==="강남센터"?Object.keys(T).length>0||Object.keys(H).length>0:!1,ue={class:"location-guide-header"},ce={class:"location-guide-content"},me={key:0,class:"shelf-image-container"},fe=["src","alt"],be={key:1,class:"no-image-message"},ge={class:"location-info-text"},ye={key:2,class:"location-confirm-text"},ke={class:"location-guide-actions"},ve={__name:"LocationGuidePopup",props:{modelValue:{type:Boolean,default:!1},center:{type:String,required:!0},location:{type:String,required:!0},labelNumber:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:y}){const o=e,v=y,h=f({get:()=>o.modelValue,set:x=>v("update:modelValue",x)}),$=P(!1);ie(()=>{const x=()=>{$.value=window.innerWidth<600};x(),window.addEventListener("resize",x),re(()=>{window.removeEventListener("resize",x)})});const N=f(()=>Z(o.center)?de(o.center,o.location):null),I=f(()=>G(o.location)),L=()=>{h.value=!1};return(x,r)=>{const R=w("v-icon"),k=w("v-btn"),M=w("v-card"),V=w("v-dialog");return a(),C(V,{modelValue:n(h),"onUpdate:modelValue":r[0]||(r[0]=A=>X(h)?h.value=A:null),"max-width":"600",fullscreen:n($)},{default:l(()=>[d(M,{class:"location-guide-card"},{default:l(()=>[u("div",ue,[r[2]||(r[2]=u("div",{class:"location-guide-title"}," 도서 위치 안내 ",-1)),d(k,{icon:"",variant:"text",size:"small",onClick:L},{default:l(()=>[d(R,null,{default:l(()=>[...r[1]||(r[1]=[s("mdi-close",-1)])]),_:1})]),_:1})]),u("div",ce,[n(N)?(a(),i("div",me,[u("img",{src:n(N).imagePath,alt:`${e.center} 서가 이미지`,class:"shelf-image"},null,8,fe)])):(a(),i("div",be,[d(R,{size:"48",color:"grey-lighten-1",class:"mb-4"},{default:l(()=>[...r[3]||(r[3]=[s(" mdi-image-off-outline ",-1)])]),_:1}),r[4]||(r[4]=u("p",null,"위치 안내 이미지가 준비되지 않았습니다.",-1))])),u("div",ge,[d(R,{size:"small",class:"mr-1"},{default:l(()=>[...r[5]||(r[5]=[s(" mdi-map-marker ",-1)])]),_:1}),e.labelNumber?(a(),i(p,{key:0},[r[6]||(r[6]=s(' "',-1)),u("strong",null,c(e.labelNumber),1),r[7]||(r[7]=s('" 도서는 ',-1))],64)):b("",!0),u("strong",null,c(n(I)),1),r[8]||(r[8]=s("에 있습니다. ",-1))]),e.labelNumber?(a(),i("div",ye," 위치와 라벨번호를 확인 후 대여해주세요. ")):b("",!0)]),u("div",ke,[d(k,{color:"primary",variant:"flat",block:"",onClick:L},{default:l(()=>[...r[9]||(r[9]=[s(" 확인 ",-1)])]),_:1})])]),_:1})]),_:1},8,["modelValue","fullscreen"])}}},he=K(ve,[["__scopeId","data-v-0dde869b"]]),we={key:0,class:"book-card-header"},xe={class:"book-card-inner"},Re={class:"book-image-wrapper"},Se={class:"book-card-content"},Be={class:"book-title mb-2"},Ae={key:0,class:"book-info text-body-2 mb-1"},qe={key:1,class:"book-info book-info-publisher text-body-2"},ze={class:"location-text"},Ce={key:3,class:"book-quantity text-body-2"},Ne={key:4,class:"book-label-number text-body-2"},Ie={key:1,class:"book-action-area book-action-area-admin"},Le={class:"admin-info-text text-body-2"},De={key:2,class:"book-action-area"},$e={key:3,class:"book-action-area book-action-area-admin"},Me={class:"admin-info-text text-body-2"},Ve={key:4,class:"book-action-area book-action-area-mypage"},pe={key:5,class:"book-action-area"},Ee={key:0,class:"rented-text text-body-2"},Oe={key:1,class:"requested-status-text text-body-2"},Fe={key:0,class:"registered-text text-body-2"},Ge={class:"registered-text text-body-2"},Pe={key:2,class:"requested-text text-body-2"},Te={key:0,class:"admin-info-text text-body-2 requested-badge"},He={key:1,class:"admin-info-text text-body-2"},je={__name:"BookCard",props:{book:{type:Object,required:!0},center:{type:String,required:!0},registeredBooks:{type:Array,default:()=>[]},isRegistered:{type:Boolean,default:!1},showAction:{type:Boolean,default:!0},selectable:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},status:{type:String,default:null},showStatusFlags:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},actionButtonText:{type:String,default:""},registeredMessage:{type:String,default:""},requestedBooks:{type:Array,default:()=>[]},requestedMessage:{type:String,default:""},hideOverdueStatus:{type:Boolean,default:!1},showReturnDate:{type:Boolean,default:!1},returnDate:{type:[Date,Object,String],default:null},showRentButton:{type:Boolean,default:!1},renterInfo:{type:String,default:""},requesterInfo:{type:String,default:""},showAdminRentButton:{type:Boolean,default:!1},showAdminReturnButton:{type:Boolean,default:!1},allowRegisterRequested:{type:Boolean,default:!1},allowAdditionalRegister:{type:Boolean,default:!1},showLocation:{type:Boolean,default:!1},location:{type:String,default:""},locations:{type:Array,default:()=>[]},showQuantity:{type:Boolean,default:!1},availableCount:{type:Number,default:0},totalCount:{type:Number,default:0},showLabelNumber:{type:Boolean,default:!1},labelNumber:{type:String,default:""}},emits:["register","select","return","rent","adminRent","adminReturn","locationClick"],setup(e,{emit:y}){const o=e,v=y,h=P(!1),$=f(()=>o.book.cover||o.book.image||"/placeholder-book.png"),N=f(()=>o.location?G(o.location):o.locations&&o.locations.length>0?le(o.locations):o.book.location?G(o.book.location):""),I=f(()=>o.location?o.location:o.locations&&o.locations.length>0?o.locations[0]:o.book.location?o.book.location:""),L=f(()=>Z(o.center)),x=()=>{L.value&&I.value&&(h.value=!0,v("locationClick",{center:o.center,location:I.value}))},r=f(()=>{if(o.isRegistered)return!0;const m=o.book.isbn13||o.book.isbn||"";return m?o.registeredBooks.some(t=>{const S=t.isbn13||t.isbn||t.id||"",q=m.toString().trim(),g=S.toString().trim();return q===g&&t.center===o.center}):!1}),R=f(()=>{const m=o.book.isbn13||o.book.isbn||"";return m?o.requestedBooks.some(t=>{const S=t.isbn13||t.isbn||"",q=m.toString().trim(),g=S.toString().trim();return q===g&&t.center===o.center}):!1}),k=P(!1),M=async()=>{if(!k.value)try{k.value=!0,v("register",o.book)}finally{setTimeout(()=>{k.value=!1},1e3)}},V=f(()=>(o.location||o.book?.location)==="구매칸"),A=f(()=>o.status?o.status:null),E=f(()=>{const m=A.value;return o.hideOverdueStatus&&m==="overdue"?"대여중":{new:"NEW",rented:"대여중",overdue:"연체중",requested:"대여신청"}[m]||""}),_=f(()=>{const m=A.value;return o.hideOverdueStatus&&m==="overdue"?"info":{new:"primary",rented:"info",overdue:"error",requested:"warning"}[m]||"primary"}),O=f(()=>A.value==="rented"||A.value==="overdue"),F=f(()=>A.value==="requested"),ee=()=>{o.selectable&&!o.disabled&&v("select",o.book,!o.selected)},te=()=>{v("return",o.book)},oe=()=>{v("rent",o.book)},j=()=>{v("adminRent",o.book)},ne=()=>{v("adminReturn",o.book)},U=f(()=>{if(!o.returnDate)return"";const m=o.returnDate?.toDate?.()||new Date(o.returnDate),t=m.getFullYear(),S=String(m.getMonth()+1).padStart(2,"0"),q=String(m.getDate()).padStart(2,"0");return`${t}.${S}.${q}`}),W=f(()=>o.returnDate?(o.returnDate?.toDate?.()||new Date(o.returnDate))<new Date:!1);return(m,t)=>{const S=w("v-chip"),q=w("v-img"),g=w("v-icon"),z=w("v-btn"),se=w("v-card"),ae=he;return a(),i(p,null,[d(se,{class:D(["book-card",{"book-card-selected":e.selectable&&e.selected,"book-card-disabled":e.disabled}]),elevation:"0",onClick:t[0]||(t[0]=Q=>e.selectable?ee():null)},{default:l(()=>[e.showStatusFlags&&(n(E)||n(V))?(a(),i("div",we,[n(V)?(a(),C(S,{key:0,color:"primary",size:"x-small",variant:"flat",class:"status-chip"},{default:l(()=>[...t[2]||(t[2]=[s(" NEW ",-1)])]),_:1})):b("",!0),n(E)?(a(),C(S,{key:1,color:n(_),size:"x-small",variant:"flat",class:"status-chip"},{default:l(()=>[s(c(n(E)),1)]),_:1},8,["color"])):b("",!0)])):b("",!0),u("div",xe,[u("div",Re,[d(q,{src:n($),alt:e.book.title,height:"100%",cover:"",class:"book-image"},null,8,["src","alt"])]),u("div",Se,[u("div",Be,c(e.book.title),1),e.book.author?(a(),i("div",Ae,[t[3]||(t[3]=u("strong",null,"저자:",-1)),s(" "+c(e.book.author),1)])):b("",!0),e.book.publisher?(a(),i("div",qe,[t[4]||(t[4]=u("strong",null,"출판사:",-1)),s(" "+c(e.book.publisher),1)])):b("",!0),e.showLocation&&n(N)?(a(),i("div",{key:2,class:"book-location text-body-2",onClick:B(x,["stop"])},[d(g,{size:"small",class:"mr-1"},{default:l(()=>[...t[5]||(t[5]=[s(" mdi-map-marker ",-1)])]),_:1}),u("span",ze,c(n(N)),1),n(L)?(a(),C(g,{key:0,size:"small",class:"ml-1 location-info-icon"},{default:l(()=>[...t[6]||(t[6]=[s(" mdi-information-outline ",-1)])]),_:1})):b("",!0)])):b("",!0),e.showQuantity&&e.totalCount>0?(a(),i("div",Ce,[d(g,{size:"small",class:"mr-1"},{default:l(()=>[...t[7]||(t[7]=[s(" mdi-book-multiple ",-1)])]),_:1}),s(" 대여가능 "+c(e.availableCount)+"권 / 총 "+c(e.totalCount)+"권 ",1)])):b("",!0),e.showLabelNumber&&e.labelNumber?(a(),i("div",Ne,[d(g,{size:"small",class:"mr-1"},{default:l(()=>[...t[8]||(t[8]=[s(" mdi-label ",-1)])]),_:1}),s(" "+c(e.labelNumber),1)])):b("",!0)])]),e.showAdminRentButton&&n(F)&&e.requesterInfo?(a(),i("div",Ie,[u("div",Le,[d(g,{size:"small",class:"mr-1"},{default:l(()=>[...t[9]||(t[9]=[s(" mdi-account-clock ",-1)])]),_:1}),s(" "+c(e.requesterInfo),1)]),d(z,{color:"primary",size:"small",class:"admin-rent-btn mt-2",onClick:B(j,["stop"])},{default:l(()=>[...t[10]||(t[10]=[s(" 대여 처리 ",-1)])]),_:1})])):e.showAdminRentButton&&!n(O)&&!n(F)?(a(),i("div",De,[d(z,{color:"primary",size:"small",class:"admin-rent-btn",onClick:B(j,["stop"])},{default:l(()=>[...t[11]||(t[11]=[s(" 대여 처리 ",-1)])]),_:1})])):e.renterInfo&&n(O)?(a(),i("div",$e,[u("div",Me,[d(g,{size:"small",class:"mr-1"},{default:l(()=>[...t[12]||(t[12]=[s(" mdi-account ",-1)])]),_:1}),s(" "+c(e.renterInfo),1)]),e.returnDate?(a(),i("div",{key:0,class:D(["return-date-text text-body-2",{"return-date-overdue":n(W)}])},[d(g,{size:"small",class:"mr-1"},{default:l(()=>[...t[13]||(t[13]=[s(" mdi-calendar-clock ",-1)])]),_:1}),s(" 반납예정일: "+c(n(U)),1)],2)):b("",!0),e.showAdminReturnButton?(a(),C(z,{key:1,color:"primary",size:"small",class:"admin-return-btn mt-2",onClick:B(ne,["stop"])},{default:l(()=>[...t[14]||(t[14]=[s(" 반납 처리 ",-1)])]),_:1})):b("",!0)])):b("",!0),e.showReturnDate&&e.returnDate?(a(),i("div",Ve,[d(z,{color:"primary",size:"small",class:"return-btn",onClick:B(te,["stop"])},{default:l(()=>[...t[15]||(t[15]=[s(" 반납하기 ",-1)])]),_:1}),u("div",{class:D(["return-date-text text-body-2",{"return-date-overdue":n(W)}])},[d(g,{size:"small",class:"mr-1"},{default:l(()=>[...t[16]||(t[16]=[s(" mdi-calendar-clock ",-1)])]),_:1}),s(" 반납예정일: "+c(n(U)),1)],2)])):e.showRentButton?(a(),i("div",pe,[n(O)?(a(),i("div",Ee," 대여중인 도서입니다. ")):n(F)?(a(),i("div",Oe," 신청중인 도서입니다. ")):(a(),C(z,{key:2,color:"primary",size:"small",class:"rent-btn",onClick:B(oe,["stop"])},{default:l(()=>[...t[17]||(t[17]=[s(" 대여 신청 ",-1)])]),_:1}))])):e.showAction?(a(),i("div",{key:6,class:D(["book-action-area",{"book-action-area-admin":(e.requesterInfo||n(R)&&e.allowRegisterRequested)&&!n(r),"book-action-area-column":n(r)&&e.allowAdditionalRegister}])},[n(r)&&!e.allowAdditionalRegister?(a(),i("div",Fe,c(e.registeredMessage||`${e.center}에 등록된 도서입니다.`),1)):n(r)&&e.allowAdditionalRegister?(a(),i(p,{key:1},[u("div",Ge,c(e.registeredMessage||`${e.center}에 등록된 도서입니다.`),1),d(z,{color:"secondary",size:"small",variant:"outlined",loading:n(k),disabled:n(k),class:"register-btn",onClick:B(M,["stop"])},{default:l(()=>[...t[18]||(t[18]=[s(" 추가 등록 ",-1)])]),_:1},8,["loading","disabled"])],64)):n(R)&&!e.allowRegisterRequested?(a(),i("div",Pe,c(e.requestedMessage||`${e.center}에 이미 신청된 도서입니다.`),1)):(a(),i(p,{key:3},[n(R)&&e.allowRegisterRequested?(a(),i("div",Te,[d(g,{size:"small",class:"mr-1"},{default:l(()=>[...t[19]||(t[19]=[s(" mdi-book-clock ",-1)])]),_:1}),t[20]||(t[20]=s(" 신청된 도서 ",-1))])):e.requesterInfo?(a(),i("div",He,[d(g,{size:"small",class:"mr-1"},{default:l(()=>[...t[21]||(t[21]=[s(" mdi-account-clock ",-1)])]),_:1}),s(" "+c(e.requesterInfo),1)])):b("",!0),d(z,{color:"primary",size:"small",loading:n(k),disabled:n(k),class:D(["register-btn",{"mt-2":e.requesterInfo||n(R)&&e.allowRegisterRequested}]),onClick:B(M,["stop"])},{default:l(()=>[s(c(e.actionButtonText||`${e.center}에 등록하기`),1)]),_:1},8,["loading","disabled","class"])],64))],2)):b("",!0)]),_:1},8,["class"]),d(ae,{modelValue:n(h),"onUpdate:modelValue":t[1]||(t[1]=Q=>X(h)?h.value=Q:null),center:e.center,location:n(I),"label-number":e.labelNumber},null,8,["modelValue","center","location","label-number"])],64)}}},Qe=K(je,[["__scopeId","data-v-9a2eda76"]]);export{Qe as _,he as a,Z as h};
