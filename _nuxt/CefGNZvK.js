import{F as dt,$ as pt,N as ct,r as g,a0 as vt,k as Q,o as yt,G as n,K as b,I as t,W as h,M as c,a1 as S,a2 as A,T as q,Z as gt,X as w,J as u,a3 as mt,P as ft,O as G,L as f,g as P,H as a,U as J,V as W,a4 as _t}from"./CxY3VaYY.js";import{u as bt}from"./B0MzzaWX.js";import{u as ht}from"./CVZK6l8v.js";import"./DRbzCEke.js";const kt={class:"test-scenario-page"},wt={key:0,class:"text-center py-8"},Ct={class:"section"},Dt={class:"info-table"},St={class:"tester-input-row"},Nt=["disabled"],Vt={key:0,class:"testers-list"},xt=["onClick"],Tt={class:"progress-summary sticky"},Ut={class:"progress-header"},Lt={class:"progress-percent"},Rt={class:"progress-bar-large"},At={class:"progress-stats"},zt={class:"stat pass"},Bt={class:"stat fail"},Mt={class:"stat partial"},Et={class:"stat skip"},Ot={class:"stat total"},Pt={class:"test-table"},Xt={class:"col-id"},$t={class:"col-item"},Ft={class:"col-method"},Kt={class:"col-expected"},jt={class:"col-result"},Ht=["value","onChange"],Qt={class:"col-note"},qt=["value","onInput","onBlur"],Gt={class:"col-tester"},Jt=["value","disabled","onChange"],Wt=["value"],Zt={class:"section"},Yt={class:"approval-table"},It=["onUpdate:modelValue"],te=["onUpdate:modelValue"],ee=["onUpdate:modelValue"],se={class:"col-action"},le=["onClick"],oe={class:"page-actions"},ae={key:2,class:"error-state"},ne={__name:"[id]",setup(re){const Z=pt(),{confirm:X,alert:N}=ct(),{TEST_SCENARIOS:Y,getSession:$,saveTestResult:z,updateSessionStatus:F,updateSessionInfo:I}=bt(),m=Z.params.id,B=g(!0),o=g(null),d=g({}),k=g(!1),V=g({}),C=vt({testDate:""}),p=g([]),D=g(""),M=g({}),_=g([{role:"",name:"",date:""}]);ht({title:Q(()=>(o.value,"í…ŒìŠ¤íŠ¸ - CNX Library"))}),yt(async()=>{await tt()});const tt=async()=>{try{B.value=!0;const s=await $(m);o.value=s.session,d.value=s.results;const e=s.session.testDate?.toDate?.()||new Date(s.session.testDate);C.testDate=e.toISOString().split("T")[0],Array.isArray(s.session.testers)?p.value=s.session.testers:s.session.tester&&(p.value=[s.session.tester]),Object.keys(s.results).forEach(r=>{s.results[r].tester&&(M.value[r]=s.results[r].tester)}),s.session.approvers&&s.session.approvers.length>0&&(_.value=s.session.approvers),Object.keys(s.results).forEach(r=>{V.value[r]=s.results[r].note||""})}catch(s){console.error("ì„¸ì…˜ ë¡œë“œ ì˜¤ë¥˜:",s),o.value=null}finally{B.value=!1}},K=Q(()=>o.value?.progress?.total?Math.round(o.value.progress.completed/o.value.progress.total*100):0),x=s=>d.value[s]?.result||"",E=s=>V.value[s]??d.value[s]?.note??"",j=s=>{const e=x(s);return e?`result-${e}`:""},et=async(s,e)=>{try{await z(m,s,{result:e||"",note:E(s),tester:O(s)}),d.value[s]||(d.value[s]={}),d.value[s].result=e||"";const r=await $(m);o.value=r.session}catch(r){console.error("ê²°ê³¼ ì €ì¥ ì˜¤ë¥˜:",r),await N("ê²°ê³¼ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",{type:"error"})}},st=(s,e)=>{V.value[s]=e},lt=async s=>{try{const e=V.value[s]||"",r=d.value[s]?.note||"";e!==r&&(await z(m,s,{result:x(s),note:e,tester:O(s)}),d.value[s]||(d.value[s]={}),d.value[s].note=e)}catch(e){console.error("ë¹„ê³  ì €ì¥ ì˜¤ë¥˜:",e)}},O=s=>M.value[s]??d.value[s]?.tester??"",ot=async(s,e)=>{try{M.value[s]=e,await z(m,s,{result:x(s),note:E(s),tester:e||""}),d.value[s]||(d.value[s]={}),d.value[s].tester=e||""}catch(r){console.error("ë‹´ë‹¹ì ì €ì¥ ì˜¤ë¥˜:",r)}},H=()=>{const s=D.value.trim();s&&!p.value.includes(s)&&(p.value.push(s),D.value="",T())},at=s=>{p.value.splice(s,1),T()},T=async()=>{try{await I(m,{testDate:new Date(C.testDate),testers:p.value,approvers:_.value}),o.value&&(o.value.testDate=new Date(C.testDate),o.value.testers=p.value,o.value.approvers=_.value)}catch(s){console.error("ì„¸ì…˜ ì •ë³´ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:",s)}},nt=()=>{_.value.push({role:"",name:"",date:""})},rt=s=>{_.value.splice(s,1),U()},U=()=>{T()},it=async()=>{if(await X(`í…ŒìŠ¤íŠ¸ë¥¼ ì™„ë£Œ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?

ì™„ë£Œ í›„ì—ë„ ê²°ê³¼ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`,{type:"confirm"}))try{k.value=!0,await F(m,"completed"),o.value.status="completed",await N("í…ŒìŠ¤íŠ¸ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!",{type:"success"})}catch(e){console.error("ì™„ë£Œ ì²˜ë¦¬ ì˜¤ë¥˜:",e),await N("ì™„ë£Œ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",{type:"error"})}finally{k.value=!1}},ut=async()=>{if(await X("í…ŒìŠ¤íŠ¸ë¥¼ ë‹¤ì‹œ ì§„í–‰ ìƒíƒœë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))try{k.value=!0,await F(m,"in_progress"),o.value.status="in_progress"}catch(e){console.error("ìƒíƒœ ë³€ê²½ ì˜¤ë¥˜:",e),await N("ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",{type:"error"})}finally{k.value=!1}};return(s,e)=>{const r=P("v-progress-circular"),L=P("v-icon"),R=P("v-btn");return a(),n("div",kt,[B.value?(a(),n("div",wt,[b(r,{indeterminate:"",color:"primary",size:"48"}),e[2]||(e[2]=t("p",{class:"mt-4 text-medium-emphasis"}," í…ŒìŠ¤íŠ¸ ì„¸ì…˜ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘... ",-1))])):o.value?(a(),n(h,{key:1},[e[24]||(e[24]=t("div",{class:"page-header"},[t("h1",null,"CNX Library í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤"),t("p",{class:"subtitle"},"ì´ í˜ì´ì§€ëŠ” ê°œë°œì/QA ì „ìš© í˜ì´ì§€ì…ë‹ˆë‹¤.")],-1)),t("div",Ct,[e[6]||(e[6]=t("h2",null,"ğŸ“‹ í…ŒìŠ¤íŠ¸ ê°œìš”",-1)),e[7]||(e[7]=t("p",null,[c("ì´ ë¬¸ì„œëŠ” CNX Libraryì˜ ëª¨ë“  ê¸°ëŠ¥ì„ ê²€ì¦í•˜ê¸° ìœ„í•œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ì…ë‹ˆë‹¤."),t("br"),c("í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ í›„ ê° í•­ëª©ì˜ ê²°ê³¼ë¥¼ ê¸°ë¡í•˜ì—¬ ì‹œìŠ¤í…œì˜ ì •ìƒ ë™ì‘ì„ í™•ì¸í•©ë‹ˆë‹¤.")],-1)),e[8]||(e[8]=t("h3",null,"í…ŒìŠ¤íŠ¸ í™˜ê²½",-1)),t("table",Dt,[t("tbody",null,[e[5]||(e[5]=t("tr",null,[t("th",null,"í…ŒìŠ¤íŠ¸ URL"),t("td",null,"https://rarecat85.github.io/cnx-library")],-1)),t("tr",null,[e[3]||(e[3]=t("th",null,"í…ŒìŠ¤íŠ¸ ì¼ì",-1)),t("td",null,[S(t("input",{"onUpdate:modelValue":e[0]||(e[0]=i=>C.testDate=i),type:"date",class:"inline-input",onChange:T},null,544),[[A,C.testDate]])])]),t("tr",null,[e[4]||(e[4]=t("th",null,"í…ŒìŠ¤íŠ¸ ë‹´ë‹¹ì",-1)),t("td",null,[t("div",St,[S(t("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>D.value=i),type:"text",placeholder:"ë‹´ë‹¹ì ì´ë¦„ ì…ë ¥",class:"inline-input tester-input",onKeyup:gt(H,["enter"])},null,544),[[A,D.value]]),t("button",{type:"button",class:"add-tester-btn",disabled:!D.value.trim(),onClick:H}," ì¶”ê°€ ",8,Nt)]),p.value.length>0?(a(),n("div",Vt,[(a(!0),n(h,null,w(p.value,(i,y)=>(a(),n("span",{key:y,class:"tester-tag"},[c(u(i)+" ",1),t("button",{type:"button",class:"remove-tester-btn",onClick:l=>at(y)}," Ã— ",8,xt)]))),128))])):q("",!0)])])])]),e[9]||(e[9]=t("h3",null,"ê²°ê³¼ í‘œê¸°ë²•",-1)),e[10]||(e[10]=t("ul",{class:"legend-list"},[t("li",null,"âœ… í†µê³¼ (Pass)"),t("li",null,"âŒ ì‹¤íŒ¨ (Fail)"),t("li",null,"âš ï¸ ë¶€ë¶„ í†µê³¼ (Partial)"),t("li",null,"â­ï¸ ìŠ¤í‚µ (Skip)")],-1))]),t("div",Tt,[t("div",Ut,[e[11]||(e[11]=t("span",{class:"progress-title"},"ì§„í–‰ë¥ ",-1)),t("span",Lt,u(K.value)+"%",1)]),t("div",Rt,[t("div",{class:"progress-fill",style:mt({width:K.value+"%"})},null,4)]),t("div",At,[t("span",zt,"âœ… "+u(o.value.progress?.pass||0),1),t("span",Bt,"âŒ "+u(o.value.progress?.fail||0),1),t("span",Mt,"âš ï¸ "+u(o.value.progress?.partial||0),1),t("span",Et,"â­ï¸ "+u(o.value.progress?.skip||0),1),t("span",Ot,u(o.value.progress?.completed||0)+"/"+u(o.value.progress?.total||0),1)])]),(a(!0),n(h,null,w(ft(Y),i=>(a(),n("div",{key:i.section,class:"section test-section"},[t("h2",null,u(i.section),1),(a(!0),n(h,null,w(i.subsections,y=>(a(),n("div",{key:y.title,class:"subsection"},[t("h3",null,u(y.title),1),t("table",Pt,[e[14]||(e[14]=t("thead",null,[t("tr",null,[t("th",{class:"col-id"},"ë²ˆí˜¸"),t("th",{class:"col-item"},"í•­ëª©"),t("th",{class:"col-method"},"í…ŒìŠ¤íŠ¸ ë°©ë²•"),t("th",{class:"col-expected"},"ì˜ˆìƒ ê²°ê³¼"),t("th",{class:"col-result"},"ê²°ê³¼"),t("th",{class:"col-note"},"ë¹„ê³ "),t("th",{class:"col-tester"},"ë‹´ë‹¹ì")])],-1)),t("tbody",null,[(a(!0),n(h,null,w(y.items,l=>(a(),n("tr",{key:l.id,class:J(j(l.id))},[t("td",Xt,u(l.id),1),t("td",$t,u(l.name),1),t("td",Ft,u(l.method),1),t("td",Kt,u(l.expected),1),t("td",jt,[t("select",{value:x(l.id),class:J(["result-select",j(l.id)]),onChange:v=>et(l.id,v.target.value)},[...e[12]||(e[12]=[W('<option value="" data-v-5960b540>ì„ íƒ</option><option value="pass" data-v-5960b540>âœ… í†µê³¼</option><option value="fail" data-v-5960b540>âŒ ì‹¤íŒ¨</option><option value="partial" data-v-5960b540>âš ï¸ ë¶€ë¶„í†µê³¼</option><option value="skip" data-v-5960b540>â­ï¸ ìŠ¤í‚µ</option>',5)])],42,Ht)]),t("td",Qt,[t("input",{value:E(l.id),type:"text",placeholder:"ë¹„ê³  ì…ë ¥...",class:"note-input",onInput:v=>st(l.id,v.target.value),onBlur:v=>lt(l.id)},null,40,qt)]),t("td",Gt,[t("select",{value:O(l.id),class:"tester-select",disabled:p.value.length===0,onChange:v=>ot(l.id,v.target.value)},[e[13]||(e[13]=t("option",{value:""},"-",-1)),(a(!0),n(h,null,w(p.value,v=>(a(),n("option",{key:v,value:v},u(v),9,Wt))),128))],40,Jt)])],2))),128))])])]))),128))]))),128)),t("div",Zt,[e[17]||(e[17]=t("h2",null,"âœï¸ ìŠ¹ì¸",-1)),t("table",Yt,[e[16]||(e[16]=t("thead",null,[t("tr",null,[t("th",null,"ì—­í• "),t("th",null,"ì´ë¦„"),t("th",null,"ì¼ì"),t("th",{class:"col-action"})])],-1)),t("tbody",null,[(a(!0),n(h,null,w(_.value,(i,y)=>(a(),n("tr",{key:y},[t("td",null,[S(t("select",{"onUpdate:modelValue":l=>i.role=l,class:"approval-select",onChange:U},[...e[15]||(e[15]=[W('<option value="" data-v-5960b540>ì„ íƒ</option><option value="tester" data-v-5960b540>í…ŒìŠ¤í„°</option><option value="developer" data-v-5960b540>ê°œë°œì</option><option value="pm" data-v-5960b540>PM</option><option value="qa" data-v-5960b540>QA</option><option value="other" data-v-5960b540>ê¸°íƒ€</option>',6)])],40,It),[[_t,i.role]])]),t("td",null,[S(t("input",{"onUpdate:modelValue":l=>i.name=l,type:"text",placeholder:"ì´ë¦„",class:"approval-input",onBlur:U},null,40,te),[[A,i.name]])]),t("td",null,[S(t("input",{"onUpdate:modelValue":l=>i.date=l,type:"date",class:"approval-input",onChange:U},null,40,ee),[[A,i.date]])]),t("td",se,[_.value.length>1?(a(),n("button",{key:0,type:"button",class:"remove-btn",title:"ì‚­ì œ",onClick:l=>rt(y)}," âœ• ",8,le)):q("",!0)])]))),128))])]),t("button",{type:"button",class:"add-approver-btn",onClick:nt}," + ìŠ¹ì¸ì ì¶”ê°€ ")]),e[25]||(e[25]=t("div",{class:"section"},[t("h2",null,"ğŸ“Œ ì°¸ê³ ì‚¬í•­"),t("ol",{class:"note-list"},[t("li",null,"í…ŒìŠ¤íŠ¸ ì „ ìºì‹œ ë° ì¿ í‚¤ë¥¼ ì‚­ì œí•˜ê³  ì‹œì‘í•˜ì„¸ìš”."),t("li",null,"ê° í…ŒìŠ¤íŠ¸ëŠ” ë…ë¦½ì ìœ¼ë¡œ ìˆ˜í–‰ ê°€ëŠ¥í•´ì•¼ í•©ë‹ˆë‹¤."),t("li",null,"ì‹¤íŒ¨í•œ í…ŒìŠ¤íŠ¸ëŠ” ì¦‰ì‹œ ì´ìŠˆë¡œ ë“±ë¡í•˜ì„¸ìš”."),t("li",null,"ìŠ¤í¬ë¦°ìƒ·ì´ í•„ìš”í•œ ê²½ìš° ë³„ë„ í´ë”ì— ì €ì¥í•˜ì„¸ìš”.")])],-1)),t("div",oe,[b(R,{variant:"outlined",size:"large",to:"/test-scenario/sessions"},{default:f(()=>[b(L,{left:""},{default:f(()=>[...e[18]||(e[18]=[c(" mdi-arrow-left ",-1)])]),_:1}),e[19]||(e[19]=c(" ì„¸ì…˜ ëª©ë¡ ",-1))]),_:1}),o.value.status!=="completed"?(a(),G(R,{key:0,color:"success",variant:"flat",size:"large",loading:k.value,onClick:it},{default:f(()=>[b(L,{left:""},{default:f(()=>[...e[20]||(e[20]=[c(" mdi-check-circle ",-1)])]),_:1}),e[21]||(e[21]=c(" í…ŒìŠ¤íŠ¸ ì™„ë£Œ ",-1))]),_:1},8,["loading"])):(a(),G(R,{key:1,color:"warning",variant:"flat",size:"large",loading:k.value,onClick:ut},{default:f(()=>[b(L,{left:""},{default:f(()=>[...e[22]||(e[22]=[c(" mdi-pencil ",-1)])]),_:1}),e[23]||(e[23]=c(" ë‹¤ì‹œ ì§„í–‰í•˜ê¸° ",-1))]),_:1},8,["loading"]))]),e[26]||(e[26]=t("div",{class:"page-footer"},[t("p",null,"ğŸ”’ ì´ í˜ì´ì§€ëŠ” ìˆ¨ê²¨ì§„ í˜ì´ì§€ì…ë‹ˆë‹¤. URL ì§ì ‘ ì…ë ¥ìœ¼ë¡œë§Œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤.")],-1))],64)):(a(),n("div",ae,[b(L,{size:"64",color:"error"},{default:f(()=>[...e[27]||(e[27]=[c(" mdi-alert-circle-outline ",-1)])]),_:1}),e[29]||(e[29]=t("p",null,"í…ŒìŠ¤íŠ¸ ì„¸ì…˜ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",-1)),b(R,{to:"/test-scenario/sessions",variant:"outlined"},{default:f(()=>[...e[28]||(e[28]=[c(" ì„¸ì…˜ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸° ",-1)])]),_:1})]))])}}},ce=dt(ne,[["__scopeId","data-v-5960b540"]]);export{ce as default};
