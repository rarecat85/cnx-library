import{_ as J,a as K}from"./Bi71xubJ.js";import{F as O,u as Q,Z,r as o,o as j,O as P,L as a,g as i,H as u,K as l,I as n,G as V,P as s,M as d,J as b,R as W,S as Y,Q as F}from"./Bb-IZLVQ.js";import{u as ee}from"./DU0bEG_V.js";import{u as se}from"./D0YV89OB.js";const te={key:0,class:"text-center py-8"},oe={key:1,class:"text-center"},ne={class:"success-text mb-6"},le={key:2,class:"text-center"},ae={class:"error-text mb-6"},re={class:"logo-bottom text-center mt-6"},ie={class:"logo-with-credit"},ce={__name:"reset-password",setup(ue){const{confirmPasswordReset:S,loading:g,user:$}=ee(),R=Q(),N=Z(),p=o(""),k=o(""),r=o(!0),h=o(!1),m=o(!1),v=o(""),f=o(""),z=o(),y=o(!1),w=o(!1),_=o(!1),L=N.query.mode,x=N.query.oobCode,q=[t=>!!t||"비밀번호를 입력해주세요",t=>t&&t.length>=6||"비밀번호는 6자 이상이어야 합니다"],E=[t=>!!t||"비밀번호 확인을 입력해주세요",t=>t===p.value||"비밀번호가 일치하지 않습니다"];j(async()=>{if(_.value=!!$.value,!L||!x){m.value=!0,v.value="잘못된 재설정 링크입니다.",r.value=!1;return}if(L!=="resetPassword"){m.value=!0,v.value="지원하지 않는 재설정 모드입니다.",r.value=!1;return}r.value=!1});const H=async()=>{f.value="";const{valid:t}=await z.value.validate();if(t){if(!x){f.value="재설정 코드가 없습니다.";return}try{r.value=!0;const e=await S(x,p.value);e.success?(h.value=!0,r.value=!1):(m.value=!0,v.value=e.error||"비밀번호 재설정에 실패했습니다.",r.value=!1)}catch(e){m.value=!0,v.value=e.message||"비밀번호 재설정에 실패했습니다.",r.value=!1}}},I=()=>{_.value?R.push("/mypage"):R.push("/login")};return se({title:"비밀번호 재설정 - CNX Library",link:[{rel:"preconnect",href:"https://fonts.googleapis.com"},{rel:"preconnect",href:"https://fonts.gstatic.com",crossorigin:""},{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap"}]}),(t,e)=>{const T=i("v-progress-circular"),M=i("v-icon"),C=i("v-btn"),B=i("v-text-field"),U=i("v-alert"),X=i("v-form"),A=K,D=J,G=i("v-app");return u(),P(G,null,{default:a(()=>[l(D,null,{default:a(()=>[e[12]||(e[12]=n("div",{class:"text-center mb-8"},[n("h1",{class:"login-title mb-2"}," CNX Library "),n("p",{class:"login-subtitle"}," 비밀번호 재설정 ")],-1)),s(r)?(u(),V("div",te,[l(T,{indeterminate:"",color:"primary",size:"64",class:"mb-4"}),e[5]||(e[5]=n("p",{class:"processing-text"}," 비밀번호 재설정을 처리하는 중입니다... ",-1))])):s(h)?(u(),V("div",oe,[l(M,{color:"success",size:"64",class:"mb-4"},{default:a(()=>[...e[6]||(e[6]=[d(" mdi-check-circle ",-1)])]),_:1}),e[7]||(e[7]=n("h2",{class:"success-title mb-4"}," 비밀번호가 재설정되었습니다! ",-1)),n("p",ne,b(s(_)?"비밀번호가 성공적으로 변경되었습니다.":"새로운 비밀번호로 로그인해주세요."),1),l(C,{block:"",size:"large",class:"login-btn",elevation:"2",onClick:I},{default:a(()=>[d(b(s(_)?"마이페이지로 돌아가기":"로그인하기"),1)]),_:1})])):s(m)?(u(),V("div",le,[l(M,{color:"error",size:"64",class:"mb-4"},{default:a(()=>[...e[8]||(e[8]=[d(" mdi-alert-circle ",-1)])]),_:1}),e[9]||(e[9]=n("h2",{class:"error-title mb-4"}," 재설정에 실패했습니다 ",-1)),n("p",ae,b(s(v)),1),l(C,{block:"",size:"large",class:"login-btn",elevation:"2",onClick:I},{default:a(()=>[d(b(s(_)?"마이페이지로 돌아가기":"로그인 페이지로 이동"),1)]),_:1})])):(u(),P(X,{key:3,ref_key:"resetPasswordForm",ref:z,"validate-on":"submit",onSubmit:W(H,["prevent"])},{default:a(()=>[l(B,{modelValue:s(p),"onUpdate:modelValue":e[0]||(e[0]=c=>F(p)?p.value=c:null),label:"새 비밀번호",type:s(y)?"text":"password","prepend-inner-icon":"mdi-lock-outline","append-inner-icon":s(y)?"mdi-eye-off-outline":"mdi-eye-outline",variant:"outlined",rules:q,disabled:s(g),class:"mb-2",density:"comfortable","onClick:appendInner":e[1]||(e[1]=c=>y.value=!s(y))},null,8,["modelValue","type","append-inner-icon","disabled"]),l(B,{modelValue:s(k),"onUpdate:modelValue":e[2]||(e[2]=c=>F(k)?k.value=c:null),label:"비밀번호 확인",type:s(w)?"text":"password","prepend-inner-icon":"mdi-lock-check-outline","append-inner-icon":s(w)?"mdi-eye-off-outline":"mdi-eye-outline",variant:"outlined",rules:E,disabled:s(g),class:"mb-2",density:"comfortable","onClick:appendInner":e[3]||(e[3]=c=>w.value=!s(w))},null,8,["modelValue","type","append-inner-icon","disabled"]),s(f)?(u(),P(U,{key:0,type:"error",variant:"tonal",closable:"",class:"error-alert mb-4","onClick:close":e[4]||(e[4]=c=>f.value="")},{default:a(()=>[d(b(s(f)),1)]),_:1})):Y("",!0),l(C,{type:"submit",block:"",size:"large",loading:s(g),disabled:s(g),class:"reset-btn",elevation:"2"},{default:a(()=>[...e[10]||(e[10]=[d(" 비밀번호 재설정 ",-1)])]),_:1},8,["loading","disabled"])]),_:1},512)),n("div",re,[n("div",ie,[l(A),e[11]||(e[11]=n("span",{class:"credit-text"},"© rarecat",-1))])])]),_:1})]),_:1})}}},fe=O(ce,[["__scopeId","data-v-7fd423b4"]]);export{fe as default};
