const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BImGCPW2.js","./entry.DNw42TVG.css"])))=>i.map(i=>d[i]);
import{F as Lt,N as At,a as qt,D as St,r as m,k as R,o as Se,e as Ut,_ as ae,Y as Ue,O as X,L as p,g as E,H as g,K as i,P as o,I as n,J as h,Q as M,G as B,M as d,T as le,W as Te,X as Fe,U as Oe,S as Ce}from"./BImGCPW2.js";import{g as Tt,C as Ft,_ as Ot}from"./Czn0le7k.js";import{_ as zt}from"./6xVN34w9.js";import{u as Pt,g as ze,C as Mt,c as De,f as Pe,p as Gt}from"./DNQOMaSZ.js";import{u as Ht}from"./-1-5tyWX.js";import{u as Wt}from"./7guoiGVf.js";import"./BHASXqOZ.js";const Qt={class:"books-admin-page"},jt={class:"center-header mb-6"},Xt={class:"center-header-inner"},Jt={class:"page-title mb-0"},Kt={class:"registered-books-section"},Yt={class:"registered-books-header mb-0"},Zt={class:"d-flex align-center justify-space-between flex-wrap gap-4 mb-4"},eo={class:"text-body-1"},to={class:"text-body-2 text-medium-emphasis"},oo={class:"d-flex align-center registered-search-group"},so={class:"d-flex align-center justify-space-between flex-wrap gap-4 mt-4"},ao={class:"d-flex action-buttons"},lo={key:0,class:"text-center py-8"},no={key:1,class:"registered-books-section"},ro={class:"registered-books-grid"},io=["onClick"],uo=["src","alt"],co={key:1,class:"book-thumbnail-placeholder"},vo={class:"book-meta"},mo={class:"book-title"},po={key:0,class:"book-author"},fo={key:1,class:"book-publisher"},go={class:"book-count"},yo={class:"book-copies-list"},bo=["onClick"],_o={class:"copy-content"},ho={class:"copy-row-top"},wo={class:"copy-status"},ko={key:4,class:"copy-user-info"},Co=["onClick"],Do={class:"copy-info-row"},Bo={class:"copy-label-number"},xo={class:"copy-location"},Vo={class:"copy-actions"},No={key:0,class:"load-more-section"},Eo={key:2,class:"text-center py-8 text-medium-emphasis empty-state"},Ro={key:0},$o={key:1},Io={class:"drawer-content"},Lo={class:"rent-dialog-content"},Ao={class:"mb-4 text-body-2 text-medium-emphasis"},qo={class:"rent-dialog-actions"},So={key:0,class:"book-info-preview mb-4"},Uo={class:"book-info-preview-inner"},To=["src","alt"],Fo={key:1,class:"book-thumbnail-placeholder"},Oo={class:"book-meta"},zo={class:"book-title"},Po={class:"book-current-label"},Mo={class:"book-current-location"},Go={class:"label-number-inputs mb-3"},Me=10,ve=5,Ho={__name:"index",setup(Wo){const{user:Be}=Ht(),{getBooksByCenter:Ge,rentBook:xe,deleteBook:He,updateBookInfo:We,checkLabelNumberExists:Qe,getCategories:je,calculateBookStatus:S}=Pt(),{confirm:ce,alert:x}=At(),{$firebaseFirestore:Xe}=qt(),L=Xe,ne=St("navigationDrawer",()=>!1),Ve=m(280),me=[...Ft],D=m(""),Je=m(""),J=m([]),pe=m(!1),G=m(""),z=m("label"),te=m(""),Ke=[{title:"라벨번호순",value:"label"},{title:"대여중도서",value:"rented"},{title:"연체중도서",value:"overdue"},{title:"대여신청도서",value:"requested"},{title:"위치별로 보기",value:"location"}],Ne=t=>{if(!t)return 9999;const e=t.split("_");if(e.length<2)return 9999;const s=e[1];return parseInt(s.slice(-4))||9999},y=m([]),de=m(!1),U=m(!1),re=m(10),fe=m({}),ge=m({}),oe=m(!1),Q=m([]),ye=m(!1),H=m(""),W=m(""),P=m(""),ie=m(!1),$=m(null),be=m(!1),_e=m([]),he=m(!1),K=m(""),f=m({category:"",fourDigits:"",location:""}),Ye=R(()=>ze()),Ze=R(()=>[{title:"전체",value:""},...ze()]),et=R(()=>Mt[D.value]||"1");R(()=>!f.value.category||!f.value.fourDigits?"":De(f.value.category,D.value,f.value.fourDigits));const Ee=R(()=>f.value.category&&f.value.fourDigits&&f.value.fourDigits.length===4&&/^\d{4}$/.test(f.value.fourDigits)&&f.value.location&&!K.value);Se(()=>{const t=()=>{Ve.value=window.innerWidth>=769?360:280};t(),window.addEventListener("resize",t),Ut(()=>{window.removeEventListener("resize",t)})});const tt=async()=>{if(!Be.value||!L)return"";try{const{doc:t,getDoc:e}=await ae(async()=>{const{doc:r,getDoc:v}=await import("./BImGCPW2.js").then(u=>u.aE);return{doc:r,getDoc:v}},__vite__mapDeps([0,1]),import.meta.url),s=t(L,"users",Be.value.uid),a=await e(s);if(a.exists())return a.data().workplace||""}catch(t){console.error("사용자 근무지 정보 가져오기 오류:",t)}return""};Se(async()=>{const t=await tt();Je.value=t,D.value=t?Tt(t):me[0],await j()});const ot=async()=>{y.value=[],await j()},j=async()=>{try{pe.value=!0;const t=await Ge(D.value);J.value=t,await st(t)}catch(t){console.error("등록된 도서 로드 오류:",t),J.value=[]}finally{pe.value=!1}},st=async t=>{if(!L)return;const{doc:e,getDoc:s}=await ae(async()=>{const{doc:u,getDoc:b}=await import("./BImGCPW2.js").then(V=>V.aE);return{doc:u,getDoc:b}},__vite__mapDeps([0,1]),import.meta.url),a=[...new Set(t.filter(u=>u.rentedBy).map(u=>u.rentedBy))],r=[...new Set(t.filter(u=>u.requestedBy).map(u=>u.requestedBy))],v=[...new Set([...a,...r])];for(const u of v)if(!(fe.value[u]&&ge.value[u]))try{const b=e(L,"users",u),V=await s(b);if(V.exists()){const k=V.data(),I=(k.email||"").split("@")[0]||"",C=k.name||"",w=`${k.workplace||""} ${C}(${I})`;fe.value[u]=w,ge.value[u]=w}}catch(b){console.error("대여자/신청자 정보 로드 오류:",b)}},Re=t=>t.rentedBy&&fe.value[t.rentedBy]||"",we=t=>t.requestedBy&&ge.value[t.requestedBy]||"",at=()=>{},$e=R(()=>{const t=new Map;for(const e of J.value){const s=e.isbn13||e.isbn||e.id;t.has(s)||t.set(s,{isbn:s,title:e.title,author:e.author,publisher:e.publisher,image:e.image,copies:[],totalCount:0,availableCount:0,rentedCount:0,requestedCount:0,locations:[]});const a=t.get(s);a.copies.push(e),a.totalCount++;const r=S(e);r?r==="rented"||r==="overdue"?a.rentedCount++:r==="requested"&&a.requestedCount++:a.availableCount++,e.location&&!a.locations.includes(e.location)&&a.locations.push(e.location)}for(const e of t.values())e.copies.sort((s,a)=>{const r=s.labelNumber||"",v=a.labelNumber||"";return r.localeCompare(v,"ko")});return Array.from(t.values())}),Y=R(()=>{let t=[...$e.value];if(G.value.trim()){const e=G.value.toLowerCase();t=t.filter(s=>{const a=(s.title||"").toLowerCase(),r=(s.author||"").toLowerCase(),v=(s.publisher||"").toLowerCase();return a.includes(e)||r.includes(e)||v.includes(e)?!0:s.copies.some(u=>(u.labelNumber||"").toLowerCase().includes(e))})}return z.value==="label"?t.sort((e,s)=>{const a=Ne(e.copies[0]?.labelNumber),r=Ne(s.copies[0]?.labelNumber);return a-r}):z.value==="rented"?t=t.filter(e=>e.rentedCount>0):z.value==="overdue"?t=t.filter(e=>e.copies.some(s=>S(s)==="overdue")):z.value==="requested"?t=t.filter(e=>e.requestedCount>0):z.value==="location"&&te.value&&(t=t.filter(e=>e.copies.some(s=>s.location===te.value))),t}),lt=R(()=>Y.value.slice(0,re.value)),nt=R(()=>re.value<Y.value.length),rt=R(()=>Y.value.length-re.value),it=()=>{re.value+=Me};Ue([()=>G.value,()=>z.value,()=>te.value],()=>{re.value=Me});const ut=R(()=>J.value.length),ct=R(()=>$e.value.length),dt=R(()=>J.value.filter(t=>S(t)==="rented").length),vt=R(()=>J.value.filter(t=>S(t)==="overdue").length),mt=R(()=>J.value.filter(t=>S(t)==="requested").length),se=t=>S(t),Z=t=>y.value.some(e=>e.id===t.id),Ie=t=>t.copies.every(e=>Z(e)),pt=t=>{const e=t.copies.filter(s=>Z(s)).length;return e>0&&e<t.copies.length},ft=(t,e)=>{e?Z(t)||y.value.push(t):y.value=y.value.filter(s=>s.id!==t.id),ke()},gt=(t,e)=>{if(e)for(const s of t.copies)Z(s)||y.value.push(s);else{const s=t.copies.map(a=>a.id);y.value=y.value.filter(a=>!s.includes(a.id))}ke()},yt=t=>{const e=Ie(t);gt(t,!e)},bt=t=>{ft(t,!Z(t))},_t=t=>{t?y.value=Y.value.flatMap(e=>e.copies):y.value=[]},ke=()=>{const t=Y.value.flatMap(e=>e.copies);de.value=t.length>0&&t.every(e=>Z(e))};Ue(()=>Y.value,()=>{ke()});const ht=async()=>{try{he.value=!0;const t=await je(D.value);_e.value=t}catch(t){console.error("카테고리 로드 오류:",t),_e.value=[]}finally{he.value=!1}},wt=t=>{const e=t.target.value.replace(/\D/g,"").slice(0,4);f.value.fourDigits=e,K.value=""},kt=async()=>{if(!f.value.category||!f.value.fourDigits||f.value.fourDigits.length!==4)return;const t=De(f.value.category,D.value,f.value.fourDigits);if($.value&&t===$.value.labelNumber){K.value="";return}try{await Qe(t,D.value)?K.value="이미 사용중인 라벨번호입니다.":K.value=""}catch(e){console.error("라벨번호 중복 체크 오류:",e)}},Ct=async t=>{$.value=t;const e=Gt(t.labelNumber);f.value={category:t.category||e?.category||"",fourDigits:e?.fourDigits||"",location:t.location||"구매칸"},K.value="",await ht(),ie.value=!0},Le=()=>{ie.value=!1,$.value=null},Dt=async()=>{if(!(!$.value||!Ee.value))try{be.value=!0;const t=De(f.value.category,D.value,f.value.fourDigits);await We($.value.labelNumber||$.value.id.split("_")[0],D.value,{category:f.value.category,labelNumber:t,location:f.value.location}),Le(),await j(),await x("도서 정보가 수정되었습니다.",{type:"success"})}catch(t){console.error("도서 정보 수정 오류:",t),await x(t.message||"도서 정보 수정에 실패했습니다.",{type:"error"})}finally{be.value=!1}},Bt=async()=>{if(y.value.length===0)return;const t=[],e=[];for(const a of y.value){const r=S(a);r==="rented"||r==="overdue"?e.push({book:a,reason:"대여중"}):r==="requested"?e.push({book:a,reason:"대여신청중"}):t.push(a)}if(t.length===0){const a=e.map(r=>`• ${r.book.title} (${r.reason})`).join(`
`);await x(`선택한 도서를 삭제할 수 없습니다.

${a}

대여중/대여신청중인 도서는 반납 또는 신청 취소 후 삭제해주세요.`,{type:"warning"});return}let s=`선택한 ${y.value.length}권 중 ${t.length}권의 도서를 삭제하시겠습니까?`;if(e.length>0){const a=e.map(r=>`• ${r.book.title} (${r.reason})`).join(`
`);s+=`

⚠️ 다음 도서는 삭제할 수 없습니다:
${a}`}if(await ce(s))try{U.value=!0;const a=t.map(r=>{const v=r.labelNumber||r.id.split("_")[0];return He(v,D.value)});await Promise.all(a),y.value=[],await j(),e.length>0?await x(`${t.length}권의 도서가 삭제되었습니다.
(${e.length}권은 대여중/대여신청중으로 삭제되지 않았습니다.)`,{type:"success"}):await x(`${t.length}권의 도서가 삭제되었습니다.`,{type:"success"})}catch(a){console.error("도서 삭제 오류:",a),await x("도서 삭제에 실패했습니다.",{type:"error"})}finally{U.value=!1}},xt=async()=>{if(y.value.length===0)return;const t=y.value.filter(e=>{const s=S(e);return s!=="rented"&&s!=="overdue"});if(t.length===0){await x("선택한 도서가 모두 대여중입니다.",{type:"warning"});return}Q.value=t,H.value=D.value,W.value="",P.value="",oe.value=!0},Ae=async t=>{if(!L||!t)return 0;try{const{collection:e,query:s,where:a,getDocs:r}=await ae(async()=>{const{collection:k,query:c,where:I,getDocs:C}=await import("./BImGCPW2.js").then(N=>N.aE);return{collection:k,query:c,where:I,getDocs:C}},__vite__mapDeps([0,1]),import.meta.url),v=e(L,"books"),u=s(v,a("rentedBy","==",t)),b=await r(u);let V=0;return b.forEach(k=>{const c=k.data();(c.status==="rented"||c.status==="overdue")&&V++}),V}catch(e){return console.error("대여 권수 조회 오류:",e),0}},Vt=async t=>{if(S(t)==="requested"&&t.requestedBy){if(await Ae(t.requestedBy)>=ve){await x(`신청자가 이미 ${ve}권을 대여중입니다.
반납 후 대여 처리해주세요.`,{type:"warning"});return}if(!await ce(`신청자 정보로 대여 처리하시겠습니까?

도서: ${t.title}
라벨번호: ${t.labelNumber||"-"}
신청자: ${we(t)}`))return;try{U.value=!0;const a=t.labelNumber||t.id.split("_")[0];await xe(a,D.value,t.requestedBy,t.isbn),await j(),await x("대여 처리가 완료되었습니다.",{type:"success"})}catch(a){console.error("대여 처리 오류:",a),await x(a.message||"대여 처리에 실패했습니다.",{type:"error"})}finally{U.value=!1}return}Q.value=[t],H.value=D.value,W.value="",P.value="",oe.value=!0},qe=()=>{oe.value=!1,Q.value=[],H.value="",W.value="",P.value=""},Nt=async()=>{if(!(!H.value||!W.value))try{ye.value=!0,P.value="";const{collection:t,query:e,where:s,getDocs:a}=await ae(async()=>{const{collection:w,query:A,where:q,getDocs:T}=await import("./BImGCPW2.js").then(F=>F.aE);return{collection:w,query:A,where:q,getDocs:T}},__vite__mapDeps([0,1]),import.meta.url),r=t(L,"users"),v=e(r,s("email","==",W.value)),u=await a(v);if(u.empty){P.value="해당 이메일의 사용자를 찾을 수 없습니다.";return}const b=u.docs[0].data();if(b.center!==H.value){P.value=`해당 사용자는 ${b.center} 소속입니다.`;return}const k=u.docs[0].id,c=await Ae(k),I=Q.value.length,C=ve-c;if(C<=0){P.value=`해당 사용자가 이미 ${ve}권을 대여중입니다.`;return}if(I>C){P.value=`해당 사용자는 ${C}권까지만 추가 대여 가능합니다. (현재 ${c}권 대여중)`;return}for(const w of Q.value){const A=w.labelNumber||w.id.split("_")[0];await xe(A,D.value,k,w.isbn)}const N=Q.value.length;await j(),y.value=y.value.filter(w=>!Q.value.some(A=>A.id===w.id)),qe(),await x(`${N}권의 도서가 대여 처리되었습니다.`,{type:"success"})}catch(t){console.error("도서 대여 오류:",t),P.value=t.message||"대여 처리에 실패했습니다."}finally{ye.value=!1}},Et=async()=>{if(y.value.length===0)return;const t=y.value.filter(e=>{const s=S(e);return s==="rented"||s==="overdue"});if(t.length===0){await x("선택한 도서 중 대여중인 도서가 없습니다.",{type:"warning"});return}if(await ce(`선택한 ${t.length}권의 도서를 반납 처리하시겠습니까?`))try{U.value=!0;const{doc:e,updateDoc:s,collection:a,addDoc:r,query:v,where:u,getDocs:b,serverTimestamp:V,deleteField:k}=await ae(async()=>{const{doc:c,updateDoc:I,collection:C,addDoc:N,query:w,where:A,getDocs:q,serverTimestamp:T,deleteField:F}=await import("./BImGCPW2.js").then(O=>O.aE);return{doc:c,updateDoc:I,collection:C,addDoc:N,query:w,where:A,getDocs:q,serverTimestamp:T,deleteField:F}},__vite__mapDeps([0,1]),import.meta.url);for(const c of t){const I=c.labelNumber||c.id.split("_")[0],C=c.id,N=c.rentedBy,w=c.rentedAt,A=e(L,"books",C);if(await s(A,{status:"available",rentedBy:k(),rentedAt:k(),expectedReturnDate:k()}),N){const q=a(L,"rentalHistory"),T=c.isbn13||c.isbn||"",F=v(q,u("userId","==",N),u("isbn13","==",T)),O=await b(F);if(O.empty)await r(q,{bookId:C,labelNumber:I,isbn13:c.isbn13||"",isbn:c.isbn||"",title:c.title||"",author:c.author||"",publisher:c.publisher||"",cover:c.cover||c.image||"",center:c.center||"",userId:N,rentedAt:w,returnedAt:V(),rentCount:1});else{const l=O.docs[0],ee=l.data();await s(e(L,"rentalHistory",l.id),{rentedAt:w,returnedAt:V(),rentCount:(ee.rentCount||1)+1})}}}y.value=[],await j(),await x(`${t.length}권의 도서가 반납 처리되었습니다.`,{type:"success"})}catch(e){console.error("도서 반납 오류:",e),await x("도서 반납에 실패했습니다.",{type:"error"})}finally{U.value=!1}},Rt=async t=>{const e=S(t);if(e!=="rented"&&e!=="overdue"){await x("대여중인 도서가 아닙니다.",{type:"warning"});return}if(await ce(`"${t.title}" 도서를 반납 처리하시겠습니까?
라벨번호: ${t.labelNumber||"-"}`))try{U.value=!0;const{doc:s,updateDoc:a,collection:r,addDoc:v,query:u,where:b,getDocs:V,serverTimestamp:k,deleteField:c}=await ae(async()=>{const{doc:q,updateDoc:T,collection:F,addDoc:O,query:l,where:ee,getDocs:_,serverTimestamp:ue,deleteField:$t}=await import("./BImGCPW2.js").then(It=>It.aE);return{doc:q,updateDoc:T,collection:F,addDoc:O,query:l,where:ee,getDocs:_,serverTimestamp:ue,deleteField:$t}},__vite__mapDeps([0,1]),import.meta.url),I=t.id,C=t.rentedBy,N=t.rentedAt,w=t.labelNumber||t.id.split("_")[0],A=s(L,"books",I);if(await a(A,{status:"available",rentedBy:c(),rentedAt:c(),expectedReturnDate:c()}),C){const q=r(L,"rentalHistory"),T=t.isbn13||t.isbn||"",F=u(q,b("userId","==",C),b("isbn13","==",T)),O=await V(F);if(O.empty)await v(q,{bookId:I,labelNumber:w,isbn13:t.isbn13||"",isbn:t.isbn||"",title:t.title||"",author:t.author||"",publisher:t.publisher||"",cover:t.cover||t.image||"",center:t.center||"",userId:C,rentedAt:N,returnedAt:k(),rentCount:1});else{const l=O.docs[0],ee=l.data();await a(s(L,"rentalHistory",l.id),{rentedAt:N,returnedAt:k(),rentCount:(ee.rentCount||1)+1})}}await j(),await x("도서가 반납 처리되었습니다.",{type:"success"})}catch(s){console.error("도서 반납 오류:",s),await x("도서 반납에 실패했습니다.",{type:"error"})}finally{U.value=!1}};return Wt({title:"도서 관리 - CNX Library",meta:[{name:"description",content:"도서 검색 및 등록 관리"}]}),(t,e)=>{const s=E("v-select"),a=E("v-text-field"),r=E("v-checkbox"),v=E("v-btn"),u=E("v-progress-circular"),b=E("v-chip"),V=E("v-icon"),k=Ot,c=zt,I=E("v-navigation-drawer"),C=E("v-spacer"),N=E("v-card"),w=E("v-dialog"),A=E("v-card-title"),q=E("v-autocomplete"),T=E("v-card-text"),F=E("v-card-actions"),O=E("v-app");return g(),X(O,null,{default:p(()=>[i(k,{"header-type":"back-home","show-header-actions":!0,onToggleDrawer:e[5]||(e[5]=l=>ne.value=!o(ne))},{default:p(()=>[n("div",Qt,[n("div",jt,[n("div",Xt,[n("h1",Jt,h(o(D))+" 도서 관리 ",1),i(s,{modelValue:o(D),"onUpdate:modelValue":[e[0]||(e[0]=l=>M(D)?D.value=l:null),ot],items:me,variant:"outlined",density:"comfortable","hide-details":"",class:"center-select"},null,8,["modelValue"])])]),n("div",Kt,[n("div",Yt,[n("div",Zt,[n("div",eo,[e[14]||(e[14]=d(" 총 ",-1)),n("strong",null,h(o(ut)),1),d("권 ("+h(o(ct))+"종) ",1)]),n("div",to,[e[15]||(e[15]=d(" 대여중 ",-1)),n("strong",null,h(o(dt)),1),e[16]||(e[16]=d("권, 연체중 ",-1)),n("strong",null,h(o(vt)),1),e[17]||(e[17]=d("권, 대여신청 ",-1)),n("strong",null,h(o(mt)),1),e[18]||(e[18]=d("권 ",-1))])]),n("div",oo,[i(a,{modelValue:o(G),"onUpdate:modelValue":[e[1]||(e[1]=l=>M(G)?G.value=l:null),at],label:"도서/라벨번호 검색","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"comfortable","hide-details":"",clearable:"",class:"registered-search-input"},null,8,["modelValue"]),i(s,{modelValue:o(z),"onUpdate:modelValue":e[2]||(e[2]=l=>M(z)?z.value=l:null),items:Ke,label:"정렬",variant:"outlined",density:"comfortable","hide-details":"",class:"sort-select"},null,8,["modelValue"])]),n("div",so,[i(r,{modelValue:o(de),"onUpdate:modelValue":[e[3]||(e[3]=l=>M(de)?de.value=l:null),_t],label:"전체선택","hide-details":"",class:"select-all-checkbox"},null,8,["modelValue"]),n("div",ao,[o(z)==="location"?(g(),X(s,{key:0,modelValue:o(te),"onUpdate:modelValue":e[4]||(e[4]=l=>M(te)?te.value=l:null),items:o(Ze),label:"위치",variant:"outlined",density:"compact","hide-details":"",class:"location-filter-select"},null,8,["modelValue","items"])):le("",!0),i(v,{class:"action-btn",variant:"flat",size:"small",disabled:o(y).length===0,loading:o(U),onClick:Bt},{default:p(()=>[...e[19]||(e[19]=[d(" 도서 삭제 ",-1)])]),_:1},8,["disabled","loading"]),i(v,{class:"action-btn",variant:"flat",size:"small",disabled:o(y).length===0,loading:o(U),onClick:xt},{default:p(()=>[...e[20]||(e[20]=[d(" 대여 처리 ",-1)])]),_:1},8,["disabled","loading"]),i(v,{class:"action-btn",variant:"flat",size:"small",disabled:o(y).length===0,loading:o(U),onClick:Et},{default:p(()=>[...e[21]||(e[21]=[d(" 반납 처리 ",-1)])]),_:1},8,["disabled","loading"])])])]),o(pe)?(g(),B("div",lo,[i(u,{indeterminate:"",color:"primary"})])):o(Y).length>0?(g(),B("div",no,[n("div",ro,[(g(!0),B(Te,null,Fe(o(lt),(l,ee)=>(g(),B("div",{key:`group-${ee}`,class:Oe(["book-card",{"book-card-selected":Ie(l)||pt(l)}])},[n("div",{class:"book-card-header",onClick:_=>yt(l)},[l.image?(g(),B("img",{key:0,src:l.image,alt:l.title,class:"book-thumbnail"},null,8,uo)):(g(),B("div",co,[...e[22]||(e[22]=[n("span",null,"NO IMAGE",-1)])])),n("div",vo,[n("div",mo,h(l.title),1),l.author?(g(),B("div",po,[e[23]||(e[23]=n("strong",null,"저자:",-1)),d(" "+h(l.author),1)])):le("",!0),l.publisher?(g(),B("div",fo,[e[24]||(e[24]=n("strong",null,"출판사:",-1)),d(" "+h(l.publisher),1)])):le("",!0),n("div",go," 등록 "+h(l.totalCount)+"권 ",1)])],8,io),n("div",yo,[(g(!0),B(Te,null,Fe(l.copies,_=>(g(),B("div",{key:_.id,class:Oe(["book-copy-item",{selected:Z(_)}]),onClick:ue=>bt(_)},[n("div",_o,[n("div",ho,[n("div",wo,[se(_)==="rented"?(g(),X(b,{key:0,size:"x-small",color:"primary",variant:"flat"},{default:p(()=>[...e[25]||(e[25]=[d(" 대여중 ",-1)])]),_:1})):se(_)==="overdue"?(g(),X(b,{key:1,size:"x-small",color:"error",variant:"flat"},{default:p(()=>[...e[26]||(e[26]=[d(" 연체중 ",-1)])]),_:1})):se(_)==="requested"?(g(),X(b,{key:2,size:"x-small",color:"warning",variant:"flat"},{default:p(()=>[...e[27]||(e[27]=[d(" 대여신청 ",-1)])]),_:1})):(g(),X(b,{key:3,size:"x-small",color:"success",variant:"outlined"},{default:p(()=>[...e[28]||(e[28]=[d(" 대여가능 ",-1)])]),_:1})),Re(_)||we(_)?(g(),B("span",ko,h(Re(_)||we(_)),1)):le("",!0)]),n("a",{href:"#",class:"copy-edit-link",onClick:Ce(ue=>Ct(_),["prevent","stop"])}," 정보수정 ",8,Co)]),n("div",Do,[n("span",Bo,h(_.labelNumber||"라벨없음"),1),e[30]||(e[30]=n("span",{class:"copy-divider"},"|",-1)),n("span",xo,[i(V,{size:"small",class:"mr-1"},{default:p(()=>[...e[29]||(e[29]=[d(" mdi-map-marker ",-1)])]),_:1}),d(" "+h(o(Pe)(_.location)||"위치없음"),1)])]),n("div",Vo,[se(_)==="rented"||se(_)==="overdue"?(g(),X(v,{key:0,color:"primary",size:"small",variant:"flat",onClick:Ce(ue=>Rt(_),["stop"])},{default:p(()=>[...e[31]||(e[31]=[d(" 반납처리 ",-1)])]),_:1},8,["onClick"])):(g(),X(v,{key:1,color:"primary",size:"small",variant:"flat",onClick:Ce(ue=>Vt(_),["stop"])},{default:p(()=>[d(h(se(_)==="requested"?"대여승인":"대여처리"),1)]),_:2},1032,["onClick"]))])])],10,bo))),128))])],2))),128))]),o(nt)?(g(),B("div",No,[i(v,{variant:"outlined",color:"primary",class:"load-more-btn",onClick:it},{default:p(()=>[d(" 더보기 ("+h(o(rt))+"개 더) ",1)]),_:1})])):le("",!0)])):(g(),B("div",Eo,[i(V,{size:"48",color:"grey-lighten-1",class:"mb-4"},{default:p(()=>[d(h(o(G)?"mdi-book-search-outline":"mdi-book-off-outline"),1)]),_:1}),o(G)?(g(),B("p",Ro,[e[32]||(e[32]=d(" '",-1)),n("strong",null,h(o(G)),1),e[33]||(e[33]=d("'에 대한 검색 결과가 없습니다. ",-1))])):(g(),B("p",$o," 등록된 도서가 없습니다. "))]))])])]),_:1}),i(I,{modelValue:o(ne),"onUpdate:modelValue":e[6]||(e[6]=l=>M(ne)?ne.value=l:null),location:"right",temporary:"",width:o(Ve),class:"side-navigation"},{default:p(()=>[n("div",Io,[i(c)])]),_:1},8,["modelValue","width"]),i(w,{modelValue:o(oe),"onUpdate:modelValue":e[9]||(e[9]=l=>M(oe)?oe.value=l:null),"max-width":"400",persistent:""},{default:p(()=>[i(N,{class:"rent-dialog-card"},{default:p(()=>[e[36]||(e[36]=n("div",{class:"rent-dialog-title text-h6"}," 대여자 정보 입력 ",-1)),n("div",Lo,[n("div",Ao," 대여 처리할 도서: "+h(o(Q).length)+"권 ",1),i(s,{modelValue:o(H),"onUpdate:modelValue":e[7]||(e[7]=l=>M(H)?H.value=l:null),items:me,label:"센터",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),i(a,{modelValue:o(W),"onUpdate:modelValue":e[8]||(e[8]=l=>M(W)?W.value=l:null),label:"이메일",variant:"outlined",density:"comfortable",placeholder:"example@email.com","error-messages":o(P)},null,8,["modelValue","error-messages"])]),n("div",qo,[i(C),i(v,{variant:"text",onClick:qe},{default:p(()=>[...e[34]||(e[34]=[d(" 취소 ",-1)])]),_:1}),i(v,{color:"primary",variant:"flat",loading:o(ye),disabled:!o(H)||!o(W),onClick:Nt},{default:p(()=>[...e[35]||(e[35]=[d(" 대여 처리 ",-1)])]),_:1},8,["loading","disabled"])])]),_:1})]),_:1},8,["modelValue"]),i(w,{modelValue:o(ie),"onUpdate:modelValue":e[13]||(e[13]=l=>M(ie)?ie.value=l:null),"max-width":"500",persistent:""},{default:p(()=>[i(N,{class:"edit-dialog-card"},{default:p(()=>[i(A,{class:"edit-dialog-title"},{default:p(()=>[...e[37]||(e[37]=[d(" 도서 정보 수정 ",-1)])]),_:1}),i(T,{class:"edit-dialog-content"},{default:p(()=>[o($)?(g(),B("div",So,[n("div",Uo,[o($).image?(g(),B("img",{key:0,src:o($).image,alt:o($).title,class:"book-thumbnail"},null,8,To)):(g(),B("div",Fo,[...e[38]||(e[38]=[n("span",null,"No Image",-1)])])),n("div",Oo,[n("div",zo,h(o($).title),1),n("div",Po,h(o($).labelNumber||"라벨없음"),1),n("div",Mo,[i(V,{size:"small",class:"mr-1"},{default:p(()=>[...e[39]||(e[39]=[d(" mdi-map-marker ",-1)])]),_:1}),d(" "+h(o(Pe)(o($).location)||"위치없음"),1)])])])])):le("",!0),i(q,{modelValue:o(f).category,"onUpdate:modelValue":e[10]||(e[10]=l=>o(f).category=l),items:o(_e),label:"카테고리 *",variant:"outlined",density:"comfortable",loading:o(he),class:"mb-3"},null,8,["modelValue","items","loading"]),n("div",Go,[i(a,{"model-value":o(et),label:"센터코드",variant:"outlined",density:"comfortable",readonly:"",disabled:"",class:"center-code-input"},null,8,["model-value"]),i(a,{modelValue:o(f).fourDigits,"onUpdate:modelValue":e[11]||(e[11]=l=>o(f).fourDigits=l),label:"4자리 번호 *",variant:"outlined",density:"comfortable",maxlength:"4","error-messages":o(K),hint:"0001~9999","persistent-hint":"",class:"four-digits-input",onInput:wt,onBlur:kt},null,8,["modelValue","error-messages"])]),i(s,{modelValue:o(f).location,"onUpdate:modelValue":e[12]||(e[12]=l=>o(f).location=l),items:o(Ye),label:"위치 *",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])]),_:1}),i(F,{class:"edit-dialog-actions"},{default:p(()=>[i(C),i(v,{variant:"text",onClick:Le},{default:p(()=>[...e[40]||(e[40]=[d(" 취소 ",-1)])]),_:1}),i(v,{color:"primary",variant:"flat",loading:o(be),disabled:!o(Ee),onClick:Dt},{default:p(()=>[...e[41]||(e[41]=[d(" 저장 ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},es=Lt(Ho,[["__scopeId","data-v-0bbf1fab"]]);export{es as default};
