import{f as P,a as ie}from"./BBhjQthV.js";import{F as X,k as f,r as T,o as re,e as de,g as x,O as N,H as a,L as i,K as d,I as u,M as s,G as l,T as b,P as n,W as E,J as c,Q as Z,S as B,U as L}from"./Czkv2xNP.js";const J={1:{x:1.5,y:1,width:14,height:13},2:{x:16,y:1,width:14,height:13},3:{x:51,y:1,width:18,height:13},4:{x:69,y:1,width:15,height:27},5:{x:1.5,y:77,width:13,height:12},6:{x:15,y:77,width:14,height:12},7:{x:29,y:77,width:12,height:12},8:{x:41,y:77,width:14,height:12},9:{x:69,y:77,width:15,height:12},구매칸:{x:1.5,y:28,width:13,height:24},기부칸:{x:69,y:54,width:15,height:10}},K={10:{x:1,y:1,width:18,height:12},11:{x:19,y:1,width:18,height:12},12:{x:37,y:1,width:18,height:12},13:{x:55,y:1,width:18,height:12},14:{x:7,y:17,width:14,height:18},15:{x:7,y:38,width:14,height:16},16:{x:7,y:57,width:14,height:16}},H={},j={},ue=(e,y)=>{if(!e||!y)return null;if(e==="용산센터"){if(J[y])return{imagePath:"/images/shelves/yongsan-shelf-1.png",area:J[y]};if(K[y])return{imagePath:"/images/shelves/yongsan-shelf-2.png",area:K[y]}}if(e==="강남센터"){if(H[y])return{imagePath:"/images/shelves/gangnam-shelf-1.png",area:H[y]};if(j[y])return{imagePath:"/images/shelves/gangnam-shelf-2.png",area:j[y]}}return null},_=e=>e==="용산센터"?!0:e==="강남센터"?Object.keys(H).length>0||Object.keys(j).length>0:!1,ce={class:"location-guide-header"},me={class:"location-guide-content"},fe={key:0,class:"shelf-image-container"},be=["src","alt"],ge={key:1,class:"no-image-message"},ye={class:"location-info-text"},ke={key:2,class:"location-confirm-text"},ve={class:"location-guide-actions"},he={__name:"LocationGuidePopup",props:{modelValue:{type:Boolean,default:!1},center:{type:String,required:!0},location:{type:String,required:!0},labelNumber:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:y}){const o=e,k=y,v=f({get:()=>o.modelValue,set:h=>k("update:modelValue",h)}),D=T(!1);re(()=>{const h=()=>{D.value=window.innerWidth<600};h(),window.addEventListener("resize",h),de(()=>{window.removeEventListener("resize",h)})});const $=f(()=>_(o.center)?ue(o.center,o.location):null),M=f(()=>P(o.location)),C=()=>{v.value=!1};return(h,r)=>{const R=x("v-icon"),A=x("v-btn"),w=x("v-card"),V=x("v-dialog");return a(),N(V,{modelValue:n(v),"onUpdate:modelValue":r[0]||(r[0]=p=>Z(v)?v.value=p:null),"max-width":"600",fullscreen:n(D)},{default:i(()=>[d(w,{class:"location-guide-card"},{default:i(()=>[u("div",ce,[r[2]||(r[2]=u("div",{class:"location-guide-title"}," 도서 위치 안내 ",-1)),d(A,{icon:"",variant:"text",size:"small",onClick:C},{default:i(()=>[d(R,null,{default:i(()=>[...r[1]||(r[1]=[s("mdi-close",-1)])]),_:1})]),_:1})]),u("div",me,[n($)?(a(),l("div",fe,[u("img",{src:n($).imagePath,alt:`${e.center} 서가 이미지`,class:"shelf-image"},null,8,be)])):(a(),l("div",ge,[d(R,{size:"48",color:"grey-lighten-1",class:"mb-4"},{default:i(()=>[...r[3]||(r[3]=[s(" mdi-image-off-outline ",-1)])]),_:1}),r[4]||(r[4]=u("p",null,"위치 안내 이미지가 준비되지 않았습니다.",-1))])),u("div",ye,[d(R,{size:"small",class:"mr-1"},{default:i(()=>[...r[5]||(r[5]=[s(" mdi-map-marker ",-1)])]),_:1}),e.labelNumber?(a(),l(E,{key:0},[r[6]||(r[6]=s(' "',-1)),u("strong",null,c(e.labelNumber),1),r[7]||(r[7]=s('" 도서는 ',-1))],64)):b("",!0),u("strong",null,c(n(M)),1),r[8]||(r[8]=s("에 있습니다. ",-1))]),e.labelNumber?(a(),l("div",ke," 위치와 라벨번호를 확인 후 대여해주세요. ")):b("",!0)]),u("div",ve,[d(A,{color:"primary",variant:"flat",block:"",onClick:C},{default:i(()=>[...r[9]||(r[9]=[s(" 확인 ",-1)])]),_:1})])]),_:1})]),_:1},8,["modelValue","fullscreen"])}}},we=X(he,[["__scopeId","data-v-0dde869b"]]),xe={key:0,class:"book-card-header"},Re={class:"book-card-inner"},Se={class:"book-image-wrapper"},Be={key:1,class:"book-image-placeholder"},Ae={class:"book-card-content"},qe={class:"book-title mb-2"},ze={key:0,class:"book-info text-body-2 mb-1"},Ne={key:1,class:"book-info book-info-publisher text-body-2"},Ce={key:2,class:"book-location text-body-2"},Ie={class:"location-text"},Le={key:3,class:"book-quantity text-body-2"},De={key:4,class:"book-label-number text-body-2"},$e={key:1,class:"book-action-area book-action-area-admin"},Me={class:"admin-info-text text-body-2"},Ve={key:2,class:"book-action-area"},pe={key:3,class:"book-action-area book-action-area-admin"},Ee={class:"admin-info-text text-body-2"},Oe={key:4,class:"book-action-area book-action-area-mypage"},Fe={key:5,class:"book-action-area"},Ge={key:0,class:"rented-text text-body-2"},Pe={key:1,class:"requested-status-text text-body-2"},Te={key:0,class:"registered-text text-body-2"},He={class:"registered-text text-body-2"},je={key:2,class:"requested-text text-body-2"},Ue={key:0,class:"admin-info-text text-body-2 requested-badge"},We={key:1,class:"admin-info-text text-body-2"},Qe={__name:"BookCard",props:{book:{type:Object,required:!0},center:{type:String,required:!0},registeredBooks:{type:Array,default:()=>[]},isRegistered:{type:Boolean,default:!1},showAction:{type:Boolean,default:!0},selectable:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},status:{type:String,default:null},showStatusFlags:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},actionButtonText:{type:String,default:""},registeredMessage:{type:String,default:""},requestedBooks:{type:Array,default:()=>[]},requestedMessage:{type:String,default:""},hideOverdueStatus:{type:Boolean,default:!1},showReturnDate:{type:Boolean,default:!1},returnDate:{type:[Date,Object,String],default:null},showRentButton:{type:Boolean,default:!1},renterInfo:{type:String,default:""},requesterInfo:{type:String,default:""},showAdminRentButton:{type:Boolean,default:!1},showAdminReturnButton:{type:Boolean,default:!1},allowRegisterRequested:{type:Boolean,default:!1},allowAdditionalRegister:{type:Boolean,default:!1},showLocation:{type:Boolean,default:!1},location:{type:String,default:""},locations:{type:Array,default:()=>[]},showQuantity:{type:Boolean,default:!1},availableCount:{type:Number,default:0},totalCount:{type:Number,default:0},showLabelNumber:{type:Boolean,default:!1},labelNumber:{type:String,default:""}},emits:["register","select","return","rent","adminRent","adminReturn","locationClick"],setup(e,{emit:y}){const o=e,k=y,v=T(!1),D=f(()=>!!(o.book.cover||o.book.image)),$=f(()=>o.book.cover||o.book.image||""),M=f(()=>o.location?P(o.location):o.locations&&o.locations.length>0?ie(o.locations):o.book.location?P(o.book.location):""),C=f(()=>o.location?o.location:o.locations&&o.locations.length>0?o.locations[0]:o.book.location?o.book.location:""),h=f(()=>_(o.center)),r=()=>{h.value&&C.value&&(v.value=!0,k("locationClick",{center:o.center,location:C.value}))},R=f(()=>{if(o.isRegistered)return!0;const m=o.book.isbn13||o.book.isbn||"";return m?o.registeredBooks.some(t=>{const S=t.isbn13||t.isbn||t.id||"",q=m.toString().trim(),g=S.toString().trim();return q===g&&t.center===o.center}):!1}),A=f(()=>{const m=o.book.isbn13||o.book.isbn||"";return m?o.requestedBooks.some(t=>{const S=t.isbn13||t.isbn||"",q=m.toString().trim(),g=S.toString().trim();return q===g&&t.center===o.center}):!1}),w=T(!1),V=async()=>{if(!w.value)try{w.value=!0,k("register",o.book)}finally{setTimeout(()=>{w.value=!1},1e3)}},p=f(()=>(o.location||o.book?.location)==="구매칸"),I=f(()=>o.status?o.status:null),O=f(()=>{const m=I.value;return o.hideOverdueStatus&&m==="overdue"?"대여중":{new:"NEW",rented:"대여중",overdue:"연체중",requested:"대여신청"}[m]||""}),ee=f(()=>{const m=I.value;return o.hideOverdueStatus&&m==="overdue"?"info":{new:"primary",rented:"info",overdue:"error",requested:"warning"}[m]||"primary"}),F=f(()=>I.value==="rented"||I.value==="overdue"),G=f(()=>I.value==="requested"),te=()=>{o.selectable&&!o.disabled&&k("select",o.book,!o.selected)},oe=()=>{k("return",o.book)},ne=()=>{k("rent",o.book)},U=()=>{k("adminRent",o.book)},se=()=>{k("adminReturn",o.book)},W=f(()=>{if(!o.returnDate)return"";const m=o.returnDate?.toDate?.()||new Date(o.returnDate),t=m.getFullYear(),S=String(m.getMonth()+1).padStart(2,"0"),q=String(m.getDate()).padStart(2,"0");return`${t}.${S}.${q}`}),Q=f(()=>o.returnDate?(o.returnDate?.toDate?.()||new Date(o.returnDate))<new Date:!1);return(m,t)=>{const S=x("v-chip"),q=x("v-img"),g=x("v-icon"),z=x("v-btn"),ae=x("v-card"),le=we;return a(),l(E,null,[d(ae,{class:L(["book-card",{"book-card-selected":e.selectable&&e.selected,"book-card-disabled":e.disabled}]),elevation:"0",onClick:t[0]||(t[0]=Y=>e.selectable?te():null)},{default:i(()=>[e.showStatusFlags&&(n(O)||n(p))?(a(),l("div",xe,[n(p)?(a(),N(S,{key:0,color:"primary",size:"x-small",variant:"flat",class:"status-chip"},{default:i(()=>[...t[2]||(t[2]=[s(" NEW ",-1)])]),_:1})):b("",!0),n(O)?(a(),N(S,{key:1,color:n(ee),size:"x-small",variant:"flat",class:"status-chip"},{default:i(()=>[s(c(n(O)),1)]),_:1},8,["color"])):b("",!0)])):b("",!0),u("div",Re,[u("div",Se,[n(D)?(a(),N(q,{key:0,src:n($),alt:e.book.title,height:"100%",cover:"",class:"book-image"},null,8,["src","alt"])):(a(),l("div",Be,[...t[3]||(t[3]=[u("span",null,"No Image",-1)])]))]),u("div",Ae,[u("div",qe,c(e.book.title),1),e.book.author?(a(),l("div",ze,[t[4]||(t[4]=u("strong",null,"저자:",-1)),s(" "+c(e.book.author),1)])):b("",!0),e.book.publisher?(a(),l("div",Ne,[t[5]||(t[5]=u("strong",null,"출판사:",-1)),s(" "+c(e.book.publisher),1)])):b("",!0),e.showLocation&&n(M)?(a(),l("div",Ce,[d(g,{size:"small",class:"mr-1"},{default:i(()=>[...t[6]||(t[6]=[s(" mdi-map-marker ",-1)])]),_:1}),u("span",Ie,c(n(M)),1),n(h)?(a(),N(g,{key:0,size:"small",class:"ml-1 location-info-icon clickable",onClick:B(r,["stop"])},{default:i(()=>[...t[7]||(t[7]=[s(" mdi-information-outline ",-1)])]),_:1})):b("",!0)])):b("",!0),e.showQuantity&&e.totalCount>0?(a(),l("div",Le,[d(g,{size:"small",class:"mr-1"},{default:i(()=>[...t[8]||(t[8]=[s(" mdi-book-multiple ",-1)])]),_:1}),s(" 대여가능 "+c(e.availableCount)+"권 / 총 "+c(e.totalCount)+"권 ",1)])):b("",!0),e.showLabelNumber&&e.labelNumber?(a(),l("div",De,[d(g,{size:"small",class:"mr-1"},{default:i(()=>[...t[9]||(t[9]=[s(" mdi-label ",-1)])]),_:1}),s(" "+c(e.labelNumber),1)])):b("",!0)])]),e.showAdminRentButton&&n(G)&&e.requesterInfo?(a(),l("div",$e,[u("div",Me,[d(g,{size:"small",class:"mr-1"},{default:i(()=>[...t[10]||(t[10]=[s(" mdi-account-clock ",-1)])]),_:1}),s(" "+c(e.requesterInfo),1)]),d(z,{color:"primary",size:"small",class:"admin-rent-btn mt-2",onClick:B(U,["stop"])},{default:i(()=>[...t[11]||(t[11]=[s(" 대여 처리 ",-1)])]),_:1})])):e.showAdminRentButton&&!n(F)&&!n(G)?(a(),l("div",Ve,[d(z,{color:"primary",size:"small",class:"admin-rent-btn",onClick:B(U,["stop"])},{default:i(()=>[...t[12]||(t[12]=[s(" 대여 처리 ",-1)])]),_:1})])):e.renterInfo&&n(F)?(a(),l("div",pe,[u("div",Ee,[d(g,{size:"small",class:"mr-1"},{default:i(()=>[...t[13]||(t[13]=[s(" mdi-account ",-1)])]),_:1}),s(" "+c(e.renterInfo),1)]),e.returnDate?(a(),l("div",{key:0,class:L(["return-date-text text-body-2",{"return-date-overdue":n(Q)}])},[d(g,{size:"small",class:"mr-1"},{default:i(()=>[...t[14]||(t[14]=[s(" mdi-calendar-clock ",-1)])]),_:1}),s(" 반납예정일: "+c(n(W)),1)],2)):b("",!0),e.showAdminReturnButton?(a(),N(z,{key:1,color:"primary",size:"small",class:"admin-return-btn mt-2",onClick:B(se,["stop"])},{default:i(()=>[...t[15]||(t[15]=[s(" 반납 처리 ",-1)])]),_:1})):b("",!0)])):b("",!0),e.showReturnDate&&e.returnDate?(a(),l("div",Oe,[d(z,{color:"primary",size:"small",class:"return-btn",onClick:B(oe,["stop"])},{default:i(()=>[...t[16]||(t[16]=[s(" 반납하기 ",-1)])]),_:1}),u("div",{class:L(["return-date-text text-body-2",{"return-date-overdue":n(Q)}])},[d(g,{size:"small",class:"mr-1"},{default:i(()=>[...t[17]||(t[17]=[s(" mdi-calendar-clock ",-1)])]),_:1}),s(" 반납예정일: "+c(n(W)),1)],2)])):e.showRentButton?(a(),l("div",Fe,[n(F)?(a(),l("div",Ge," 대여중인 도서입니다. ")):n(G)?(a(),l("div",Pe," 신청중인 도서입니다. ")):(a(),N(z,{key:2,color:"primary",size:"small",class:"rent-btn",onClick:B(ne,["stop"])},{default:i(()=>[...t[18]||(t[18]=[s(" 대여 신청 ",-1)])]),_:1}))])):e.showAction?(a(),l("div",{key:6,class:L(["book-action-area",{"book-action-area-admin":(e.requesterInfo||n(A)&&e.allowRegisterRequested)&&!n(R),"book-action-area-column":n(R)&&e.allowAdditionalRegister}])},[n(R)&&!e.allowAdditionalRegister?(a(),l("div",Te,c(e.registeredMessage||`${e.center}에 등록된 도서입니다.`),1)):n(R)&&e.allowAdditionalRegister?(a(),l(E,{key:1},[u("div",He,c(e.registeredMessage||`${e.center}에 등록된 도서입니다.`),1),d(z,{color:"secondary",size:"small",variant:"outlined",loading:n(w),disabled:n(w),class:"register-btn",onClick:B(V,["stop"])},{default:i(()=>[...t[19]||(t[19]=[s(" 추가 등록 ",-1)])]),_:1},8,["loading","disabled"])],64)):n(A)&&!e.allowRegisterRequested?(a(),l("div",je,c(e.requestedMessage||`${e.center}에 이미 신청된 도서입니다.`),1)):(a(),l(E,{key:3},[n(A)&&e.allowRegisterRequested?(a(),l("div",Ue,[d(g,{size:"small",class:"mr-1"},{default:i(()=>[...t[20]||(t[20]=[s(" mdi-book-clock ",-1)])]),_:1}),t[21]||(t[21]=s(" 신청된 도서 ",-1))])):e.requesterInfo?(a(),l("div",We,[d(g,{size:"small",class:"mr-1"},{default:i(()=>[...t[22]||(t[22]=[s(" mdi-account-clock ",-1)])]),_:1}),s(" "+c(e.requesterInfo),1)])):b("",!0),d(z,{color:"primary",size:"small",loading:n(w),disabled:n(w),class:L(["register-btn",{"mt-2":e.requesterInfo||n(A)&&e.allowRegisterRequested}]),onClick:B(V,["stop"])},{default:i(()=>[s(c(e.actionButtonText||`${e.center}에 등록하기`),1)]),_:1},8,["loading","disabled","class"])],64))],2)):b("",!0)]),_:1},8,["class"]),d(le,{modelValue:n(v),"onUpdate:modelValue":t[1]||(t[1]=Y=>Z(v)?v.value=Y:null),center:e.center,location:n(C),"label-number":e.labelNumber},null,8,["modelValue","center","location","label-number"])],64)}}},Ke=X(Qe,[["__scopeId","data-v-830457a3"]]);export{Ke as _,we as a,_ as h};
