import{F as _e,a0 as he,N as be,r as y,a1 as ke,k as U,o as we,e as Ce,G as u,K as w,I as t,R as C,M as v,a2 as R,a3 as M,U as J,$ as Se,S as N,J as i,a4 as De,P as Te,O as W,L as _,g as j,H as n,T as Y,X as Z,a5 as Ne}from"./Dw84HrPm.js";import{b as I}from"./C-xtXPWq.js";import{u as xe}from"./BZMIszvQ.js";import{u as Ve}from"./DaFGRQh7.js";import"./DjMHYbGS.js";const Ue={class:"test-scenario-page"},Re={key:0,class:"text-center py-8"},Ae={class:"section"},Le={class:"info-table"},ze={class:"tester-input-row"},Be=["disabled"],Ee={key:0,class:"testers-list"},Me=["onClick"],Oe={class:"progress-summary sticky"},Pe={class:"progress-header"},Xe={class:"progress-percent"},$e={class:"progress-bar-large"},je={class:"progress-stats"},Fe={class:"stat pass"},Ke={class:"stat fail"},He={class:"stat partial"},Qe={class:"stat skip"},qe={class:"stat total"},Ge={class:"test-table"},Je={class:"col-id"},We={class:"col-item"},Ye={class:"col-method"},Ze={class:"col-expected"},Ie={class:"col-result"},et=["value","onChange"],tt={class:"col-note"},st=["value","onInput","onBlur"],lt={class:"col-tester"},at=["value","disabled","onChange"],ot=["value"],nt={class:"section"},rt={class:"approval-table"},ut=["onUpdate:modelValue"],it=["onUpdate:modelValue"],dt=["onUpdate:modelValue"],ct={class:"col-action"},pt=["onClick"],vt={class:"page-actions"},ft={key:2,class:"error-state"},mt={__name:"[id]",setup(yt){const ee=he(),{confirm:F,alert:A}=be(),{TEST_SCENARIOS:te,getTotalTestCount:se,getAllTestIds:le,getSession:ae,subscribeToSession:oe,saveTestResult:O,updateSessionStatus:K,updateSessionInfo:ne}=xe(),g=ee.params.id,P=y(!0),d=y(null),o=y({}),S=y(!1),h=y({}),x=ke({testDate:""}),p=y([]),V=y(""),D=y({}),b=y([{role:"",name:"",date:""}]);let L=null;Ve({title:U(()=>(d.value,"í…ŒìŠ¤íŠ¸ - CNX Library"))}),we(async()=>{await re(),L=await oe(g,s=>{d.value=s},s=>{Object.keys(s).forEach(e=>{const l=s[e],f=o.value[e];o.value[e]||(o.value[e]={}),o.value[e].result=l.result||"",(h.value[e]===void 0||h.value[e]===(f?.note||""))&&(h.value[e]=l.note||"",o.value[e].note=l.note||""),(D.value[e]===void 0||D.value[e]===(f?.tester||""))&&(D.value[e]=l.tester||"",o.value[e].tester=l.tester||"")})})}),Ce(()=>{L&&(L(),L=null)});const re=async()=>{try{P.value=!0;const s=await ae(g);d.value=s.session,o.value=s.results;const e=s.session.testDate?.toDate?.()||new Date(s.session.testDate);x.testDate=e.toISOString().split("T")[0],Array.isArray(s.session.testers)?p.value=s.session.testers:s.session.tester&&(p.value=[s.session.tester]),Object.keys(s.results).forEach(l=>{s.results[l].tester&&(D.value[l]=s.results[l].tester)}),s.session.approvers&&s.session.approvers.length>0&&(b.value=s.session.approvers),Object.keys(s.results).forEach(l=>{h.value[l]=s.results[l].note||""})}catch(s){console.error("ì„¸ì…˜ ë¡œë“œ ì˜¤ë¥˜:",s),d.value=null}finally{P.value=!1}},H=U(()=>se()),ue=U(()=>new Set(le())),T=U(()=>{let s=0,e=0,l=0,f=0,k=0;return Object.entries(o.value).forEach(([r,c])=>{if(ue.value.has(r)&&c.result)switch(k++,c.result){case"pass":s++;break;case"fail":e++;break;case"partial":l++;break;case"skip":f++;break}}),{pass:s,fail:e,partial:l,skip:f,completed:k}}),Q=U(()=>{const s=H.value;if(!s)return 0;const e=T.value.completed;return Math.min(100,Math.round(e/s*100))}),z=s=>o.value[s]?.result||"",X=s=>h.value[s]??o.value[s]?.note??"",q=s=>{const e=z(s);return e?`result-${e}`:""},ie=async(s,e)=>{try{await O(g,s,{result:e||"",note:X(s),tester:$(s)}),o.value[s]||(o.value[s]={}),o.value[s].result=e||""}catch(l){console.error("ê²°ê³¼ ì €ì¥ ì˜¤ë¥˜:",l),await A("ê²°ê³¼ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",{type:"error"})}},de=(s,e)=>{h.value[s]=e},ce=async s=>{try{const e=I(h.value[s]||""),l=o.value[s]?.note||"";e!==l&&(await O(g,s,{result:z(s),note:e,tester:$(s)}),o.value[s]||(o.value[s]={}),o.value[s].note=e)}catch(e){console.error("ë¹„ê³  ì €ì¥ ì˜¤ë¥˜:",e)}},$=s=>D.value[s]??o.value[s]?.tester??"",pe=async(s,e)=>{try{D.value[s]=e,await O(g,s,{result:z(s),note:X(s),tester:e||""}),o.value[s]||(o.value[s]={}),o.value[s].tester=e||""}catch(l){console.error("ë‹´ë‹¹ì ì €ì¥ ì˜¤ë¥˜:",l)}},G=()=>{const s=I(V.value.trim());s&&!p.value.includes(s)&&(p.value.push(s),V.value="",B())},ve=s=>{p.value.splice(s,1),B()},B=async()=>{try{await ne(g,{testDate:new Date(x.testDate),testers:p.value,approvers:b.value}),d.value&&(d.value.testDate=new Date(x.testDate),d.value.testers=p.value,d.value.approvers=b.value)}catch(s){console.error("ì„¸ì…˜ ì •ë³´ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:",s)}},fe=()=>{b.value.push({role:"",name:"",date:""})},me=s=>{b.value.splice(s,1),E()},E=()=>{B()},ye=async()=>{if(await F(`í…ŒìŠ¤íŠ¸ë¥¼ ì™„ë£Œ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?

ì™„ë£Œ í›„ì—ë„ ê²°ê³¼ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`,{type:"confirm"}))try{S.value=!0,await K(g,"completed"),d.value.status="completed",await A("í…ŒìŠ¤íŠ¸ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!",{type:"success"})}catch(e){console.error("ì™„ë£Œ ì²˜ë¦¬ ì˜¤ë¥˜:",e),await A("ì™„ë£Œ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",{type:"error"})}finally{S.value=!1}},ge=async()=>{if(await F("í…ŒìŠ¤íŠ¸ë¥¼ ë‹¤ì‹œ ì§„í–‰ ìƒíƒœë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))try{S.value=!0,await K(g,"in_progress"),d.value.status="in_progress"}catch(e){console.error("ìƒíƒœ ë³€ê²½ ì˜¤ë¥˜:",e),await A("ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",{type:"error"})}finally{S.value=!1}};return(s,e)=>{const l=j("v-progress-circular"),f=j("v-icon"),k=j("v-btn");return n(),u("div",Ue,[P.value?(n(),u("div",Re,[w(l,{indeterminate:"",color:"primary",size:"48"}),e[2]||(e[2]=t("p",{class:"mt-4 text-medium-emphasis"}," í…ŒìŠ¤íŠ¸ ì„¸ì…˜ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘... ",-1))])):d.value?(n(),u(C,{key:1},[e[24]||(e[24]=t("div",{class:"page-header"},[t("h1",null,"CNX Library í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤"),t("p",{class:"subtitle"},"ì´ í˜ì´ì§€ëŠ” ê°œë°œì/QA ì „ìš© í˜ì´ì§€ì…ë‹ˆë‹¤.")],-1)),t("div",Ae,[e[6]||(e[6]=t("h2",null,"ğŸ“‹ í…ŒìŠ¤íŠ¸ ê°œìš”",-1)),e[7]||(e[7]=t("p",null,[v("ì´ ë¬¸ì„œëŠ” CNX Libraryì˜ ëª¨ë“  ê¸°ëŠ¥ì„ ê²€ì¦í•˜ê¸° ìœ„í•œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ì…ë‹ˆë‹¤."),t("br"),v("í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ í›„ ê° í•­ëª©ì˜ ê²°ê³¼ë¥¼ ê¸°ë¡í•˜ì—¬ ì‹œìŠ¤í…œì˜ ì •ìƒ ë™ì‘ì„ í™•ì¸í•©ë‹ˆë‹¤.")],-1)),e[8]||(e[8]=t("h3",null,"í…ŒìŠ¤íŠ¸ í™˜ê²½",-1)),t("table",Le,[t("tbody",null,[e[5]||(e[5]=t("tr",null,[t("th",null,"í…ŒìŠ¤íŠ¸ URL"),t("td",null,"https://rarecat85.github.io/cnx-library")],-1)),t("tr",null,[e[3]||(e[3]=t("th",null,"í…ŒìŠ¤íŠ¸ ì¼ì",-1)),t("td",null,[R(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>x.testDate=r),type:"date",class:"inline-input",onChange:B},null,544),[[M,x.testDate]])])]),t("tr",null,[e[4]||(e[4]=t("th",null,"í…ŒìŠ¤íŠ¸ ë‹´ë‹¹ì",-1)),t("td",null,[t("div",ze,[R(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>V.value=r),type:"text",placeholder:"ë‹´ë‹¹ì ì´ë¦„ ì…ë ¥",class:"inline-input tester-input",onKeyup:Se(G,["enter"])},null,544),[[M,V.value]]),t("button",{type:"button",class:"add-tester-btn",disabled:!V.value.trim(),onClick:G}," ì¶”ê°€ ",8,Be)]),p.value.length>0?(n(),u("div",Ee,[(n(!0),u(C,null,N(p.value,(r,c)=>(n(),u("span",{key:c,class:"tester-tag"},[v(i(r)+" ",1),t("button",{type:"button",class:"remove-tester-btn",onClick:a=>ve(c)}," Ã— ",8,Me)]))),128))])):J("",!0)])])])]),e[9]||(e[9]=t("h3",null,"ê²°ê³¼ í‘œê¸°ë²•",-1)),e[10]||(e[10]=t("ul",{class:"legend-list"},[t("li",null,"âœ… í†µê³¼ (Pass)"),t("li",null,"âŒ ì‹¤íŒ¨ (Fail)"),t("li",null,"âš ï¸ ë¶€ë¶„ í†µê³¼ (Partial)"),t("li",null,"â­ï¸ ìŠ¤í‚µ (Skip)")],-1))]),t("div",Oe,[t("div",Pe,[e[11]||(e[11]=t("span",{class:"progress-title"},"ì§„í–‰ë¥ ",-1)),t("span",Xe,i(Q.value)+"%",1)]),t("div",$e,[t("div",{class:"progress-fill",style:De({width:Q.value+"%"})},null,4)]),t("div",je,[t("span",Fe,"âœ… "+i(T.value.pass),1),t("span",Ke,"âŒ "+i(T.value.fail),1),t("span",He,"âš ï¸ "+i(T.value.partial),1),t("span",Qe,"â­ï¸ "+i(T.value.skip),1),t("span",qe,i(T.value.completed)+"/"+i(H.value),1)])]),(n(!0),u(C,null,N(Te(te),r=>(n(),u("div",{key:r.section,class:"section test-section"},[t("h2",null,i(r.section),1),(n(!0),u(C,null,N(r.subsections,c=>(n(),u("div",{key:c.title,class:"subsection"},[t("h3",null,i(c.title),1),t("table",Ge,[e[14]||(e[14]=t("thead",null,[t("tr",null,[t("th",{class:"col-id"},"ë²ˆí˜¸"),t("th",{class:"col-item"},"í•­ëª©"),t("th",{class:"col-method"},"í…ŒìŠ¤íŠ¸ ë°©ë²•"),t("th",{class:"col-expected"},"ì˜ˆìƒ ê²°ê³¼"),t("th",{class:"col-result"},"ê²°ê³¼"),t("th",{class:"col-note"},"ë¹„ê³ "),t("th",{class:"col-tester"},"ë‹´ë‹¹ì")])],-1)),t("tbody",null,[(n(!0),u(C,null,N(c.items,a=>(n(),u("tr",{key:a.id,class:Y(q(a.id))},[t("td",Je,i(a.id),1),t("td",We,i(a.name),1),t("td",Ye,i(a.method),1),t("td",Ze,i(a.expected),1),t("td",Ie,[t("select",{value:z(a.id),class:Y(["result-select",q(a.id)]),onChange:m=>ie(a.id,m.target.value)},[...e[12]||(e[12]=[Z('<option value="" data-v-89809d78>ì„ íƒ</option><option value="pass" data-v-89809d78>âœ… í†µê³¼</option><option value="fail" data-v-89809d78>âŒ ì‹¤íŒ¨</option><option value="partial" data-v-89809d78>âš ï¸ ë¶€ë¶„í†µê³¼</option><option value="skip" data-v-89809d78>â­ï¸ ìŠ¤í‚µ</option>',5)])],42,et)]),t("td",tt,[t("input",{value:X(a.id),type:"text",placeholder:"ë¹„ê³  ì…ë ¥...",class:"note-input",onInput:m=>de(a.id,m.target.value),onBlur:m=>ce(a.id)},null,40,st)]),t("td",lt,[t("select",{value:$(a.id),class:"tester-select",disabled:p.value.length===0,onChange:m=>pe(a.id,m.target.value)},[e[13]||(e[13]=t("option",{value:""},"-",-1)),(n(!0),u(C,null,N(p.value,m=>(n(),u("option",{key:m,value:m},i(m),9,ot))),128))],40,at)])],2))),128))])])]))),128))]))),128)),t("div",nt,[e[17]||(e[17]=t("h2",null,"âœï¸ ìŠ¹ì¸",-1)),t("table",rt,[e[16]||(e[16]=t("thead",null,[t("tr",null,[t("th",null,"ì—­í• "),t("th",null,"ì´ë¦„"),t("th",null,"ì¼ì"),t("th",{class:"col-action"})])],-1)),t("tbody",null,[(n(!0),u(C,null,N(b.value,(r,c)=>(n(),u("tr",{key:c},[t("td",null,[R(t("select",{"onUpdate:modelValue":a=>r.role=a,class:"approval-select",onChange:E},[...e[15]||(e[15]=[Z('<option value="" data-v-89809d78>ì„ íƒ</option><option value="tester" data-v-89809d78>í…ŒìŠ¤í„°</option><option value="developer" data-v-89809d78>ê°œë°œì</option><option value="pm" data-v-89809d78>PM</option><option value="qa" data-v-89809d78>QA</option><option value="other" data-v-89809d78>ê¸°íƒ€</option>',6)])],40,ut),[[Ne,r.role]])]),t("td",null,[R(t("input",{"onUpdate:modelValue":a=>r.name=a,type:"text",placeholder:"ì´ë¦„",class:"approval-input",onBlur:E},null,40,it),[[M,r.name]])]),t("td",null,[R(t("input",{"onUpdate:modelValue":a=>r.date=a,type:"date",class:"approval-input",onChange:E},null,40,dt),[[M,r.date]])]),t("td",ct,[b.value.length>1?(n(),u("button",{key:0,type:"button",class:"remove-btn",title:"ì‚­ì œ",onClick:a=>me(c)}," âœ• ",8,pt)):J("",!0)])]))),128))])]),t("button",{type:"button",class:"add-approver-btn",onClick:fe}," + ìŠ¹ì¸ì ì¶”ê°€ ")]),e[25]||(e[25]=t("div",{class:"section"},[t("h2",null,"ğŸ“Œ ì°¸ê³ ì‚¬í•­"),t("ol",{class:"note-list"},[t("li",null,"í…ŒìŠ¤íŠ¸ ì „ ìºì‹œ ë° ì¿ í‚¤ë¥¼ ì‚­ì œí•˜ê³  ì‹œì‘í•˜ì„¸ìš”."),t("li",null,"ê° í…ŒìŠ¤íŠ¸ëŠ” ë…ë¦½ì ìœ¼ë¡œ ìˆ˜í–‰ ê°€ëŠ¥í•´ì•¼ í•©ë‹ˆë‹¤."),t("li",null,"ì‹¤íŒ¨í•œ í…ŒìŠ¤íŠ¸ëŠ” ì¦‰ì‹œ ì´ìŠˆë¡œ ë“±ë¡í•˜ì„¸ìš”."),t("li",null,"ìŠ¤í¬ë¦°ìƒ·ì´ í•„ìš”í•œ ê²½ìš° ë³„ë„ í´ë”ì— ì €ì¥í•˜ì„¸ìš”.")])],-1)),t("div",vt,[w(k,{variant:"outlined",size:"large",to:"/test-scenario/sessions"},{default:_(()=>[w(f,{left:""},{default:_(()=>[...e[18]||(e[18]=[v(" mdi-arrow-left ",-1)])]),_:1}),e[19]||(e[19]=v(" ì„¸ì…˜ ëª©ë¡ ",-1))]),_:1}),d.value.status!=="completed"?(n(),W(k,{key:0,color:"success",variant:"flat",size:"large",loading:S.value,onClick:ye},{default:_(()=>[w(f,{left:""},{default:_(()=>[...e[20]||(e[20]=[v(" mdi-check-circle ",-1)])]),_:1}),e[21]||(e[21]=v(" í…ŒìŠ¤íŠ¸ ì™„ë£Œ ",-1))]),_:1},8,["loading"])):(n(),W(k,{key:1,color:"warning",variant:"flat",size:"large",loading:S.value,onClick:ge},{default:_(()=>[w(f,{left:""},{default:_(()=>[...e[22]||(e[22]=[v(" mdi-pencil ",-1)])]),_:1}),e[23]||(e[23]=v(" ë‹¤ì‹œ ì§„í–‰í•˜ê¸° ",-1))]),_:1},8,["loading"]))]),e[26]||(e[26]=t("div",{class:"page-footer"},[t("p",null,"ğŸ”’ ì´ í˜ì´ì§€ëŠ” ìˆ¨ê²¨ì§„ í˜ì´ì§€ì…ë‹ˆë‹¤. URL ì§ì ‘ ì…ë ¥ìœ¼ë¡œë§Œ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤.")],-1))],64)):(n(),u("div",ft,[w(f,{size:"64",color:"error"},{default:_(()=>[...e[27]||(e[27]=[v(" mdi-alert-circle-outline ",-1)])]),_:1}),e[29]||(e[29]=t("p",null,"í…ŒìŠ¤íŠ¸ ì„¸ì…˜ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",-1)),w(k,{to:"/test-scenario/sessions",variant:"outlined"},{default:_(()=>[...e[28]||(e[28]=[v(" ì„¸ì…˜ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸° ",-1)])]),_:1})]))])}}},wt=_e(mt,[["__scopeId","data-v-89809d78"]]);export{wt as default};
