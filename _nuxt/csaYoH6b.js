import{F as E,u as F,N as H,r as b,o as K,G as p,I as e,K as n,L as l,P as x,R as W,S as A,g as m,H as u,M as c,J as i,a4 as G,W as J}from"./H8Z8LE6b.js";import{u as O}from"./B54HU3Ip.js";import{u as X}from"./BEkJiM56.js";import"./9l_XyyT8.js";const q={class:"sessions-page"},Q={class:"create-section"},U={class:"sessions-section"},Y={key:0,class:"text-center py-8"},Z={key:1,class:"empty-state"},ss={key:2,class:"sessions-list"},ts=["onClick"],es={class:"session-info"},as={class:"session-header"},os={class:"session-date"},rs={class:"session-tester"},ns={class:"session-progress"},is={class:"progress-bar"},ls={class:"progress-stats"},cs={class:"stat pass"},ds={class:"stat fail"},ps={class:"stat partial"},us={class:"stat skip"},_s={class:"stat total"},vs={class:"session-actions"},gs={__name:"index",setup(ms){O({title:"í…ŒìŠ¤íŠ¸ ì„¸ì…˜ ê´€ë¦¬ - CNX Library"});const w=F(),{confirm:D,alert:_}=H(),{createSession:C,getSessions:T,getSession:$,deleteSession:z,getTotalTestCount:k,getAllTestIds:I,loading:L}=X(),f=b(!1),y=b([]);K(async()=>{await P()});const M=new Set(I()),N=t=>{let s=0,a=0,r=0,d=0,v=0;return Object.entries(t).forEach(([o,g])=>{if(M.has(o)&&g.result)switch(v++,g.result){case"pass":s++;break;case"fail":a++;break;case"partial":r++;break;case"skip":d++;break}}),{pass:s,fail:a,partial:r,skip:d,completed:v}},P=async()=>{try{const t=await T(),s=await Promise.all(t.map(async a=>{try{const{results:r}=await $(a.id),d=N(r);return{...a,validProgress:d}}catch(r){return console.error(`ì„¸ì…˜ ${a.id} ê²°ê³¼ ë¡œë“œ ì˜¤ë¥˜:`,r),{...a,validProgress:a.progress}}}));y.value=s}catch(t){console.error("ì„¸ì…˜ ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜:",t),await _("ì„¸ì…˜ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",{type:"error"})}},h=t=>t.testers&&t.testers.length>0?t.testers.join(", "):t.tester?t.tester:"(ë‹´ë‹¹ì ë¯¸ì…ë ¥)",V=async()=>{try{f.value=!0;const t=await C({testers:[],testDate:new Date});w.push(`/test-scenario/sessions/${t.id}`)}catch(t){console.error("ì„¸ì…˜ ìƒì„± ì˜¤ë¥˜:",t),await _("ì„¸ì…˜ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",{type:"error"})}finally{f.value=!1}},B=async t=>{const s=h(t)!=="(ë‹´ë‹¹ì ë¯¸ì…ë ¥)"?`"${h(t)}"ì˜ `:"";if(await D(`${s}${S(t.testDate)} í…ŒìŠ¤íŠ¸ ì„¸ì…˜ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?

ëª¨ë“  í…ŒìŠ¤íŠ¸ ê²°ê³¼ê°€ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.`,{type:"warning"}))try{await z(t.id),await P(),await _("í…ŒìŠ¤íŠ¸ ì„¸ì…˜ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.",{type:"success"})}catch(r){console.error("ì„¸ì…˜ ì‚­ì œ ì˜¤ë¥˜:",r),await _("ì„¸ì…˜ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",{type:"error"})}},R=t=>{w.push(`/test-scenario/sessions/${t}`)},S=t=>t?(t?.toDate?.()||new Date(t)).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}):"",j=t=>{const s=k();if(!s)return 0;const a=t.validProgress?.completed||0;return Math.min(100,Math.round(a/s*100))};return(t,s)=>{const a=m("v-icon"),r=m("v-btn"),d=m("v-progress-circular"),v=m("v-chip");return u(),p("div",q,[s[8]||(s[8]=e("div",{class:"page-header"},[e("h1",null,"ğŸ“‹ í…ŒìŠ¤íŠ¸ ì„¸ì…˜ ê´€ë¦¬"),e("p",{class:"subtitle"},"í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ê¸°ë¡í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.")],-1)),e("div",Q,[n(r,{color:"primary",variant:"flat",size:"large",loading:f.value,class:"create-btn",onClick:V},{default:l(()=>[n(a,{left:""},{default:l(()=>[...s[0]||(s[0]=[c(" mdi-plus ",-1)])]),_:1}),s[1]||(s[1]=c(" í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ìƒì„± ",-1))]),_:1},8,["loading"])]),e("div",U,[x(L)?(u(),p("div",Y,[n(d,{indeterminate:"",color:"primary"})])):y.value.length===0?(u(),p("div",Z,[n(a,{size:"64",color:"grey-lighten-1"},{default:l(()=>[...s[2]||(s[2]=[c(" mdi-clipboard-text-outline ",-1)])]),_:1}),s[3]||(s[3]=e("p",null,"ìƒì„±ëœ í…ŒìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.",-1)),s[4]||(s[4]=e("p",{class:"text-caption"},' "í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ìƒì„±" ë²„íŠ¼ì„ ëˆŒëŸ¬ ìƒˆ í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•˜ì„¸ìš”. ',-1))])):(u(),p("div",ss,[(u(!0),p(W,null,A(y.value,o=>(u(),p("div",{key:o.id,class:"session-card",onClick:g=>R(o.id)},[e("div",es,[e("div",as,[e("span",os,i(S(o.testDate)),1),n(v,{color:o.status==="completed"?"success":"warning",size:"small",class:"status-chip"},{default:l(()=>[c(i(o.status==="completed"?"ì™„ë£Œ":"ì§„í–‰ì¤‘"),1)]),_:2},1032,["color"])]),e("div",rs,[n(a,{size:"16",class:"mr-1"},{default:l(()=>[...s[5]||(s[5]=[c(" mdi-account ",-1)])]),_:1}),c(" "+i(h(o)),1)]),e("div",ns,[e("div",is,[e("div",{class:"progress-fill",style:G({width:j(o)+"%"})},null,4)]),e("div",ls,[e("span",cs,"âœ… "+i(o.validProgress?.pass||0),1),e("span",ds,"âŒ "+i(o.validProgress?.fail||0),1),e("span",ps,"âš ï¸ "+i(o.validProgress?.partial||0),1),e("span",us,"â­ï¸ "+i(o.validProgress?.skip||0),1),e("span",_s,i(o.validProgress?.completed||0)+"/"+i(x(k)()),1)])])]),e("div",vs,[n(r,{icon:"",variant:"text",size:"small",color:"error",onClick:J(g=>B(o),["stop"])},{default:l(()=>[n(a,null,{default:l(()=>[...s[6]||(s[6]=[c("mdi-delete-outline",-1)])]),_:1})]),_:1},8,["onClick"]),n(a,{color:"grey"},{default:l(()=>[...s[7]||(s[7]=[c(" mdi-chevron-right ",-1)])]),_:1})])],8,ts))),128))]))]),s[9]||(s[9]=e("div",{class:"page-footer"},[e("p",null,"ğŸ”’ ì´ í˜ì´ì§€ëŠ” ìˆ¨ê²¨ì§„ í˜ì´ì§€ì…ë‹ˆë‹¤.")],-1))])}}},ks=E(gs,[["__scopeId","data-v-8b5a5ec2"]]);export{ks as default};
