const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CwIB7HyG.js","./entry.DNw42TVG.css"])))=>i.map(i=>d[i]);
import{F as Bt,N as xt,a as Vt,D as Nt,r as g,k as F,o as ze,e as $t,_ as oe,Y as Et,O as Z,L as m,g as N,H as v,K as i,P as a,I as l,J as _,Q as j,G as w,M as d,W as Fe,X as Oe,U as Be,T as P,S as ve}from"./CwIB7HyG.js";import{g as Rt,C as Lt,_ as qt}from"./Dpaynyfl.js";import{_ as At}from"./D9ndqd8O.js";import{u as It,g as St,C as Ut,c as xe,f as ue,p as Tt}from"./CNFoeud_.js";import{u as zt}from"./xmrXBxtb.js";import{u as Ft}from"./MI6WMmTQ.js";import"./ByLYD2Od.js";const Ot={class:"books-admin-page"},Pt={class:"center-header mb-6"},Mt={class:"center-header-inner"},Gt={class:"page-title mb-0"},Ht={class:"registered-books-section"},Wt={class:"registered-books-header mb-0"},Qt={class:"d-flex align-center justify-space-between flex-wrap gap-4 mb-4"},jt={class:"text-body-1"},Xt={class:"text-body-2 text-medium-emphasis"},Jt={class:"d-flex align-center registered-search-group"},Kt={class:"d-flex align-center justify-space-between flex-wrap gap-4 mt-4"},Yt={class:"d-flex action-buttons"},Zt={key:0,class:"text-center py-8"},es={key:1,class:"registered-books-grid"},ts=["onClick"],ss={class:"book-group-content"},as={class:"book-group-info"},os=["src","alt"],ns={key:1,class:"group-thumbnail-placeholder"},ls={class:"group-meta"},rs={class:"group-title"},is={key:0,class:"group-author"},us={key:1,class:"group-publisher"},cs={class:"group-stats"},ds={class:"stat-total"},vs={key:0,class:"stat-available"},ms={key:1,class:"stat-rented"},ps={key:2,class:"stat-requested"},fs={key:2,class:"group-locations"},gs={key:0,class:"book-copies-list"},ys=["onClick"],_s={class:"copy-content"},bs={class:"copy-row-top"},hs={class:"copy-status"},ws={key:4,class:"copy-user-info"},ks=["onClick"],Cs={class:"copy-info-row"},Ds={class:"copy-label-number"},Bs={class:"copy-location"},xs={class:"copy-actions"},Vs={key:2,class:"text-center py-8 text-medium-emphasis empty-state"},Ns={key:0},$s={key:1},Es={class:"drawer-content"},Rs={class:"rent-dialog-content"},Ls={class:"mb-4 text-body-2 text-medium-emphasis"},qs={class:"rent-dialog-actions"},As={key:0,class:"book-info-preview mb-4"},Is={class:"book-info-preview-inner"},Ss=["src","alt"],Us={key:1,class:"book-thumbnail-placeholder"},Ts={class:"book-meta"},zs={class:"book-title"},Fs={class:"book-current-label"},Os={class:"book-current-location"},Ps={class:"label-number-inputs mb-3"},me=5,Ms={__name:"index",setup(Gs){const{user:Ve}=zt(),{getBooksByCenter:Pe,rentBook:Ne,deleteBook:Me,updateBookInfo:Ge,checkLabelNumberExists:He,getCategories:We,calculateBookStatus:I}=It(),{confirm:ce,alert:V}=xt(),{$firebaseFirestore:Qe}=Vt(),q=Qe,ne=Nt("navigationDrawer",()=>!1),$e=g(280),pe=[...Lt],D=g(""),je=g(""),ee=g([]),fe=g(!1),X=g(""),M=g("date"),Xe=[{title:"등록일순",value:"date"},{title:"제목순",value:"title"},{title:"대여중도서",value:"rented"},{title:"연체중도서",value:"overdue"},{title:"대여신청도서",value:"requested"},{title:"신규등록도서",value:"new"}],y=g([]),de=g(!1),S=g(!1),G=g(new Set),ge=g({}),ye=g({}),se=g(!1),J=g([]),_e=g(!1),H=g(""),W=g(""),O=g(""),le=g(!1),E=g(null),be=g(!1),he=g([]),we=g(!1),te=g(""),f=g({category:"",fourDigits:"",location:""}),Je=F(()=>St()),Ke=F(()=>Ut[D.value]||"1");F(()=>!f.value.category||!f.value.fourDigits?"":xe(f.value.category,D.value,f.value.fourDigits));const Ee=F(()=>f.value.category&&f.value.fourDigits&&f.value.fourDigits.length===4&&/^\d{4}$/.test(f.value.fourDigits)&&f.value.location&&!te.value);ze(()=>{const t=()=>{$e.value=window.innerWidth>=769?360:280};t(),window.addEventListener("resize",t),$t(()=>{window.removeEventListener("resize",t)})});const Ye=async()=>{if(!Ve.value||!q)return"";try{const{doc:t,getDoc:e}=await oe(async()=>{const{doc:r,getDoc:p}=await import("./CwIB7HyG.js").then(u=>u.aE);return{doc:r,getDoc:p}},__vite__mapDeps([0,1]),import.meta.url),s=t(q,"users",Ve.value.uid),o=await e(s);if(o.exists())return o.data().workplace||""}catch(t){console.error("사용자 근무지 정보 가져오기 오류:",t)}return""};ze(async()=>{const t=await Ye();je.value=t,D.value=t?Rt(t):pe[0],await K()});const Ze=async()=>{G.value.clear(),y.value=[],await K()},K=async()=>{try{fe.value=!0;const t=await Pe(D.value);ee.value=t,await et(t)}catch(t){console.error("등록된 도서 로드 오류:",t),ee.value=[]}finally{fe.value=!1}},et=async t=>{if(!q)return;const{doc:e,getDoc:s}=await oe(async()=>{const{doc:u,getDoc:b}=await import("./CwIB7HyG.js").then(B=>B.aE);return{doc:u,getDoc:b}},__vite__mapDeps([0,1]),import.meta.url),o=[...new Set(t.filter(u=>u.rentedBy).map(u=>u.rentedBy))],r=[...new Set(t.filter(u=>u.requestedBy).map(u=>u.requestedBy))],p=[...new Set([...o,...r])];for(const u of p)if(!(ge.value[u]&&ye.value[u]))try{const b=e(q,"users",u),B=await s(b);if(B.exists()){const C=B.data(),R=(C.email||"").split("@")[0]||"",x=C.name||"",k=`${C.workplace||""} ${x}(${R})`;ge.value[u]=k,ye.value[u]=k}}catch(b){console.error("대여자/신청자 정보 로드 오류:",b)}},Re=t=>t.rentedBy&&ge.value[t.rentedBy]||"",ke=t=>t.requestedBy&&ye.value[t.requestedBy]||"",tt=()=>{},Le=F(()=>{const t=new Map;for(const e of ee.value){const s=e.isbn13||e.isbn||e.id;t.has(s)||t.set(s,{isbn:s,title:e.title,author:e.author,publisher:e.publisher,image:e.image,copies:[],totalCount:0,availableCount:0,rentedCount:0,requestedCount:0,locations:[]});const o=t.get(s);o.copies.push(e),o.totalCount++;const r=I(e);r?r==="rented"||r==="overdue"?o.rentedCount++:r==="requested"&&o.requestedCount++:o.availableCount++,e.location&&!o.locations.includes(e.location)&&o.locations.push(e.location)}for(const e of t.values())e.copies.sort((s,o)=>{const r=s.labelNumber||"",p=o.labelNumber||"";return r.localeCompare(p,"ko")});return Array.from(t.values())}),re=F(()=>{let t=[...Le.value];if(X.value.trim()){const e=X.value.toLowerCase();t=t.filter(s=>{const o=(s.title||"").toLowerCase(),r=(s.author||"").toLowerCase(),p=(s.publisher||"").toLowerCase();return o.includes(e)||r.includes(e)||p.includes(e)?!0:s.copies.some(u=>(u.labelNumber||"").toLowerCase().includes(e))})}return M.value==="title"?t.sort((e,s)=>{const o=(e.title||"").toLowerCase(),r=(s.title||"").toLowerCase();return o.localeCompare(r,"ko")}):M.value==="date"?t.sort((e,s)=>{const o=e.copies[0]?.registeredAt?.toDate?.()||new Date(0);return(s.copies[0]?.registeredAt?.toDate?.()||new Date(0))-o}):M.value==="rented"?t=t.filter(e=>e.rentedCount>0):M.value==="overdue"?t=t.filter(e=>e.copies.some(s=>I(s)==="overdue")):M.value==="requested"?t=t.filter(e=>e.requestedCount>0):M.value==="new"&&(t=t.filter(e=>e.copies.some(s=>s.location==="구매칸"))),t}),st=F(()=>ee.value.length),at=F(()=>Le.value.length),ot=F(()=>ee.value.filter(t=>I(t)==="rented").length),nt=F(()=>ee.value.filter(t=>I(t)==="overdue").length),lt=F(()=>ee.value.filter(t=>I(t)==="requested").length),ae=t=>I(t),qe=t=>{G.value.has(t)?G.value.delete(t):G.value.add(t),G.value=new Set(G.value)},rt=t=>t.length===0?"":t.length===1?ue(t[0]):t.length===2?t.map(e=>ue(e)).join(", "):`${ue(t[0])} 외 ${t.length-1}곳`,Y=t=>y.value.some(e=>e.id===t.id),Ae=t=>t.copies.every(e=>Y(e)),it=t=>{const e=t.copies.filter(s=>Y(s)).length;return e>0&&e<t.copies.length},Ie=(t,e)=>{e?Y(t)||y.value.push(t):y.value=y.value.filter(s=>s.id!==t.id),Ce()},ut=(t,e)=>{if(e)for(const s of t.copies)Y(s)||y.value.push(s);else{const s=t.copies.map(o=>o.id);y.value=y.value.filter(o=>!s.includes(o.id))}Ce()},ct=t=>{if(t.copies.length>1){const e=Ae(t);ut(t,!e),!e&&!G.value.has(t.isbn)&&qe(t.isbn)}else{const e=t.copies[0];Ie(e,!Y(e))}},dt=t=>{Ie(t,!Y(t))},vt=t=>{t?y.value=re.value.flatMap(e=>e.copies):y.value=[]},Ce=()=>{const t=re.value.flatMap(e=>e.copies);de.value=t.length>0&&t.every(e=>Y(e))};Et(()=>re.value,()=>{Ce()});const mt=async()=>{try{we.value=!0;const t=await We(D.value);he.value=t}catch(t){console.error("카테고리 로드 오류:",t),he.value=[]}finally{we.value=!1}},pt=t=>{const e=t.target.value.replace(/\D/g,"").slice(0,4);f.value.fourDigits=e,te.value=""},ft=async()=>{if(!f.value.category||!f.value.fourDigits||f.value.fourDigits.length!==4)return;const t=xe(f.value.category,D.value,f.value.fourDigits);if(E.value&&t===E.value.labelNumber){te.value="";return}try{await He(t,D.value)?te.value="이미 사용중인 라벨번호입니다.":te.value=""}catch(e){console.error("라벨번호 중복 체크 오류:",e)}},gt=async t=>{E.value=t;const e=Tt(t.labelNumber);f.value={category:t.category||e?.category||"",fourDigits:e?.fourDigits||"",location:t.location||"구매칸"},te.value="",await mt(),le.value=!0},Se=()=>{le.value=!1,E.value=null},yt=async()=>{if(!(!E.value||!Ee.value))try{be.value=!0;const t=xe(f.value.category,D.value,f.value.fourDigits);await Ge(E.value.labelNumber||E.value.id.split("_")[0],D.value,{category:f.value.category,labelNumber:t,location:f.value.location}),Se(),await K(),await V("도서 정보가 수정되었습니다.",{type:"success"})}catch(t){console.error("도서 정보 수정 오류:",t),await V(t.message||"도서 정보 수정에 실패했습니다.",{type:"error"})}finally{be.value=!1}},_t=async()=>{if(y.value.length===0)return;const t=[],e=[];for(const o of y.value){const r=I(o);r==="rented"||r==="overdue"?e.push({book:o,reason:"대여중"}):r==="requested"?e.push({book:o,reason:"대여신청중"}):t.push(o)}if(t.length===0){const o=e.map(r=>`• ${r.book.title} (${r.reason})`).join(`
`);await V(`선택한 도서를 삭제할 수 없습니다.

${o}

대여중/대여신청중인 도서는 반납 또는 신청 취소 후 삭제해주세요.`,{type:"warning"});return}let s=`선택한 ${y.value.length}권 중 ${t.length}권의 도서를 삭제하시겠습니까?`;if(e.length>0){const o=e.map(r=>`• ${r.book.title} (${r.reason})`).join(`
`);s+=`

⚠️ 다음 도서는 삭제할 수 없습니다:
${o}`}if(await ce(s))try{S.value=!0;const o=t.map(r=>{const p=r.labelNumber||r.id.split("_")[0];return Me(p,D.value)});await Promise.all(o),y.value=[],await K(),e.length>0?await V(`${t.length}권의 도서가 삭제되었습니다.
(${e.length}권은 대여중/대여신청중으로 삭제되지 않았습니다.)`,{type:"success"}):await V(`${t.length}권의 도서가 삭제되었습니다.`,{type:"success"})}catch(o){console.error("도서 삭제 오류:",o),await V("도서 삭제에 실패했습니다.",{type:"error"})}finally{S.value=!1}},bt=async()=>{if(y.value.length===0)return;const t=y.value.filter(e=>{const s=I(e);return s!=="rented"&&s!=="overdue"});if(t.length===0){await V("선택한 도서가 모두 대여중입니다.",{type:"warning"});return}J.value=t,H.value=D.value,W.value="",O.value="",se.value=!0},Ue=async t=>{if(!q||!t)return 0;try{const{collection:e,query:s,where:o,getDocs:r}=await oe(async()=>{const{collection:C,query:c,where:R,getDocs:x}=await import("./CwIB7HyG.js").then($=>$.aE);return{collection:C,query:c,where:R,getDocs:x}},__vite__mapDeps([0,1]),import.meta.url),p=e(q,"books"),u=s(p,o("rentedBy","==",t)),b=await r(u);let B=0;return b.forEach(C=>{const c=C.data();(c.status==="rented"||c.status==="overdue")&&B++}),B}catch(e){return console.error("대여 권수 조회 오류:",e),0}},ht=async t=>{if(I(t)==="requested"&&t.requestedBy){if(await Ue(t.requestedBy)>=me){await V(`신청자가 이미 ${me}권을 대여중입니다.
반납 후 대여 처리해주세요.`,{type:"warning"});return}if(!await ce(`신청자 정보로 대여 처리하시겠습니까?

도서: ${t.title}
라벨번호: ${t.labelNumber||"-"}
신청자: ${ke(t)}`))return;try{S.value=!0;const o=t.labelNumber||t.id.split("_")[0];await Ne(o,D.value,t.requestedBy,t.isbn),await K(),await V("대여 처리가 완료되었습니다.",{type:"success"})}catch(o){console.error("대여 처리 오류:",o),await V(o.message||"대여 처리에 실패했습니다.",{type:"error"})}finally{S.value=!1}return}J.value=[t],H.value=D.value,W.value="",O.value="",se.value=!0},Te=()=>{se.value=!1,J.value=[],H.value="",W.value="",O.value=""},wt=async()=>{if(!(!H.value||!W.value))try{_e.value=!0,O.value="";const{collection:t,query:e,where:s,getDocs:o}=await oe(async()=>{const{collection:k,query:L,where:A,getDocs:U}=await import("./CwIB7HyG.js").then(T=>T.aE);return{collection:k,query:L,where:A,getDocs:U}},__vite__mapDeps([0,1]),import.meta.url),r=t(q,"users"),p=e(r,s("email","==",W.value)),u=await o(p);if(u.empty){O.value="해당 이메일의 사용자를 찾을 수 없습니다.";return}const b=u.docs[0].data();if(b.center!==H.value){O.value=`해당 사용자는 ${b.center} 소속입니다.`;return}const C=u.docs[0].id,c=await Ue(C),R=J.value.length,x=me-c;if(x<=0){O.value=`해당 사용자가 이미 ${me}권을 대여중입니다.`;return}if(R>x){O.value=`해당 사용자는 ${x}권까지만 추가 대여 가능합니다. (현재 ${c}권 대여중)`;return}for(const k of J.value){const L=k.labelNumber||k.id.split("_")[0];await Ne(L,D.value,C,k.isbn)}const $=J.value.length;await K(),y.value=y.value.filter(k=>!J.value.some(L=>L.id===k.id)),Te(),await V(`${$}권의 도서가 대여 처리되었습니다.`,{type:"success"})}catch(t){console.error("도서 대여 오류:",t),O.value=t.message||"대여 처리에 실패했습니다."}finally{_e.value=!1}},kt=async()=>{if(y.value.length===0)return;const t=y.value.filter(e=>{const s=I(e);return s==="rented"||s==="overdue"});if(t.length===0){await V("선택한 도서 중 대여중인 도서가 없습니다.",{type:"warning"});return}if(await ce(`선택한 ${t.length}권의 도서를 반납 처리하시겠습니까?`))try{S.value=!0;const{doc:e,updateDoc:s,collection:o,addDoc:r,query:p,where:u,getDocs:b,serverTimestamp:B,deleteField:C}=await oe(async()=>{const{doc:c,updateDoc:R,collection:x,addDoc:$,query:k,where:L,getDocs:A,serverTimestamp:U,deleteField:T}=await import("./CwIB7HyG.js").then(z=>z.aE);return{doc:c,updateDoc:R,collection:x,addDoc:$,query:k,where:L,getDocs:A,serverTimestamp:U,deleteField:T}},__vite__mapDeps([0,1]),import.meta.url);for(const c of t){const R=c.labelNumber||c.id.split("_")[0],x=c.id,$=c.rentedBy,k=c.rentedAt,L=e(q,"books",x);if(await s(L,{status:"available",rentedBy:C(),rentedAt:C(),expectedReturnDate:C()}),$){const A=o(q,"rentalHistory"),U=c.isbn13||c.isbn||"",T=p(A,u("userId","==",$),u("isbn13","==",U)),z=await b(T);if(z.empty)await r(A,{bookId:x,labelNumber:R,isbn13:c.isbn13||"",isbn:c.isbn||"",title:c.title||"",author:c.author||"",publisher:c.publisher||"",cover:c.cover||c.image||"",center:c.center||"",userId:$,rentedAt:k,returnedAt:B(),rentCount:1});else{const Q=z.docs[0],n=Q.data();await s(e(q,"rentalHistory",Q.id),{rentedAt:k,returnedAt:B(),rentCount:(n.rentCount||1)+1})}}}y.value=[],await K(),await V(`${t.length}권의 도서가 반납 처리되었습니다.`,{type:"success"})}catch(e){console.error("도서 반납 오류:",e),await V("도서 반납에 실패했습니다.",{type:"error"})}finally{S.value=!1}},Ct=async t=>{const e=I(t);if(e!=="rented"&&e!=="overdue"){await V("대여중인 도서가 아닙니다.",{type:"warning"});return}if(await ce(`"${t.title}" 도서를 반납 처리하시겠습니까?
라벨번호: ${t.labelNumber||"-"}`))try{S.value=!0;const{doc:s,updateDoc:o,collection:r,addDoc:p,query:u,where:b,getDocs:B,serverTimestamp:C,deleteField:c}=await oe(async()=>{const{doc:A,updateDoc:U,collection:T,addDoc:z,query:Q,where:n,getDocs:De,serverTimestamp:h,deleteField:ie}=await import("./CwIB7HyG.js").then(Dt=>Dt.aE);return{doc:A,updateDoc:U,collection:T,addDoc:z,query:Q,where:n,getDocs:De,serverTimestamp:h,deleteField:ie}},__vite__mapDeps([0,1]),import.meta.url),R=t.id,x=t.rentedBy,$=t.rentedAt,k=t.labelNumber||t.id.split("_")[0],L=s(q,"books",R);if(await o(L,{status:"available",rentedBy:c(),rentedAt:c(),expectedReturnDate:c()}),x){const A=r(q,"rentalHistory"),U=t.isbn13||t.isbn||"",T=u(A,b("userId","==",x),b("isbn13","==",U)),z=await B(T);if(z.empty)await p(A,{bookId:R,labelNumber:k,isbn13:t.isbn13||"",isbn:t.isbn||"",title:t.title||"",author:t.author||"",publisher:t.publisher||"",cover:t.cover||t.image||"",center:t.center||"",userId:x,rentedAt:$,returnedAt:C(),rentCount:1});else{const Q=z.docs[0],n=Q.data();await o(s(q,"rentalHistory",Q.id),{rentedAt:$,returnedAt:C(),rentCount:(n.rentCount||1)+1})}}await K(),await V("도서가 반납 처리되었습니다.",{type:"success"})}catch(s){console.error("도서 반납 오류:",s),await V("도서 반납에 실패했습니다.",{type:"error"})}finally{S.value=!1}};return Ft({title:"도서 관리 - CNX Library",meta:[{name:"description",content:"도서 검색 및 등록 관리"}]}),(t,e)=>{const s=N("v-select"),o=N("v-text-field"),r=N("v-checkbox"),p=N("v-btn"),u=N("v-progress-circular"),b=N("v-icon"),B=N("v-chip"),C=N("v-expand-transition"),c=qt,R=At,x=N("v-navigation-drawer"),$=N("v-spacer"),k=N("v-card"),L=N("v-dialog"),A=N("v-card-title"),U=N("v-autocomplete"),T=N("v-card-text"),z=N("v-card-actions"),Q=N("v-app");return v(),Z(Q,null,{default:m(()=>[i(c,{"header-type":"back-home","show-header-actions":!0,onToggleDrawer:e[4]||(e[4]=n=>ne.value=!a(ne))},{default:m(()=>[l("div",Ot,[l("div",Pt,[l("div",Mt,[l("h1",Gt,_(a(D))+" 도서 관리 ",1),i(s,{modelValue:a(D),"onUpdate:modelValue":[e[0]||(e[0]=n=>j(D)?D.value=n:null),Ze],items:pe,variant:"outlined",density:"comfortable","hide-details":"",class:"center-select"},null,8,["modelValue"])])]),l("div",Ht,[l("div",Wt,[l("div",Qt,[l("div",jt,[e[13]||(e[13]=d(" 총 ",-1)),l("strong",null,_(a(st)),1),d("권 ("+_(a(at))+"종) ",1)]),l("div",Xt,[e[14]||(e[14]=d(" 대여중 ",-1)),l("strong",null,_(a(ot)),1),e[15]||(e[15]=d("권, 연체중 ",-1)),l("strong",null,_(a(nt)),1),e[16]||(e[16]=d("권, 대여신청 ",-1)),l("strong",null,_(a(lt)),1),e[17]||(e[17]=d("권 ",-1))])]),l("div",Jt,[i(o,{modelValue:a(X),"onUpdate:modelValue":[e[1]||(e[1]=n=>j(X)?X.value=n:null),tt],label:"도서/라벨번호 검색","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"comfortable","hide-details":"",clearable:"",class:"registered-search-input"},null,8,["modelValue"]),i(s,{modelValue:a(M),"onUpdate:modelValue":e[2]||(e[2]=n=>j(M)?M.value=n:null),items:Xe,label:"정렬",variant:"outlined",density:"comfortable","hide-details":"",class:"sort-select"},null,8,["modelValue"])]),l("div",Kt,[i(r,{modelValue:a(de),"onUpdate:modelValue":[e[3]||(e[3]=n=>j(de)?de.value=n:null),vt],label:"전체선택","hide-details":"",class:"select-all-checkbox"},null,8,["modelValue"]),l("div",Yt,[i(p,{class:"action-btn",variant:"flat",size:"small",disabled:a(y).length===0,loading:a(S),onClick:_t},{default:m(()=>[...e[18]||(e[18]=[d(" 도서 삭제 ",-1)])]),_:1},8,["disabled","loading"]),i(p,{class:"action-btn",variant:"flat",size:"small",disabled:a(y).length===0,loading:a(S),onClick:bt},{default:m(()=>[...e[19]||(e[19]=[d(" 대여 처리 ",-1)])]),_:1},8,["disabled","loading"]),i(p,{class:"action-btn",variant:"flat",size:"small",disabled:a(y).length===0,loading:a(S),onClick:kt},{default:m(()=>[...e[20]||(e[20]=[d(" 반납 처리 ",-1)])]),_:1},8,["disabled","loading"])])])]),a(fe)?(v(),w("div",Zt,[i(u,{indeterminate:"",color:"primary"})])):a(re).length>0?(v(),w("div",es,[(v(!0),w(Fe,null,Oe(a(re),(n,De)=>(v(),w("div",{key:`group-${De}`,class:"book-group"},[l("div",{class:Be(["book-group-header",{selected:Ae(n)||it(n)}]),onClick:h=>ct(n)},[l("div",ss,[l("div",as,[n.image?(v(),w("img",{key:0,src:n.image,alt:n.title,class:"group-thumbnail"},null,8,os)):(v(),w("div",ns,[...e[21]||(e[21]=[l("span",null,"No Image",-1)])])),l("div",ls,[l("div",rs,_(n.title),1),n.author?(v(),w("div",is,[e[22]||(e[22]=l("strong",null,"저자:",-1)),d(" "+_(n.author),1)])):P("",!0),n.publisher?(v(),w("div",us,[e[23]||(e[23]=l("strong",null,"출판사:",-1)),d(" "+_(n.publisher),1)])):P("",!0),l("div",cs,[l("span",ds,_(n.totalCount)+"권",1),n.availableCount>0?(v(),w("span",vs,"대여가능 "+_(n.availableCount)+"권",1)):P("",!0),n.rentedCount>0?(v(),w("span",ms,"대여중 "+_(n.rentedCount)+"권",1)):P("",!0),n.requestedCount>0?(v(),w("span",ps,"신청 "+_(n.requestedCount)+"권",1)):P("",!0)]),n.locations.length>0?(v(),w("div",fs,[i(b,{size:"small",class:"mr-1"},{default:m(()=>[...e[24]||(e[24]=[d(" mdi-map-marker ",-1)])]),_:1}),d(" "+_(rt(n.locations)),1)])):P("",!0)])])]),n.copies.length>1?(v(),Z(b,{key:0,class:Be(["expand-icon",{expanded:a(G).has(n.isbn)}]),onClick:ve(h=>qe(n.isbn),["stop"])},{default:m(()=>[...e[25]||(e[25]=[d(" mdi-chevron-down ",-1)])]),_:1},8,["class","onClick"])):P("",!0)],10,ts),i(C,null,{default:m(()=>[a(G).has(n.isbn)?(v(),w("div",gs,[(v(!0),w(Fe,null,Oe(n.copies,h=>(v(),w("div",{key:h.id,class:Be(["book-copy-item",{selected:Y(h)}]),onClick:ie=>dt(h)},[l("div",_s,[l("div",bs,[l("div",hs,[ae(h)==="rented"?(v(),Z(B,{key:0,size:"x-small",color:"primary",variant:"flat"},{default:m(()=>[...e[26]||(e[26]=[d(" 대여중 ",-1)])]),_:1})):ae(h)==="overdue"?(v(),Z(B,{key:1,size:"x-small",color:"error",variant:"flat"},{default:m(()=>[...e[27]||(e[27]=[d(" 연체중 ",-1)])]),_:1})):ae(h)==="requested"?(v(),Z(B,{key:2,size:"x-small",color:"warning",variant:"flat"},{default:m(()=>[...e[28]||(e[28]=[d(" 대여신청 ",-1)])]),_:1})):(v(),Z(B,{key:3,size:"x-small",color:"success",variant:"outlined"},{default:m(()=>[...e[29]||(e[29]=[d(" 대여가능 ",-1)])]),_:1})),Re(h)||ke(h)?(v(),w("span",ws,_(Re(h)||ke(h)),1)):P("",!0)]),l("a",{href:"#",class:"copy-edit-link",onClick:ve(ie=>gt(h),["prevent"])}," 정보수정 ",8,ks)]),l("div",Cs,[l("span",Ds,_(h.labelNumber||"라벨없음"),1),e[31]||(e[31]=l("span",{class:"copy-divider"},"|",-1)),l("span",Bs,[i(b,{size:"small",class:"mr-1"},{default:m(()=>[...e[30]||(e[30]=[d(" mdi-map-marker ",-1)])]),_:1}),d(" "+_(a(ue)(h.location)||"위치없음"),1)])]),l("div",xs,[ae(h)==="rented"||ae(h)==="overdue"?(v(),Z(p,{key:0,color:"primary",size:"small",variant:"flat",onClick:ve(ie=>Ct(h),["stop"])},{default:m(()=>[...e[32]||(e[32]=[d(" 반납처리 ",-1)])]),_:1},8,["onClick"])):(v(),Z(p,{key:1,color:"primary",size:"small",variant:"flat",onClick:ve(ie=>ht(h),["stop"])},{default:m(()=>[d(_(ae(h)==="requested"?"대여승인":"대여처리"),1)]),_:2},1032,["onClick"]))])])],10,ys))),128))])):P("",!0)]),_:2},1024)]))),128))])):(v(),w("div",Vs,[i(b,{size:"48",color:"grey-lighten-1",class:"mb-4"},{default:m(()=>[d(_(a(X)?"mdi-book-search-outline":"mdi-book-off-outline"),1)]),_:1}),a(X)?(v(),w("p",Ns,[e[33]||(e[33]=d(" '",-1)),l("strong",null,_(a(X)),1),e[34]||(e[34]=d("'에 대한 검색 결과가 없습니다. ",-1))])):(v(),w("p",$s," 등록된 도서가 없습니다. "))]))])])]),_:1}),i(x,{modelValue:a(ne),"onUpdate:modelValue":e[5]||(e[5]=n=>j(ne)?ne.value=n:null),location:"right",temporary:"",width:a($e),class:"side-navigation"},{default:m(()=>[l("div",Es,[i(R)])]),_:1},8,["modelValue","width"]),i(L,{modelValue:a(se),"onUpdate:modelValue":e[8]||(e[8]=n=>j(se)?se.value=n:null),"max-width":"400",persistent:""},{default:m(()=>[i(k,{class:"rent-dialog-card"},{default:m(()=>[e[37]||(e[37]=l("div",{class:"rent-dialog-title text-h6"}," 대여자 정보 입력 ",-1)),l("div",Rs,[l("div",Ls," 대여 처리할 도서: "+_(a(J).length)+"권 ",1),i(s,{modelValue:a(H),"onUpdate:modelValue":e[6]||(e[6]=n=>j(H)?H.value=n:null),items:pe,label:"센터",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),i(o,{modelValue:a(W),"onUpdate:modelValue":e[7]||(e[7]=n=>j(W)?W.value=n:null),label:"이메일",variant:"outlined",density:"comfortable",placeholder:"example@email.com","error-messages":a(O)},null,8,["modelValue","error-messages"])]),l("div",qs,[i($),i(p,{variant:"text",onClick:Te},{default:m(()=>[...e[35]||(e[35]=[d(" 취소 ",-1)])]),_:1}),i(p,{color:"primary",variant:"flat",loading:a(_e),disabled:!a(H)||!a(W),onClick:wt},{default:m(()=>[...e[36]||(e[36]=[d(" 대여 처리 ",-1)])]),_:1},8,["loading","disabled"])])]),_:1})]),_:1},8,["modelValue"]),i(L,{modelValue:a(le),"onUpdate:modelValue":e[12]||(e[12]=n=>j(le)?le.value=n:null),"max-width":"500",persistent:""},{default:m(()=>[i(k,{class:"edit-dialog-card"},{default:m(()=>[i(A,{class:"edit-dialog-title"},{default:m(()=>[...e[38]||(e[38]=[d(" 도서 정보 수정 ",-1)])]),_:1}),i(T,{class:"edit-dialog-content"},{default:m(()=>[a(E)?(v(),w("div",As,[l("div",Is,[a(E).image?(v(),w("img",{key:0,src:a(E).image,alt:a(E).title,class:"book-thumbnail"},null,8,Ss)):(v(),w("div",Us,[...e[39]||(e[39]=[l("span",null,"No Image",-1)])])),l("div",Ts,[l("div",zs,_(a(E).title),1),l("div",Fs,_(a(E).labelNumber||"라벨없음"),1),l("div",Os,[i(b,{size:"small",class:"mr-1"},{default:m(()=>[...e[40]||(e[40]=[d(" mdi-map-marker ",-1)])]),_:1}),d(" "+_(a(ue)(a(E).location)||"위치없음"),1)])])])])):P("",!0),i(U,{modelValue:a(f).category,"onUpdate:modelValue":e[9]||(e[9]=n=>a(f).category=n),items:a(he),label:"카테고리 *",variant:"outlined",density:"comfortable",loading:a(we),class:"mb-3"},null,8,["modelValue","items","loading"]),l("div",Ps,[i(o,{"model-value":a(Ke),label:"센터코드",variant:"outlined",density:"comfortable",readonly:"",disabled:"",class:"center-code-input"},null,8,["model-value"]),i(o,{modelValue:a(f).fourDigits,"onUpdate:modelValue":e[10]||(e[10]=n=>a(f).fourDigits=n),label:"4자리 번호 *",variant:"outlined",density:"comfortable",maxlength:"4","error-messages":a(te),hint:"0001~9999","persistent-hint":"",class:"four-digits-input",onInput:pt,onBlur:ft},null,8,["modelValue","error-messages"])]),i(s,{modelValue:a(f).location,"onUpdate:modelValue":e[11]||(e[11]=n=>a(f).location=n),items:a(Je),label:"위치 *",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])]),_:1}),i(z,{class:"edit-dialog-actions"},{default:m(()=>[i($),i(p,{variant:"text",onClick:Se},{default:m(()=>[...e[41]||(e[41]=[d(" 취소 ",-1)])]),_:1}),i(p,{color:"primary",variant:"flat",loading:a(be),disabled:!a(Ee),onClick:yt},{default:m(()=>[...e[42]||(e[42]=[d(" 저장 ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},Ys=Bt(Ms,[["__scopeId","data-v-b358a183"]]);export{Ys as default};
